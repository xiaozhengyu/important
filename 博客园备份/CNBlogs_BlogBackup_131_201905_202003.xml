<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/" xmlns:wfw="http://wellformedweb.org/CommentAPI/" xmlns:slash="http://purl.org/rss/1.0/modules/slash/"><channel><title>博客园-啃白菜的喵</title><link>https://www.cnblogs.com/KenBaiCaiDeMiao/</link><description /><language>zh-cn</language><lastBuildDate>Sun, 01 Mar 2020 10:03:39 GMT</lastBuildDate><pubDate>Sun, 01 Mar 2020 10:03:39 GMT</pubDate><ttl>60</ttl><item><title>Host‘116.77.33.xx’is not allowed to connect to this MySQL server</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/02/29/12384969.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 29 Feb 2020 11:56:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/02/29/12384969.html</guid><description><![CDATA[<h3><span style="font-size: 18pt;"><strong><span style="font-family: 黑体;">问题描述</span></strong></span></h3>
<h3><span style="font-family: 黑体; font-size: 18pt;"><span><span style="font-size: 18pt;">&nbsp; &nbsp;<span style="font-size: 18px;">本地运</span></span><span style="font-size: 18px;">行的</span></span><span style="font-size: 18px;">java<span>程序访问服务器数据库时报错:</span></span></span></h3>
<p class="MsoNormal" style="text-indent: 21.0000pt; mso-char-indent-count: 0.0000;"><span style="mso-spacerun: 'yes'; font-family: 黑体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;"><span style="font-family: 黑体;"><img src="https://img2018.cnblogs.com/i-beta/1689384/202002/1689384-20200229195139334-599068323.png" alt="" width="1217" height="65" /></span></span></p>
<p class="MsoNormal" style="text-indent: 21.0000pt; mso-char-indent-count: 0.0000;">&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp;<span style="font-family: 黑体; font-size: 18pt;">&nbsp;<span style="text-indent: 21pt; font-size: 18px;">相关配置信息：</span></span></p>
<p><span style="font-family: 黑体; font-size: 12pt; text-indent: 21pt;"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/202002/1689384-20200229195154275-261046285.png" alt="" width="1113" height="266" /></span></p>
<p>&nbsp;</p>
<h3><span style="font-size: 18pt;"><strong><span style="font-family: 黑体;">解决过程</span></strong></span></h3>
<p class="MsoNormal"><span style="font-size: 18px;"><span style="font-family: 黑体;">通过错误信息判断，应该是数据库权限的问题，服务器上的数据库不允许远程连接，所以对数据库的访问权限进行修改。</span></span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><span style="font-family: 黑体;">通过</span>Navicat<span style="font-family: 黑体;">连接数据库，找到</span><span style="font-family: Calibri;">mysql</span><span style="font-family: 黑体;">库中的</span><span style="font-family: Calibri;">user</span><span style="font-family: 黑体;">表，可以看到数据库中用户</span><span style="font-family: Calibri;">Host</span><span style="font-family: 黑体;">字段的值均为</span><span style="font-family: Calibri;">localhost</span><span style="font-family: 黑体;">，这就导致</span><span style="font-family: Calibri;">mysql</span><span style="font-family: 黑体;">只允许本机连接，即服务器上的运行的应用连接。</span></span></p>
<p class="MsoNormal"><span style="mso-spacerun: 'yes'; font-family: 黑体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;"><span style="font-family: 黑体;"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/202002/1689384-20200229195257475-1213602504.png" alt="" /></span></span></p>
<p><span style="font-family: 黑体; font-size: 18px;">&nbsp;<span>我们将</span>root<span>用户</span><span>Host</span><span>字段的值改成&lsquo;</span><span>%</span><span>&rsquo;</span><span>:</span></span></p>
<p><span style="font-size: 12pt; font-family: Calibri;"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/202002/1689384-20200229195313656-1395076206.png" alt="" /></span></p>
<p>&nbsp;</p>
<p class="MsoNormal"><span style="font-size: 18px;"><span style="font-family: 黑体;"><span style="font-family: 黑体;">最后需要让数据库执行</span></span><span style="font-family: 黑体; color: #ff0000;">flush privilege</span><span style="font-family: 黑体;"><span style="font-family: 黑体;">语句，刷新权限：</span></span></span></p>
<p>&nbsp;</p>
<p class="MsoNormal"><span style="font-size: 12pt; font-family: Calibri;"><span style="mso-spacerun: 'yes'; font-family: 黑体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;"><span style="font-family: 黑体;"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/202002/1689384-20200229195326783-1190385929.png" alt="" /></span></span></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 18px;">&nbsp;<span>再次运行本地</span>java<span>程序，发现问题已经解决了。</span></span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;">注意点：</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><!--[if !supportLists]-->1、<!--[endif]--><span>修改完用户的权限以后一定要记得执行</span>flush privilege<span>语句。</span></span></p>]]></description></item><item><title>Maven坐标</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/02/29/12383790.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 29 Feb 2020 09:03:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/02/29/12383790.html</guid><description><![CDATA[<p>Maven是核心作用之一是为我们管理项目的依赖，为了能够准确的定位到每一个Java构件，每个构件都有一个唯一标识，这是Maven为我们管理项目的基础。</p>
<h1>Maven坐标</h1>
<p>在平面几何或立体几何中可以用坐标来唯一标识一个点，为了准确的定位到某个Java构件，Maven制定了一套规则对构件进行标识。Maven的坐标元素包括<span style="color: #ff0000;">groupId、artifactId、version、packaging、classfier</span>。只要我们提供正确的坐标元素，Maven就能找到对应的构件，首先去你的<span style="color: #ff0000;">本地仓库</span>查找，没有的话再去远程仓库下载。如果没有配置远程仓库，会默认从<span style="color: #ff0000;">中央仓库</span>地址(http://repo1.maven.org/maven2)下载构件，该中央仓库包含了世界上大部分流行的开源项目构件，但不一定所有构件都有。</p>
<p align="center"><img src="https://img2018.cnblogs.com/i-beta/1689384/202002/1689384-20200229170059322-1154720059.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="center">&nbsp;</p>
<p>在我们自己开发项目的时候，也是要给我们的项目定义坐标的，这是强制性要求，只有这样，其他项目才能引用该项目的构件。</p>
<p><strong>groupId</strong>&nbsp;：定义当前Maven项目隶属的实际项目。首先，Maven项目和实际项目不一定是一对一的关系。比如SpringFrameWork这一实际项目，其对应的Maven项目会有很多，如spring-core,spring-context等。这是由于Maven中模块的概念，因此，一个实际项目往往会被划分成很多模块。其次，groupId不应该对应项目隶属的组织或公司。原因很简单，一个组织下会有很多实际项目，如果groupId只定义到组织级别，而后面我们会看到，artifactId只能定义Maven项目（模块），那么实际项目这个层次将难以定义。最后，groupId的表示方式与Java包名的表达方式类似，通常与域名反向一一对应。上例中，groupId为junit，是不是感觉很特殊，这样也是可以的，因为全世界就这么个junit，它也没有很多分支。</p>
<p><strong>artifactId</strong>&nbsp;: 该元素定义当前实际项目中的一个Maven项目（模块），推荐的做法是使用实际项目名称作为artifactId的前缀。比如上例中的junit，junit就是实际的项目名称，方便而且直观。在默认情况下，maven生成的构件，会以artifactId作为文件头，如junit-3.8.1.jar，使用实际项目名称作为前缀，就能方便的从本地仓库找到某个项目的构件。</p>
<p><strong>version</strong>&nbsp;: 该元素定义了使用构件的版本，如上例中junit的版本是3.8.1，你也可以改为4.0表示使用4.0版本的junit。</p>
<p><strong>packaging</strong>&nbsp;：定义Maven项目打包的方式，使用构件的什么包。首先，打包方式通常与所生成构件的文件扩展名对应，如上例中没有packaging，则默认为jar包，最终的文件名为junit-3.8.1.jar。也可以打包成war等。</p>
<p><strong>classifier</strong>: 该元素用来帮助定义构建输出的一些附件。附属构件与主构件对应，如上例中的主构件为junit-3.8.1.jar，该项目可能还会通过一些插件生成如junit-3.8.1-javadoc.jar,junit-3.8.1-sources.jar，这样附属构件也就拥有了自己唯一的坐标。</p>
<p>上述5个元素中，groupId、artifactId、version是必须定义的，packaging是可选的（默认为jar），而classfier是不能直接定义的，需要结合插件使用。</p>
<p><span style="color: #ff0000;">&nbsp;原文地址</span>：<a href="https://blog.csdn.net/liupeifeng3514/article/details/79544532">https://blog.csdn.net/liupeifeng3514/article/details/79544532</a></p>]]></description></item><item><title>HotSpot虚拟机对象创建</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/02/15/12312678.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 15 Feb 2020 09:02:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/02/15/12312678.html</guid><description><![CDATA[<h3><span style="font-family: 'Microsoft YaHei'; font-size: 18pt;"><strong>2.3.1对象创建</strong></span></h3>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">Java是一门面向对象的语言，在Java程序的运行过程中无时无刻都有新的对象被创建出来。从语言的层面看，创建对象通常仅仅是一个new关键字而已，从虚拟机的角度看，创建对象又是怎样的一个过程呢？</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">虚拟机遇到一条new指令时，首先将会去检查这个指令的参数是否能在常量池中定位到一个类的符号引用，并且检查这个符号引用代表的类是否已经被加载、解析和初始化过。如果没有，必须想执行相应的类加载过程。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">在<span style="color: #ff0000;">类加载检查通</span>过后，接下来虚拟机将为新生对象<span style="color: #ff0000;">分配内存</span>。<span style="text-decoration: underline;"><span style="text-decoration: underline;">对象所需内存的大小在类加载完成后便可完全确定</span></span>，为对象分配空间其实就是把一块大小确定的内存从java堆中划分出来。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">假设Java堆中内存是绝对规整的，所有用过的内存放在一边，空闲的内存放在另一边，中间放着一个指针作为分界点的指示器，那分配内存的工作其实就是将这个指针向空闲空间挪动一段与对象大小相等的距离，这种分配方式称为&ldquo;<span style="color: #ff00ff;">指针碰撞</span>&rdquo;。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">如果Java堆中的内存并不是规整的，已使用的内存和未使用的内存交错存在，那就没有办法进行简单的指针碰撞了，虚拟机必须维护一个列表，记录哪些内存是尚未使用的、可分配的，在分配内存的时候从列表中找到一块足够大的空闲空间划分给对象实例，并更新列表上的记录，这种分配方式称为&ldquo;<span style="color: #ff00ff;">空闲列表</span>&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">具体使用哪种方式分配内存由Java堆是否规整决定，而Java堆是否规整又由采用的垃圾收集器是否带有<span style="color: #ff00ff;">压缩整理</span>功能决定。</span></p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="1"><img class="cke_widget_element" src="https://img-blog.csdnimg.cn/20200215164801187.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTE0MDMz,size_16,color_FFFFFF,t_70" alt="" width="337" height="261" data-cke-saved-src="https://img-blog.csdnimg.cn/20200215164801187.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTE0MDMz,size_16,color_FFFFFF,t_70" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://img-blog.csdnimg.cn/20200215164801187.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTE0MDMz,size_16,color_FFFFFF,t_70&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;337&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;261&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:[]}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​<span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="0"><img class="cke_widget_element" src="https://img-blog.csdnimg.cn/20200215164810333.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTE0MDMz,size_16,color_FFFFFF,t_70" alt="" width="354" height="217" data-cke-saved-src="https://img-blog.csdnimg.cn/20200215164810333.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTE0MDMz,size_16,color_FFFFFF,t_70" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://img-blog.csdnimg.cn/20200215164810333.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTE0MDMz,size_16,color_FFFFFF,t_70&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;354&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;217&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:[]}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></span></span></span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">除了如何划分可用空间，另外还需要注意空间划分时的<span style="color: #ff00ff;">线程安全问题</span>。对象的创建在虚拟机中是非常频繁的，以较为简单的&ldquo;指针碰撞&rdquo;为例，即使只是简单的修改指针指向的位置，在在并发情况下一样存在线程安全问题，比如说正在给A分配内存，指针还没来得及修改，对象B也请求分配内存，也需要修改指针。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">上述问题有两个解决方案：</span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">方案一 &nbsp;<span style="text-decoration: underline;"><span style="text-decoration: underline;">对分配内存的操作进行同步处理</span></span>&mdash;&mdash;实际上虚拟机采用CAS配上失败重试的方式保证更新操作的原子性。</span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">方案二 &nbsp;<span style="text-decoration: underline;"><span style="text-decoration: underline;">把分配内存的动作按照线程划分在不同的空间之中进行</span></span>，即每个线程在Java堆中预先分配一小块内存，称为<span style="color: #ff00ff;">本地线程分配缓冲</span>（Thread Local Allocation Buffer，TLAB）。哪个线程要分配内存，就在哪个线程的TLAB上分配，只有TLAB用完并需要分配新的TLAB的时候，才需要进行同步锁定。虚拟机是否使用TLAB，可以通过-XX:+/-UseTLAB参数来设定。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">内存分配完成后，虚拟机需要将分配到的内存空间都<span style="color: #ff0000;">初始化为零值</span>（<span style="text-decoration: underline;"><span style="text-decoration: underline;">不包括对象头，因为对象头中要保存其他信息</span></span>），如果使用TLAB，这一工作可以提前至TLAB分配的时候进行。这一操作保证了对象的实例字段在Java代码中可以不赋初始值就直接使用，程序能访问到这些字段的数据类型所对应的零值。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">接下来，虚拟机要对对象进行<span style="color: #ff0000;">必要的设置</span>，例如这个对象是哪个类的实例、如何才能找到类的元数据信息、对象的哈希码、对象的GC分代年龄等信息。这些信息存<span style="text-decoration: underline;"><span style="text-decoration: underline;">放在对象的</span></span><span style="text-decoration: underline;"><span style="text-decoration: underline;">对象头</span></span><span style="text-decoration: underline;"><span style="text-decoration: underline;">（Object Header）之中</span></span>。根据虚拟机当前运行状体的不同，如是否启动偏向锁等，对象头会有不同的设置方式。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">上面的工作完成之后，从虚拟机的视角来看，一个新的对象就已经产生了，但从Java程序的视角看，对象的创建才刚刚开始&mdash;&mdash;&lt;init&gt;方法还没有执行，所有的字段还是零值。所以，一般来说（由字节码中是否跟随invoke special指令所决定），执行new指令之后会接着执行&lt;init&gt;方法，<span style="color: #ff0000;">把对象按照程序员的意愿进行初始化</span>，这样一个真正的对象才算产生出来了。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;"><span style="color: #ff00ff;">总结对象的创建过程</span>：</span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;"><strong>类加载检查</strong>&rarr;<strong>对象内存分配</strong>&rarr;<strong>各字段赋零值</strong>&rarr;<strong>对象头信息设置</strong>&rarr;<strong>初始化</strong></span></p>]]></description></item><item><title>程序计数器为什么是线程私有的？</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/02/13/12304703.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 13 Feb 2020 11:00:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/02/13/12304703.html</guid><description><![CDATA[<h1>1.&nbsp;<strong>程序计数器</strong></h1>
<h2>1.1.&nbsp;<strong>程序计数器的本质</strong></h2>
<p>从本质来看，程序技术器就是一块比较小的内存空间。</p>
<h2>1.2.&nbsp;<strong>程序计数器的作用</strong></h2>
<p>程序计数器可以看作是当前线程所执行字节码的行号指示器，也就是说，程序计数器这块小空间里面记录的是当前线程正在执行的字节码的行号。字节码解释器通过改变计数器的值来获取下一条要执行的字节码。分支、循环、跳转、异常处理、线程恢复等基础功能都需要依赖这个计数器来完成。</p>
<h2>1.3.&nbsp;<strong>为什么程序计数器被设计成线程私有的？</strong></h2>
<p>假如现在有一本书，有好几个同学都想看，我们采取这样的策略让所有同学都能看到：每个人看一天，不管看没看完都要交给下一个人看，不断循环，直到所有人看完。每个同学都有一个小卡片记录自己看到了哪里，这样下次轮到自己看的时候就能快速的接着上次看到的地方继续看。</p>
<p>Java<span style="font-family: 宋体;">虚拟机中多线程采用时间片轮转的方式实现，一个处理器（如果是多核处理器就是一个内核）同一时间只能被一个线程使用，同一时间只能执行一个线程的指令，当时间片用完，处理器就要交给别的线程使用，为了下一次轮到自己使用处理器是能够接着执行现在的指令，使用一个计数器来记录。</span></p>]]></description></item><item><title>选择排序</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/12/12182274.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sun, 12 Jan 2020 03:52:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/12/12182274.html</guid><description><![CDATA[<h1>选择排序</h1>
<p>选择排序算法是对冒泡排序算法进行优化后得到的一种排序算法，相比冒泡排序，选择排序减少了对序列进行排序的过程中，序列元素移动的次数。</p>
<h2>原理</h2>
<p>以对序列进行升序排序为例：</p>
<p>1） 从待排序序列中选择一个待排序区间，假设待排序序列长度为n，则待排序区间由[0，n-1]、[0，n-2]、[0，n-3]逐渐减小到[0，1]。</p>
<p>2） 遍历待排序区间，找出待排序区间中的最大元素，遍历结束后将最大元素交换到待排序区间尾部。</p>
<p>3） 当所有待排序区间遍历结束，待排序序列有序。</p>
<h2>示例</h2>
<p>使用选择排序算法对序列89 45 68&nbsp;90 29 34 17 34 进行排序，排序过程如下：</p>
<h2><span style="font-size: 14px;"><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200112114923872-2137159172.png" alt="" width="1058" height="180" /></span></h2>
<h2>分析</h2>
<p>1） 选择排序是一种不稳定排序。</p>
<p>&nbsp; &nbsp; &nbsp; 观察上面示例中的&ldquo;第3次遍历&ldquo;，能够发现，序列中两个34的相对位置在排序前后发生了改变： 17 45 68 34 29 34 89 90 &rarr; 17 45 34 34 29 68 89 90</p>
<p>2） 相比较冒泡排序，选择排序显著减少了元素移动的次数。</p>
<p>&nbsp; &nbsp; &nbsp; 最坏情况下，对一个长度为n的倒序序列进行排序，使用冒泡排序需要移动元素的次数为n(n-1)/2，使用选择排序需要移动元素的次数为n-1。</p>
<p>3) 时间复杂度为O(n<sup>2</sup>)，空间复杂度为O(1)。</p>
<h2>优化</h2>
<p>使用以下方式对上文的选择排序算法进行优化：</p>
<p>1） 从待排序序列中选择一个待排序区间，假设待排序序列长度为n，则待排序区间为：[0，n-1]、[1，n-2]、[2，n-3]&hellip;&hellip;</p>
<p>2） 遍历待排序区间，找出待排序区间中的最大元素和最小元素，遍历结束后将最大元素和最小元素分别交换到当前待排序区间的尾部和头部。</p>
<p>3） 当所有待排序区间遍历结束，待排序序列有序。</p>
<p>&nbsp;</p>
<p>需要注意：若待排序区间内的最大元素恰好在区间头部，最小元素恰好在区间尾部，则只能进行一次交换。</p>
<p>&nbsp;</p>
<p>示例：使用优化后的选择排序算法对序列89 45 68&nbsp;90 29 34 17 34 进行排序。</p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200112115114935-898424348.png" alt="" width="1175" height="202" /></p>
<p>优化后的选择排序算法先比优化前，排序过程中遍历序列的次数减少了一半。&nbsp;</p>]]></description></item><item><title>单例模式</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/05/12153833.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sun, 05 Jan 2020 13:57:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/05/12153833.html</guid><description><![CDATA[<p><span style="font-size: 18px; font-family: 黑体;">单例模式在软件设计模式中所处的位置如下图所示：</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;<a href="https://github.com/xiaozhengyu/StudyNotes.git" target="_blank"><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200105214533692-294633848.png" alt="" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 18px;">在某些系统中，为了节省系统内存资源、保证数据的一致性，要求某些类只产生一个实例，这就是所谓的单例模式。</span></p>
<hr />
<p>&nbsp;</p>
<h1><strong>单例模式的定义和特点</strong></h1>
<p><span style="font-family: 黑体; font-size: 18px;">单例模式的<span style="text-decoration: underline;">定义</span>：单例类只有一个实例，且实例由单例类创建。例如，Windows 中只能打开一个任务管理器，这样可以避免因打开多个任务管理器窗口而造成内存资源的浪费，以及出现各个窗口显示内容的不一致的错误。</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">在计算机系统中，还有 Windows 的回收站、操作系统中的文件系统、多线程中的线程池、显卡的驱动程序对象、打印机的后台处理服务、应用程序的日志对象、数据库的连接池、网站的计数器、Web 应用的配置对象、应用程序中的对话框、系统中的缓存等常常被设计成单例。</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">单例模式有3个<span style="text-decoration: underline;">特点</span>：</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">1、单例类最多存在一个实例。</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">2、单例类负责创建自己的唯一实例。</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">3、单例类对外提供一个访问实例的接口。</span></p>
<hr />
<p>&nbsp;</p>
<h1><strong>单例模式的主要意图</strong></h1>
<p><span style="font-family: 黑体; font-size: 18px;">避免某些全局使用的类频繁的创建和销毁，减少系统开销，提升程序性能。</span></p>
<hr />
<p>&nbsp;</p>
<h1><strong>单例模式的实现思路</strong></h1>
<p align="justify"><span style="font-family: 黑体; font-size: 18px;">单例模式是最简单的软件设计模式之一。通常，普通类的构造函数的访问权限是公有的（public），外部类可以用过&ldquo;new 构造函数()&rdquo;的形式创建任意多个类的实例。将构造函数的访问权限设置为私有的（private），能够阻止外部类任意创建类的实例。</span></p>
<p align="justify"><span style="font-family: 黑体; font-size: 18px;">&nbsp;</span></p>
<p align="justify"><span style="font-family: 黑体; font-size: 18px;">在将构造函数的访问权限设置为私有的同时，在类中添加一个静态私有实例，并向外提供一个静态的公有方法用于访问实例，即可实现类的实例数量的控制。</span></p>
<hr />
<p align="justify">&nbsp;</p>
<h1><strong>Talk is cheap, Show me the code</strong></h1>
<p><span style="font-family: 黑体; font-size: 18px;">单例模式主要有以下几种实现方式。</span></p>
<h2><strong>懒汉式（线程不安全）</strong></h2>
<p align="center">&nbsp;<img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200105214704981-1290462745.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>实例创建时机</strong>：首次尝试获取实例时</span></p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>是否线程安全</strong>：否</span></p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>实现难度</strong>：易</span></p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>描述</strong>：这是实现单例模式的最基本方式，这种方式存在的最大问题是线程不安全，所以从严格意义上讲，它并不算单例模式（如果多个线程同时调用getInstance()方法，每个线程可能返回不同的实例）</span></p>
<hr />
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><strong>懒汉式（线程安全）</strong></h2>
<p>&nbsp;</p>
<p>&nbsp;<img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200105214801384-1660651521.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>实例创建时机</strong>：首次尝试获取实例时</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>是否线程安全</strong>：是</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>实现难度</strong>：易</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>描述</strong>：这种方式很好的支持了懒加载，并且能够在多线程中很好的工作，但是，效率偏低，因为只有创建实例的时候才需要解决线程安全问题，后续获取创建好的实例其实不需要枷锁。</span></p>
<hr />
<p>&nbsp;</p>
<h2><strong><span style="font-family: 黑体;">双检锁</span>/<span style="font-family: 黑体;">双重校验锁（</span><span style="font-family: Arial;">DCL</span></strong><strong>,</strong><strong>double-checked locking<span style="font-family: 黑体;">）</span></strong></h2>
<p>&nbsp;<img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200105214828668-358143301.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>实例创建时机</strong>：首次尝试获取实例时</span></p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>是否线程安全</strong>：是</span></p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>实现难度</strong>：较复杂</span></p>
<p><span style="font-family: 黑体; font-size: 18px;"><strong>描述</strong>：这种方式其实是对线程安全的懒汉模式的一种改进，即解决了线程安全问题，又保证了系统效率。</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">getInstance()方法的执行顺序为：</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">1、判断单例类是否已经实例化</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">2、如果已经实例化则返回实例</span></p>
<p><span style="font-family: 黑体; font-size: 18px;">3、如果没有实例化则获取锁，获取锁以后再次判断单例类是否已经实例，如果没有实例化则创建实例，否则返回实例。</span></p>
<hr />
<p>&nbsp;</p>
<h2><strong><span style="font-family: 黑体; font-size: 16pt;">饿汉式</span></strong></h2>
<p class="MsoNormal"><span style="mso-spacerun: 'yes'; font-family: Calibri; mso-fareast-font-family: 宋体; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;"><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200105214848312-1421348546.png" alt="" /></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>实例创建时机</strong>：在类被加载的时候就创建实例</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>是否线程安全</strong>：是</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>实现难度</strong>：易</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>描述</strong>：这种方式比较常用，但容易产生垃圾对象。因为实例在类加载时就创建完成，所以避免了线程安全问题，但是可能会造成内存的浪费。</span></p>
<hr />
<p class="MsoNormal">&nbsp;</p>
<h2><strong><span style="font-family: Arial; font-size: 16pt;"><span style="font-family: 黑体;">登记式</span>/<span style="font-family: 黑体;">静态内部类</span></span></strong></h2>
<p class="MsoNormal"><strong><span style="font-family: 宋体; font-size: 12pt;"><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200105214910444-21293007.png" alt="" /></span></strong></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>实例创建时机</strong>：首次尝试获取实例时</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>是否线程安全</strong>：是</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>实现难度</strong>：一般</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>描述</strong>：这种方式能达到双检锁方式一样的功效，但实现更简单。对静态域使用延迟初始化，应使用这种方式而不是双检锁方式。这种方式只适用于静态域的情况，双检锁方式可在实例域需要延迟初始化时使用。</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><span>这种方式同样利用了</span>类加载<span>机制来保证</span>创建实例<span>时只有一个线程，它跟</span>饿汉式<span>不同的是：</span>饿汉式<span>只要</span>单例<span>类被装载了，那么</span>实例<span>就会被</span>创建<span>（没有达到</span>懒加载<span>效果），而这种方式是</span>单例<span>类被装载了，</span>实例也不一定创建<span>。因为</span>SingletonHolder <span>类没有被主动使用，只有调用 </span><span>getInstance</span>()<span>方法时，才会显式装载</span>SingletonHolder<span>类，从而</span>创建单例类的实例<span>。</span></span></p>
<p class="MsoNormal">&nbsp;</p>
<hr />
<p class="MsoNormal">&nbsp;</p>
<h2><strong><span style="font-family: 黑体; font-size: 16pt;">枚举</span></strong></h2>
<h2><span style="mso-spacerun: 'yes'; font-family: 宋体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;"><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200105214923662-383447126.png" alt="" /></span></h2>
<p class="MsoNormal" style="text-align: center;" align="center">&nbsp;</p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong><span>是否</span> Lazy </strong><span><strong>初始化</strong>：否</span></span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>是否多线程安全</strong>：是</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>实现难度</strong>：易</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><strong>描述</strong>：这种实现方式还没有被广泛采用，但这是实现单例模式的最佳方法。它更简洁，自动支持序列化机制，绝对防止多次实例化。</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><span>这种方式是</span> Effective Java <span>作者 </span><span>Josh Bloch </span><span>提倡的方式，它不仅能避免多线程同步问题，而且还自动支持序列化机制，防止反序列化重新创建新的对象，绝对防止多次实例化。不过，由于 </span><span>JDK1.5 </span><span>之后才加入 </span><span>enum </span><span>特性，用这种方式写不免让人感觉生疏，在实际工作中，也很少用。</span></span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><span>不能通过</span> reflection attack <span>来调用私有构造方法。</span></span></p>
<p class="MsoNormal">&nbsp;</p>
<hr />
<p class="MsoNormal">&nbsp;</p>
<h1><strong><span style="font-family: 宋体; font-size: 22pt;">单例模式的适用场景</span></strong></h1>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;">单例模式适合在具有以下特点的场景中使用。</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><!--[if !supportLists]-->1、<!--[endif]-->在应用场景中，某类只要求生成一个对象的时候，如一个班中的班长、每个人的身份证号等。</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><!--[if !supportLists]-->2、<!--[endif]--><span>当对象需要被共享的场合。由于单例模式只允许创建一个对象，共享该对象可以节省内存，并加快对象访问速度。如</span> Web <span>中的配置对象、数据库的连接池等。</span></span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><!--[if !supportLists]-->3、<!--[endif]--><span>当某类需要频繁实例化，而创建的对象又频繁被销毁的时候，如多线程的线程池、网络连接池等。</span></span></p>
<p class="MsoNormal" style="mso-pagination: none; text-align: justify; text-justify: inter-ideograph;" align="justify"><span style="font-family: 黑体; font-size: 18px;">&nbsp;</span></p>
<p class="MsoNormal" style="mso-pagination: none; text-align: justify; text-justify: inter-ideograph;" align="justify"><span style="font-family: 黑体; font-size: 18px;">简单的说，当您想要控制实例的数量，节省系统资源的时候，可以考虑使用单例模式。</span></p>
<hr />
<p class="MsoNormal" style="mso-pagination: none; text-align: justify; text-justify: inter-ideograph;" align="justify">&nbsp;</p>
<h1><strong><span style="font-family: 宋体; font-size: 22pt;">单例模式的优点</span></strong></h1>
<p class="MsoNormal"><!--[if !supportLists]--><span style="font-family: 黑体; font-size: 18px;">1、<!--[endif]-->由于类的实例只有一个，内存的开销将被降低。</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><!--[if !supportLists]-->2、<!--[endif]-->由于实例由单例类创建，避免了频繁创建、销毁实例产生的开销。</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;"><!--[if !supportLists]-->3、<!--[endif]-->避免多个实例对系统资源的多重占用（如文件操作）。</span></p>
<hr />
<p class="MsoNormal">&nbsp;</p>
<h1><strong><span style="font-family: 宋体; font-size: 22pt;">单例模式的缺点</span></strong></h1>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;">1<span>、</span><span>由于单利模式中没有抽象层，因此单例类的扩展有很大的困难</span>，违背了依赖倒置原则。&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;">2<span>、</span><span>单例类的职责过重，在一定程度上违背了</span>&ldquo;<span>单一职责原则</span>&rdquo;<span>。</span> </span></p>
<hr />
<p class="MsoNormal">&nbsp;</p>
<h1><strong><span style="font-family: 宋体; font-size: 22pt;">单例模式的拓展</span></strong></h1>
<p class="MsoNormal"><span style="font-family: 黑体; font-size: 18px;">单例模式可以拓展为有限多例模式，即使用某种集合存储若干个实例供客户端存取使用。</span></p>
<p class="MsoNormal">&nbsp;</p>
<p>&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200105214821894-2129774502.png" alt="" /></p>
]]></description></item><item><title>单一职责原则</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/04/12149154.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 04 Jan 2020 07:18:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/04/12149154.html</guid><description><![CDATA[<p><a href="https://github.com/xiaozhengyu/StudyNotes.git" target="_blank"><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200104151332756-1952281926.png" alt="" /></a></p>
<p align="center">单一职责原则</p>
<h1>1.&nbsp;<strong>定义</strong></h1>
<p>单一职责原则（<span style="color: #0000ff;">SRP</span><span style="font-family: 宋体;">：</span>Single responsibility principle<span style="font-family: 宋体;">）又称单一功能原则，单一职责原则规定：</span><span style="color: #ff0000;">一个类应该只有一个发生变化的原因</span><span style="font-family: 宋体;">（</span>There should never be more than one reason for a class to change<span style="font-family: 宋体;">）。</span><span style="font-family: 宋体;">所谓职责是指类</span>发生<span style="font-family: 宋体;">变化的原因</span><span style="font-family: 宋体;">。</span></p>
<h1>2.&nbsp;<strong><span style="font-family: 宋体;">原理</span></strong></h1>
<p>如果一个类承担的职责过多，职责间可能会相互<a href="https://baike.baidu.com/item/%E8%80%A6%E5%90%88/2821124">耦合</a>。一个职责的变化可能会对其他职责造成影响。想要避免这种现象的发生，就要尽可能的遵守单一职责原则。</p>
<h1>3.&nbsp;<strong>核心</strong></h1>
<p>单一职责原则的核心是职责解耦和增强类的内聚性。</p>
<h1>4.&nbsp;<strong>必要性</strong></h1>
<p>单一职责原则的本意是限制一个类不要承担太多职责，如果一个类承担了太多的职责，将至少存在以下缺点：</p>
<p>1.&nbsp; <span style="font-family: 宋体;">职责耦合度高。一个类承担多个职责，这些职责很可能会耦合在一起，一个</span> 职责的改变，可能会影响到其他职责。</p>
<p>2. &nbsp;<span style="font-family: 宋体;">类的复用性低。粒度越大的类，复用性越低。</span></p>
<p>3. &nbsp;<span style="font-family: 宋体;">职责调用成本高。当客户端需要该对象的某一个职责时，不得不将其他不需</span> 要的职责全都包含进来，从而造成冗余代码或代码的浪费。</p>
<h1>5.&nbsp;<strong>作用</strong></h1>
<p>遵循单一职责原则在软件系统中具有下列作用：</p>
<ol>
<li>降低类的复杂度。一个类只负责一项职责，其逻辑肯定要比负责多项职责简单得多。</li>
<li>提高类的可读性。复杂性降低，自然其可读性会提高。</li>
<li>提高系统可维护性。可读性提高，那自然更容易维护了。</li>
<li>降低变更引起的风险。变更是必然的，如果单一职责原则遵守得好，当修改一个功能时，可以显著降低对其他功能的影响。</li>
<li>提高类的可复用性。类的粒度越低，可复用性越强。</li>
</ol>
<h1>6.&nbsp;<strong>实现方法</strong></h1>
<p><span style="font-family: 宋体;">单一职责原则是最简单但又最难运用的原则，需要设计人员发现类的不同职责并将其分离，再封装到不同的类或模块中。而发现类的多重职责需要设计人员具有较强的分析设计能力和相关重构经验。</span></p>
<h1>7.&nbsp;<strong>其他</strong></h1>
<h2>7.1.&nbsp;<strong>单一职责原则同样适用于方法</strong></h2>
<p>一个方法应该尽可能做好一件事情，如果一个方法处理的事情太多，其颗粒度将变得很大，不利于重用。</p>
]]></description></item><item><title>依赖倒置原则</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/04/12149120.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 04 Jan 2020 07:09:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/04/12149120.html</guid><description><![CDATA[<p><a href="https://github.com/xiaozhengyu/StudyNotes.git" target="_blank"><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200104145954407-583251541.png" alt="" /></a></p>
<p>&nbsp;</p>
<h1>1.&nbsp;<strong>定义</strong></h1>
<p><span style="font-family: 宋体;">依赖倒置原则（</span>Dependence Inversion Principle，<span style="color: #0000ff;">DIP</span><span style="font-family: 宋体;">）是</span>Object Mentor<span style="font-family: 宋体;">公司总裁罗伯特&middot;马丁（</span><span style="font-family: Calibri;">Robert C.Martin</span><span style="font-family: 宋体;">）于</span><span style="font-family: Calibri;">1996</span><span style="font-family: 宋体;">年</span>在C++ Report<span style="font-family: 宋体;">上发表的文章。</span></p>
<p>&nbsp;</p>
<p>依赖倒置原则的<span style="text-decoration: underline;">原始定义</span>：<span style="color: #ff0000;">高层模块不应该依赖底层模块，两者都应该依赖抽象；抽象不应该依赖细节，细节应该依赖抽象</span><span style="font-family: 宋体;">（</span>High level modules should not depend upon low level modules.Both should depend upon abstractions.Details should not depend upon details.Details should depend upon abstractions<span style="font-family: 宋体;">）。</span></p>
<h1>2.&nbsp;<strong>核心思想</strong></h1>
<p>依赖倒置原则的<span style="text-decoration: underline;">核心思想</span>是：<span style="color: #ff0000;">要面向接口编程，不要面向实现编程</span>。</p>
<h1>3.&nbsp;<strong>重要性</strong></h1>
<p><span style="text-decoration: underline;">依赖倒置原则是实现开闭原则的重要途径之一，它降低了功能使用模块与功能提供模块之间的耦合度。</span></p>
<p>&nbsp;</p>
<p>在软件设计中，<span style="color: #0000ff;">细节具有多变性，抽象则相对稳定，因此以抽象为基础搭建起来的架构要比以细节为基础搭建起来的架构要稳定得多</span>。这里的抽象指的是接口或者抽象类，而细节是指具体的实现类。</p>
<h1>4.&nbsp;<strong>作用</strong></h1>
<p>依赖倒置的主要作用如下：</p>
<ol>
<li>降低类间的耦合度</li>
</ol>
<p>2. <span style="font-family: 宋体;">提高系统的稳定性</span></p>
<p>3. <span style="font-family: 宋体;">降低并行开发的风险</span></p>
<p>4. <span style="font-family: 宋体;">提高代码可读性和可维护性</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>5.&nbsp;<strong>实现方法</strong></h1>
<p>依赖倒置原则的目的是通过面向接口编程来降低类间的耦合度，<span style="font-family: 宋体;">所以我们在实际编程中要遵循以下</span>4<span style="font-family: 宋体;">点：</span></p>
<ol>
<li>每个类尽量提供接口或抽象类，或者两者都具备。</li>
<li>变量的声明类型尽量是接口或者抽象类。</li>
<li>任何类都不应该从具体类派生。</li>
<li>使用继承时尽量遵循里氏替换原则。</li>
</ol>
<h1>6.&nbsp;<strong>如何理解</strong></h1>
<p><span style="font-family: 宋体;">下面以</span>&ldquo;顾客购物程序&rdquo;为例来说明依赖倒置原则的应用。<br /><br /><span style="font-family: 宋体;">【例</span>1<span style="font-family: 宋体;">】依赖倒置原则在&ldquo;顾客购物程序&rdquo;中的应用。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">分析：本程序反映了</span>&ldquo;顾客类&rdquo;与&ldquo;商店类&rdquo;的关系。商店类中有<span style="font-family: Calibri;">sell()</span><span style="font-family: 宋体;">方法，顾客类通过该方法购物，以下代码定义了顾客类通过韶关网店 </span><span style="font-family: Calibri;">ShaoguanShop </span><span style="font-family: 宋体;">购物：</span></p>
<table border="1" cellspacing="0">
<tbody>
<tr>
<td valign="top" width="852">
<p class="pre">class Customer<br /><em>{</em><em><br /></em><em>&nbsp;&nbsp;&nbsp;&nbsp;</em>public void shopping<em>(</em><span style="color: #ff0000;">ShaoguanShop</span>&nbsp;shop<em>)</em><em><br /></em><em>&nbsp;&nbsp;&nbsp;&nbsp;{</em><em><br /></em><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em>//购物<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<em>out</em>.println（shop.sell<em>()</em>);<br />&nbsp;&nbsp;&nbsp;&nbsp;<em>}</em><em><br /></em><em>}</em></p>
<p>&nbsp;</p>

</td>

</tr>

</tbody>

</table>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">但是，这种设计存在缺点，如果该顾客想从另外一家商店（如婺源网店</span> WuyuanShop<span style="font-family: 宋体;">）购物，就要将该顾客的代码修改如下：</span></p>
<table border="1" cellspacing="0">
<tbody>
<tr>
<td valign="top" width="852">
<p class="pre">class Customer<br /><em>{</em><em><br /></em><em>&nbsp;&nbsp;&nbsp;&nbsp;</em>public void shopping<em>(</em><span style="color: #ff0000;">WuyuanShop&nbsp;</span>shop<em>)</em><em><br /></em><em>&nbsp;&nbsp;&nbsp;&nbsp;{</em><em><br /></em><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em>//购物<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<em>out</em>.println<em>(</em>shop.sell<em>())</em>;<br />&nbsp;&nbsp;&nbsp;&nbsp;<em>}</em><em><br /></em><em>}</em></p>

</td>

</tr>

</tbody>

</table>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">顾客每更换一家商店，都要修改一次代码，这明显违背了开闭原则。存在以上缺点的原因是：顾客类设计时同具体的商店类绑定了，这违背了依赖倒置原则。解决方法是：定义</span>&ldquo;婺源网店&rdquo;和&ldquo;韶关网店&rdquo;的共同接口 <span style="font-family: Calibri;">Shop</span><span style="font-family: 宋体;">，顾客类面向该接口编程，其代码修改如下：</span></p>
<table border="1" cellspacing="0">
<tbody>
<tr>
<td valign="top" width="852">
<p class="pre">class Customer<br /><em>{</em><em><br /></em><em>&nbsp;&nbsp;&nbsp;&nbsp;</em>public void shopping<em>(</em><span style="color: #ff0000;">Shop</span> shop<em>)</em><em><br /></em><em>&nbsp;&nbsp;&nbsp;&nbsp;{</em><em><br /></em><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em>//购物<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.<em>out</em>.println<em>(</em>shop.sell<em>())</em>;<br />&nbsp;&nbsp;&nbsp;&nbsp;<em>}</em><em><br /></em><em>}</em></p>

</td>

</tr>

</tbody>

</table>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">这样，不管顾客类</span>Customer<span style="font-family: 宋体;">访问什么商店，或者增加新的商店，都不需要修改原有代码了，其类图如图 </span><span style="font-family: Calibri;">1 </span><span style="font-family: 宋体;">所示。</span></p>
<p>&nbsp;<a href="https://github.com/xiaozhengyu/StudyNotes.git" target="_blank"><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200104150303503-1917514924.png" alt="" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="center"><span style="font-family: 微软雅黑;">图</span>1 顾客购物程序的类图</p>
<p style="text-align: left;" align="center">（学习到这里的时候可以去了解一下<span style="color: #0000ff;">控制反转</span>和<span style="color: #0000ff;">依赖注入</span>的概念）&nbsp;</p>
<h1 style="text-align: left;">7.&nbsp;<strong>其他问题</strong></h1>
<h2>7.1.&nbsp;<strong>如何理解依赖倒置原则是实现开闭原则的途径？</strong></h2>
<p><span style="font-family: 宋体;">回答问题前不妨先回想一下，什么是开闭原则</span>&mdash;&mdash;&ldquo;软件实体应该对扩展开放，对修改关闭&rdquo;，意思是，在软件开发的过程中，不通过修改模块、类、接口、方法等实体的方式来满足新的需求，而是通过扩展的方式来满足新的需求。</p>
<p>&nbsp;</p>
<p>遵循依赖倒置原则开发的软件系统整体结构比较稳定，高低层模块间耦合度较低，因此能够非常简单的将新的实现类引入系统，并且不影响系统中的其他实现类</p>
]]></description></item><item><title>里氏替换原则</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/01/12128721.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 01 Jan 2020 05:29:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/01/12128721.html</guid><description><![CDATA[<h1><a href="https://github.com/xiaozhengyu/StudyNotes.git" target="_blank"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200101130710465-6675680.png" alt="" /></a></h1>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>1.&nbsp;<strong>里氏替换原则的定义</strong></h1>
<p><span style="font-family: 宋体;">里氏替换原则（</span>Liskov Substitution Principle<span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">LSP</span><span style="font-family: 宋体;">）由麻省理工学院计算机科学实验室的里斯科夫（</span><span style="font-family: Calibri;">Liskov</span><span style="font-family: 宋体;">）女士在 </span><span style="font-family: Calibri;">1987 </span><span style="font-family: 宋体;">年的&ldquo;面向对象技术的高峰会议&rdquo;（</span><span style="font-family: Calibri;">OOPSLA</span><span style="font-family: 宋体;">）上发表的一篇文章《数据抽象和层次》（</span><span style="font-family: Calibri;">Data Abstraction and Hierarchy</span><span style="font-family: 宋体;">）中提出：</span><strong>继承必须确保超类拥有的性质在子类中仍然成立</strong><span style="font-family: 宋体;">（</span>Inheritance should ensure that any property proved about supertype objects also holds for subtype objects<span style="font-family: 宋体;">）。也就是说：</span><span style="text-decoration: underline;"><span style="font-family: 宋体;">当一个子类的实例能够替换任何父类的实例时，它们之间才具有</span>is-A<span style="font-family: 宋体;">关系。</span></span></p>
<p>&nbsp;</p>
<p>里氏替换原则主要阐述了有关继承的一些原则，即什么时候应该使用继承，什么时候不应该使用继承，以及其中蕴含的原理。里氏替换原则是继承复用的基础，它反映了基类与子类之间的关系，是开闭原则的补充，是实现抽象化的具体步骤的规范。</p>
<h1>2.&nbsp;<strong>里氏替换原则的含义</strong></h1>
<p>里氏替换原则通俗的讲就是：<strong>子类可以拓展父类的功能，但不能改变父类原有的功能。</strong>也就是说：由父类派生出子类时，除了添加新的方法完成新增功能外，尽量不要重写父类的方法。</p>
<p>&nbsp;</p>
<p>如果通过重写父类的方法来完成新的功能，这样写起来虽然简单，但是整个继承体系的可复用性会比较差，特别是运用多态比较频繁时，程序运行出错的概率会很大。</p>
<h1>3.&nbsp;<strong>里氏替换原则的作用</strong></h1>
<p>1<span style="font-family: 宋体;">、是实现开闭原则的重要方式之一。</span></p>
<p>2<span style="font-family: 宋体;">、克服了继承机制中重写父类造成的可复用性变差的缺点。</span><span style="font-family: 宋体;">如果子类重写了从父类继承到的方法，可能导致子类的实例无法替代父类的实例，即复用性变差。</span></p>
<p>3<span style="font-family: 宋体;">、是动作正确性的保证。即类的扩展不会给已有的系统引入新的错误，降低了代码出错的可能性。</span></p>
<h1>4.&nbsp;<strong>里氏替换原则的实现方法</strong></h1>
<p><span style="font-family: 宋体;">如果程序违背了里氏替换原则，则继承类的对象在基类出现的地方会出现运行错误。这时其修正方法是：</span><span style="font-family: 宋体;"><strong>取消原来的继承关系，重新设计它们之间的关系</strong>。</span></p>
<h1>5.&nbsp;<strong>里氏替换原则的形象理解</strong></h1>
<p><span style="font-family: 宋体;">在学习</span>OO<span style="font-family: 宋体;">的时候，我们知道，一个对象是一组状态和一系列行为的组合体。状态是对象的内在特性，行为是对象的外在特性。里氏替换原则所表述的就是在同一个继承体系中的对象应该有相同的行为特征。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">在这一点上，体现了</span>OO<span style="font-family: 宋体;">的继承和日常生活中的继承的本质区别。举个例子：生物学中将企鹅划分为鸟类，我们以此为参照设计出这样的类和关系：&ldquo;鸟&rdquo;类中有个</span><span style="font-family: Calibri;">fly</span><span style="font-family: 宋体;">方法，&ldquo;企鹅&rdquo;类继承了这个</span><span style="font-family: Calibri;">fly</span><span style="font-family: 宋体;">方法，但是我们知道企鹅不会飞，于是我们在&ldquo;企鹅&rdquo;类中覆盖了</span><span style="font-family: Calibri;">fly</span><span style="font-family: 宋体;">方法，告诉调用者：&ldquo;企鹅是不会飞的&rdquo;，这样的设计完全符合常理，但是，它违反了里氏替换原则，企鹅是鸟类，可是企鹅却不能飞！需要注意的是，此处的&ldquo;鸟&rdquo;已经不再是生物学中的鸟了，它是软件中的一个类、一个抽象。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">有人会说：</span>&ldquo;企鹅不能飞这很正常啊，而且这样编写的代码也能正常编译，只要在使用这个类的客户代码中添加一条判断就好了呀！&rdquo;，这就是问题的所在！首先，客户代码和&ldquo;企鹅&rdquo;的代码很有可能不是同时设计的，在当今软件外包一层又一层的开发模式下，你甚至不知道两个模块的原产地是哪里，也就谈不上去修改客户端代码了。客户程序很可能是遗留系统的一部分，很可能已经不再维护，如果因为设计出这么一个&ldquo;企鹅&rdquo;而导致必须修改客户代码，谁应该为此部分工作负责呢？<span style="color: #ff0000;">&ldquo;修改客户代码&rdquo;直接违反了开闭原则</span><span style="font-family: 宋体;">，这就是</span>OCP<span style="font-family: 宋体;">原则的重要性，违反里氏替换原则将使既有的设计不能封闭。</span></p>
<h1>6.&nbsp;<strong>其他问题</strong></h1>
<h2>6.1.&nbsp;<strong>如何理解</strong><strong><span style="text-decoration: underline;">里氏替换原则是对开闭原则的补充</span></strong><strong>？</strong></h2>
<p><span style="font-family: 宋体;">回答这个问题前不妨先回想一下什么是开闭原则</span><span style="font-family: 宋体;">&mdash;&mdash;&ldquo;软件实体应该对扩展开放，对修改关闭&rdquo;，依照开闭原则，在软件开发的过程中，不通过修改功能模块、类、接口、方法等实体的方式来实现新的需求，而是用过扩展的方式来满足新的需求。</span></p>
<p>&nbsp;</p>
<p>对类的扩展指的就是由基类派生子类，里氏替换原则对由基类派生子类的具体步骤做了规范，所以说里氏替换原则是对开闭原则的补充。</p>
<h2>6.2.&nbsp;<strong>LSP<span style="font-family: 黑体;">原则&mdash;&mdash;关于正方形不是长方形</span></strong></h2>
<p><span style="font-family: 宋体;">假设有</span>&ldquo;长方形&rdquo;类：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Rectangle {
</span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">double</span><span style="color: #000000;"> length;
</span><span style="color: #008080;"> 3</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">double</span><span style="color: #000000;"> width;
</span><span style="color: #008080;"> 4</span> 
<span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setLength(<span style="color: #0000ff;">double</span><span style="color: #000000;"> length) {
</span><span style="color: #008080;"> 6</span>         <span style="color: #0000ff;">this</span>.length =<span style="color: #000000;"> length;
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setWidth(<span style="color: #0000ff;">double</span><span style="color: #000000;"> width) {
</span><span style="color: #008080;">10</span>         <span style="color: #0000ff;">this</span>.width =<span style="color: #000000;"> width;
</span><span style="color: #008080;">11</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span><span style="color: #000000;"> getArea() {
</span><span style="color: #008080;">14</span>         <span style="color: #0000ff;">return</span> length *<span style="color: #000000;"> width;
</span><span style="color: #008080;">15</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">16</span> }</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">由</span>&ldquo;长方形&rdquo;类派生出&ldquo;正方形&rdquo;类：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Square <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Rectangle {
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setLength(<span style="color: #0000ff;">double</span><span style="color: #000000;"> length) {
</span><span style="color: #ff0000;"> 5 </span>        <span style="color: #0000ff;">super</span><span style="color: #000000;">.setLength(length);
</span><span style="color: #ff0000;"> 6 </span>        <span style="color: #0000ff;">super</span><span style="color: #000000;">.setWidth(length);
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">10</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setWidth(<span style="color: #0000ff;">double</span><span style="color: #000000;"> width) {
</span><span style="color: #ff0000;">11</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.setWidth(width);
</span><span style="color: #ff0000;">12</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.setLength(width);
</span><span style="color: #008080;">13</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">14</span> }</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">从数学的角度看，正方形是一种特殊的长方形</span>&mdash;&mdash;长宽相等，为了保证正方形的这个特性，&ldquo;正方形&rdquo;类对由&ldquo;长方形&rdquo;类继承来的<span style="font-family: Calibri;">setLength()</span><span style="font-family: 宋体;">、</span><span style="font-family: Calibri;">setWidth()</span><span style="font-family: 宋体;">方法进行了修改。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">以上代码中体现的继承体系初看没有什么问题，但是我们来考虑一下这么一个使用场景：使用者获取一个长方形实例，设置长和宽，调用</span>getArea<span style="font-family: 宋体;">方法获取长方形面积。这是一种非常简单的使用，但是可能出现下面的两种代码：</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">代码</span>1<span style="font-family: 宋体;">：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
</span><span style="color: #ff0000;">2</span>     Rectangle rectangle = <span style="color: #0000ff;">new</span><span style="color: #000000;"><span style="color: #ff0000;"> Rectangle()</span>;
</span><span style="color: #008080;">3</span>     rectangle.setLength(3<span style="color: #000000;">);
</span><span style="color: #008080;">4</span>     rectangle.setWidth(4<span style="color: #000000;">);
</span><span style="color: #008080;">5</span>     System.out.println("长方形的面积 = " +<span style="color: #000000;"> rectangle.getArea());
</span><span style="color: #008080;">6</span> }</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">代码</span>2<span style="font-family: 宋体;">：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> ublic <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
</span><span style="color: #ff0000;">2 </span>    Rectangle rectangle = <span style="color: #0000ff;">new</span><span style="color: #000000;"><span style="color: #ff0000;"> Square()</span>;
</span><span style="color: #ff0000;">3</span>     rectangle.setLength(3<span style="color: #000000;">);
</span><span style="color: #ff0000;">4</span>     rectangle.setWidth(4<span style="color: #000000;">);
</span><span style="color: #008080;">5</span>     System.out.println("长方形的面积 = " +<span style="color: #000000;"> rectangle.getArea());
</span><span style="color: #008080;">6</span> }</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">代码</span>1<span style="font-family: 宋体;">中，使用者先获取一个长方形实例，然后设置长度为</span><span style="font-family: Calibri;">3</span><span style="font-family: 宋体;">，宽度为</span><span style="font-family: Calibri;">4</span><span style="font-family: 宋体;">，最后调用</span><span style="font-family: Calibri;">getArea()</span><span style="font-family: 宋体;">方法，程序输出结果&ldquo;长方形的面积 </span><span style="font-family: Calibri;">= 12</span><span style="font-family: 宋体;">&rdquo;，这与使用者的预期相符。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">代码</span>2<span style="font-family: 宋体;">中，使用者先获取一个&ldquo;长方形&rdquo;实例， 然后设置长度为</span><span style="font-family: Calibri;">3</span><span style="font-family: 宋体;">，宽度为</span><span style="font-family: Calibri;">4</span><span style="font-family: 宋体;">，最后调用</span><span style="font-family: Calibri;">getArea()</span><span style="font-family: 宋体;">方法，程序输出结果&ldquo;长方形的面积 </span><span style="font-family: Calibri;">= 16</span><span style="font-family: 宋体;">&rdquo;，结果显然与使用者的预期不符。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">按照里氏替换原则的要求，子类应该保留父类的功能，任何使用父类实例的地方都应该能用子类实例替换，以上的继承机制显然没有不满足该要求，所以从里氏替换原则的角度</span>&ldquo;正方形不是长方形&rdquo;。</p>]]></description></item><item><title>开闭原则</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/01/12128679.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 01 Jan 2020 05:00:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2020/01/01/12128679.html</guid><description><![CDATA[<h1><a href="https://github.com/xiaozhengyu/StudyNotes.git" target="_blank"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200101130552923-387318669.png" alt="" /></a></h1>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>1.&nbsp;<strong><span style="font-family: 宋体;">开闭原则的定义</span></strong></h1>
<p align="justify"><span style="font-family: 宋体;">开闭原则（</span>Open Closed Principle<span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">OCP</span><span style="font-family: 宋体;">）由勃兰特</span><span style="font-family: Calibri;">&middot;</span><span style="font-family: 宋体;">梅耶（</span><span style="font-family: Calibri;">Bertrand Meyer</span><span style="font-family: 宋体;">）提出，他在 </span><span style="font-family: Calibri;">1988 </span><span style="font-family: 宋体;">年的著作《面向对象软件构造》（</span><span style="font-family: Calibri;">Object Oriented Software Construction</span><span style="font-family: 宋体;">）中提出：<span style="color: #ff0000;">软件实体应当对扩展开放，对修改关闭</span>（</span><span style="font-family: Calibri;">Software entities should be open for extension</span><span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">but closed for modification</span><span style="font-family: 宋体;">），这就是开闭原则的经典定义。</span></p>
<p align="justify">&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">这里的</span><span style="font-family: 宋体;">软件实体</span><span style="font-family: 宋体;">包括以下几个部分：</span></p>
<p align="justify">1.<span style="font-family: 宋体;">项目中划分出的模块</span></p>
<p align="justify">2.<span style="font-family: 宋体;">类与接口</span></p>
<p align="justify">3.<span style="font-family: 宋体;">方法</span></p>
<p align="justify">&nbsp;</p>
<p align="justify"><span style="font-family: 微软雅黑;">开闭原则的<strong>含义</strong>是：<span style="text-decoration: underline;">当应用的需求改变时，在不修改软件实体的源代码或者二进制代码的前提下，可以扩展模块的功能，使其满足新的需求。</span></span></p>
<h1>2.&nbsp;<strong><span style="font-family: 宋体;">开闭原则的作用</span></strong></h1>
<p align="justify"><span style="font-family: 宋体;">开闭原则是面向对象程序设计的终极目标，它<span style="text-decoration: underline;">使软件实体具备稳定性和延续性的同时拥有一定的适应性和灵活性</span>。具体来说，其作用如下。</span></p>
<p align="justify">1.&nbsp;&nbsp;<span style="color: #0000ff;">减少<span style="font-family: 宋体;">软件测试的工作量</span></span></p>
<p align="justify"><span style="font-family: 宋体;">软件遵守开闭原则的话，软件测试时只需要对扩展的代码进行测试就可以了，因为原有的测试代码仍然能够正常运行。</span></p>
<p align="justify">2.<span style="font-family: 宋体; color: #0000ff;"> 提高代码的可复用性</span></p>
<p align="justify"><span style="font-family: 宋体;">粒度越小，被复用的可能性就越大；在面向对象的程序设计中，根据原子和抽象编程可以提高代码的可复用性。</span></p>
<p align="justify">3.&nbsp;&nbsp;<span style="font-family: 宋体; color: #0000ff;">提高软件的可维护性</span></p>
<p align="justify"><span style="font-family: 宋体;">遵守开闭原则的软件，其稳定性高和延续性强，从而易于扩展和维护。</span></p>
<p align="justify">&nbsp;</p>
<h1>3.&nbsp;<strong><span style="font-family: 宋体;">开闭原则的实现方法</span></strong></h1>
<p align="justify"><span style="font-family: 宋体;">可以通过</span><span style="color: #ff0000;">&ldquo;<span style="font-family: 微软雅黑;">抽象约束、封装变化</span>&rdquo;</span><span style="font-family: 宋体;">来实现开闭原则，即<span style="text-decoration: underline;">通过接口或者抽象类为软件实体定义一个相对稳定的</span></span><span style="text-decoration: underline;"><span style="font-family: 微软雅黑;">抽象层</span></span><span style="font-family: 宋体;"><span style="text-decoration: underline;">，而将相同的可变因素封装在具体实现类中</span>。</span></p>
<p align="justify">&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">因为抽象灵活性好，适应性广，只要抽象的合理，可以基本保持软件架构的稳定。而软件中易变的细节可以从抽象派生来的实现类来进行扩展，当软件需要发生变化时，只需要根据需求重新派生一个实现类来扩展就可以了。</span></p>
<p align="justify">&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">下面以</span> Windows <span style="font-family: 宋体;">的桌面主题为例介绍开闭原则的应用。</span></p>
<p align="justify">&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">【例</span>1<span style="font-family: 宋体;">】</span><span style="font-family: Calibri;">Windows </span><span style="font-family: 宋体;">的桌面主题设计。</span></p>
<p align="justify">&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">分析：</span>Windows <span style="font-family: 宋体;">的主题是桌面背景图片、窗口颜色和声音等元素的组合。用户可以根据自己的喜爱更换自己的桌面主题，也可以从网上下载新的主题。这些主题有共同的特点，可以为其定义一个抽象类（</span><span style="font-family: Calibri;">Abstract Subject</span><span style="font-family: 宋体;">），而每个具体的主题（</span><span style="font-family: Calibri;">Specific Subject</span><span style="font-family: 宋体;">）是其子类。用户窗体可以根据需要选择或者增加新的主题，而不需要修改原代码，所以它是满足开闭原则的，其类图如图 </span><span style="font-family: Calibri;">1 </span><span style="font-family: 宋体;">所示。</span></p>
<p align="center"><img src="https://img2018.cnblogs.com/i-beta/1689384/202001/1689384-20200101125846716-806781293.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="center"><br /><span style="font-family: 微软雅黑;">图</span>1 Windows的桌面主题类图</p>
<p style="text-align: left;" align="center">&nbsp;</p>]]></description></item><item><title>Java高级特性——注解（Annotation）</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/31/12123897.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Tue, 31 Dec 2019 05:07:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/31/12123897.html</guid><description><![CDATA[<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201912/1689384-20191231130325096-795373654.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201912/1689384-20191231130159131-1354187571.png" alt="" /></p>
<p>&nbsp;</p>
<hr />
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201912/1689384-20191231130531282-780111962.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;文件地址：<a href="https://github.com/xiaozhengyu/StudyNotes.git" target="_blank">https://github.com/xiaozhengyu/StudyNotes.git</a></p>]]></description></item><item><title>Java高级特性——流</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/31/12123880.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Tue, 31 Dec 2019 04:58:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/31/12123880.html</guid><description><![CDATA[<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201912/1689384-20191231125417936-1537456163.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;<img src="https://img2018.cnblogs.com/i-beta/1689384/201912/1689384-20191231125336124-723612724.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;以上就是这段时间学习完流的知识以后我的总结，.mmap文件可以去我的github上获取:<a href="https://github.com/xiaozhengyu/StudyNotes.git" target="_blank">https://github.com/xiaozhengyu/StudyNotes.git</a></p>]]></description></item><item><title>Github库名命名规范</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/24/12090844.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Tue, 24 Dec 2019 04:28:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/24/12090844.html</guid><description><![CDATA[<p>Github库名命名规范<br />一、必要性说明<br />由于迁移到Github上的项目越来越多，对项目的管理越来越困难。由于各项目命名具有随意性，用之代表git仓库名后就很难快速回忆起这个项目的相关细节，通常需要不断打开某个库才能有所了解。因此，十分必要对git库名命名方式进行规范以便于项目的管理。</p>
<p>二、命名规则<br />GIT库名一律采用项目名-类型-年月的形式。其中对项目名的规范如下：</p>
<p>库名中不得出现下述规定的字符- \ @ ! # $ % ^ &amp; * () [] {} | \ ; : '' &rsquo; ， 。 《 》 &lt; &gt; &middot; ~ 。<br />库名应尽量避免使用 名.名的形式。<br />库名应尽量使用英文，禁止使用中文字符。一般情况下，库名中出现的各个单词的首字母应使用大写。各个单词不能使用连接符 -连接；如有必要，应使用下划线 _ 。<br />缩写的单词一律使用大写。<br />对类型的规定如下：</p>
<p>TST&mdash;&mdash;测试项目</p>
<p>BC&mdash;&mdash;已完成项目</p>
<p>SUS&mdash;&mdash;被搁置项目</p>
<p>ING&mdash;&mdash;正在进行的项目</p>
<p>TST-BC&mdash;&mdash;已完成的测试项目</p>
<p>TST-SUS&mdash;&mdash;被搁置的测试项目</p>
<p>TST-ING&mdash;&mdash;正在进行的测试项目<br />&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;<br />版权声明：本文为CSDN博主「奔跑的QQEE」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。<br />原文链接：https://blog.csdn.net/qq_33712555/article/details/78916570</p>]]></description></item><item><title>Navicat Premium连接Oracle数据库</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/16/12048282.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Mon, 16 Dec 2019 03:38:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/16/12048282.html</guid><description><![CDATA[<p>记录一下本次配置过程中遇到的问题：</p>
<p>一、服务名</p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201912/1689384-20191216113341321-417287139.png" alt="" width="500" /></p>
<p>&nbsp;</p>
<p>&nbsp;1、找到tnsnames.ors文件：<img src="https://img2018.cnblogs.com/i-beta/1689384/201912/1689384-20191216113515277-1420937317.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="https://img2018.cnblogs.com/i-beta/1689384/201912/1689384-20191216113539168-1277632585.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;二、Navicat自带的oci.dll文件版本可能和Oracle数据库不一致，所以使用oracle自带的oci.dll文件</p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201912/1689384-20191216113734514-1894639480.png" alt="" /></p>
]]></description></item><item><title>ThreadLocal源码阅读</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/16/12047268.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Mon, 16 Dec 2019 00:35:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/16/12047268.html</guid><description><![CDATA[<div class="cnblogs_code">
<pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> java.lang;
</span><span style="color: #008080;">  2</span> 
<span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.ref.WeakReference;
</span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Objects;
</span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.concurrent.atomic.AtomicInteger;
</span><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.function.Supplier;
</span><span style="color: #008080;">  7</span> 
<span style="color: #008080;">  8</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;">  9</span> <span style="color: #008000;"> * This class provides thread-local variables.  These variables differ from
</span><span style="color: #008080;"> 10</span> <span style="color: #008000;"> * their normal counterparts in that each thread that accesses one (via its
</span><span style="color: #008080;"> 11</span> <span style="color: #008000;"> * {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> get} or {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> set} method) has its own, independently initialized
</span><span style="color: #008080;"> 12</span> <span style="color: #008000;"> * copy of the variable.  {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> ThreadLocal} instances are typically private
</span><span style="color: #008080;"> 13</span> <span style="color: #008000;"> * static fields in classes that wish to associate state with a thread (e.g.,
</span><span style="color: #008080;"> 14</span> <span style="color: #008000;"> * a user ID or Transaction ID).
</span><span style="color: #008080;"> 15</span> <span style="color: #008000;"> * 本类提供线程局部变量。这些变量和普通变量不同，每一个线程访问（通过get和set方法）
</span><span style="color: #008080;"> 16</span> <span style="color: #008000;"> * 的变量都是属于线程的独立初始化的一个线程局部变量的副本。线程局部变量通常是类中希望
</span><span style="color: #008080;"> 17</span> <span style="color: #008000;"> * 将状态与线程关联的私有静态域（如用户ID和事务ID）。
</span><span style="color: #008080;"> 18</span> <span style="color: #008000;"> *
</span><span style="color: #008080;"> 19</span> <span style="color: #008000;"> * &lt;p&gt;For example, the class below generates unique identifiers local to each
</span><span style="color: #008080;"> 20</span> <span style="color: #008000;"> * thread.
</span><span style="color: #008080;"> 21</span> <span style="color: #008000;"> * 例如，下面的类生成每个线程本地的唯一标识符。
</span><span style="color: #008080;"> 22</span> <span style="color: #008000;"> * A thread's id is assigned the first time it invokes {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> ThreadId.get()}
</span><span style="color: #008080;"> 23</span> <span style="color: #008000;"> * and remains unchanged on subsequent calls.
</span><span style="color: #008080;"> 24</span> <span style="color: #008000;"> * 一个线程的Id在该线程首次调用get方法时生成，且在后续通话中保持不变。
</span><span style="color: #008080;"> 25</span> <span style="color: #008000;"> * &lt;pre&gt;
</span><span style="color: #008080;"> 26</span> <span style="color: #008000;"> * import java.util.concurrent.atomic.AtomicInteger;
</span><span style="color: #008080;"> 27</span> <span style="color: #008000;"> *
</span><span style="color: #008080;"> 28</span> <span style="color: #008000;"> * public class ThreadId {
</span><span style="color: #008080;"> 29</span> <span style="color: #008000;"> *     // Atomic integer containing the next thread ID to be assigned
</span><span style="color: #008080;"> 30</span> <span style="color: #008000;"> *     private static final AtomicInteger nextId = new AtomicInteger(0);
</span><span style="color: #008080;"> 31</span> <span style="color: #008000;"> *
</span><span style="color: #008080;"> 32</span> <span style="color: #008000;"> *     // Thread local variable containing each thread's ID
</span><span style="color: #008080;"> 33</span> <span style="color: #008000;"> *     private static final ThreadLocal&lt;Integer&gt; threadId =
</span><span style="color: #008080;"> 34</span> <span style="color: #008000;"> *         new ThreadLocal&lt;Integer&gt;() {
</span><span style="color: #008080;"> 35</span> <span style="color: #008000;"> *             @Override
</span><span style="color: #008080;"> 36</span> <span style="color: #008000;"> *             protected Integer initialValue() {
</span><span style="color: #008080;"> 37</span> <span style="color: #008000;"> *                 return nextId.getAndIncrement();
</span><span style="color: #008080;"> 38</span> <span style="color: #008000;"> *         }
</span><span style="color: #008080;"> 39</span> <span style="color: #008000;"> *     };
</span><span style="color: #008080;"> 40</span> <span style="color: #008000;"> *
</span><span style="color: #008080;"> 41</span> <span style="color: #008000;"> *     // Returns the current thread's unique ID, assigning it if necessary
</span><span style="color: #008080;"> 42</span> <span style="color: #008000;"> *     public static int get() {
</span><span style="color: #008080;"> 43</span> <span style="color: #008000;"> *         return threadId.get();
</span><span style="color: #008080;"> 44</span> <span style="color: #008000;"> *     }
</span><span style="color: #008080;"> 45</span> <span style="color: #008000;"> * }
</span><span style="color: #008080;"> 46</span> <span style="color: #008000;"> * &lt;/pre&gt;
</span><span style="color: #008080;"> 47</span> <span style="color: #008000;"> * &lt;p&gt;Each thread holds an implicit reference to its copy of a thread-local
</span><span style="color: #008080;"> 48</span> <span style="color: #008000;"> * variable as long as the thread is alive and the {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> ThreadLocal}
</span><span style="color: #008080;"> 49</span> <span style="color: #008000;"> * instance is accessible; after a thread goes away, all of its copies of
</span><span style="color: #008080;"> 50</span> <span style="color: #008000;"> * thread-local instances are subject to garbage collection (unless other
</span><span style="color: #008080;"> 51</span> <span style="color: #008000;"> * references to these copies exist).
</span><span style="color: #008080;"> 52</span> <span style="color: #008000;"> * 只要线程还活着，且ThreadLocal实例能够被访问，每个线程均保留其线程局部变量
</span><span style="color: #008080;"> 53</span> <span style="color: #008000;"> * 副本的隐式引用；线程死后它的所有线程局部变量副本被垃圾回收器回收（除非存在
</span><span style="color: #008080;"> 54</span> <span style="color: #008000;"> * 对这些线程局部变量副本的其他应用）
</span><span style="color: #008080;"> 55</span> <span style="color: #008000;"> *
</span><span style="color: #008080;"> 56</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> Josh Bloch and Doug Lea
</span><span style="color: #008080;"> 57</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@since</span><span style="color: #008000;"> 1.2
</span><span style="color: #008080;"> 58</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 59</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ThreadLocal&lt;T&gt;<span style="color: #000000;"> {
</span><span style="color: #008080;"> 60</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 61</span> <span style="color: #008000;">     * ThreadLocals rely on per-thread linear-probe hash maps attached
</span><span style="color: #008080;"> 62</span> <span style="color: #008000;">     * to each thread (Thread.threadLocals and inheritableThreadLocals).
</span><span style="color: #008080;"> 63</span> <span style="color: #008000;">     * ThreadLocal的实例依赖于每个线程的线性探针哈希图附加到每个线程。
</span><span style="color: #008080;"> 64</span> <span style="color: #008000;">     * The ThreadLocal objects act as keys,searched via threadLocalHashCode.
</span><span style="color: #008080;"> 65</span> <span style="color: #008000;">     * ThreadLocal对象充当键，通过threadLocalHashCode搜索。
</span><span style="color: #008080;"> 66</span> <span style="color: #008000;">     * This is a custom hash code
</span><span style="color: #008080;"> 67</span> <span style="color: #008000;">     * (useful only within ThreadLocalMaps) that eliminates collisions
</span><span style="color: #008080;"> 68</span> <span style="color: #008000;">     * in the common case where consecutively constructed ThreadLocals
</span><span style="color: #008080;"> 69</span> <span style="color: #008000;">     * are used by the same threads, while remaining well-behaved in
</span><span style="color: #008080;"> 70</span> <span style="color: #008000;">     * less common cases.
</span><span style="color: #008080;"> 71</span> <span style="color: #008000;">     * 这是一个自定义哈希码（仅在ThreadLocalMaps中有用），在相同的线程使用连续构造
</span><span style="color: #008080;"> 72</span> <span style="color: #008000;">     * 的ThreadLocals的常见情况下，它消除了冲突，而在不太常见的情况下，它们表现良好。
</span><span style="color: #008080;"> 73</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 74</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> threadLocalHashCode =<span style="color: #000000;"> nextHashCode();
</span><span style="color: #008080;"> 75</span> 
<span style="color: #008080;"> 76</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 77</span> <span style="color: #008000;">     * The next hash code to be given out. Updated atomically. Starts at
</span><span style="color: #008080;"> 78</span> <span style="color: #008000;">     * zero.
</span><span style="color: #008080;"> 79</span> <span style="color: #008000;">     * 下一次给出的哈希码，该值的自动更新不能被中断（原子性），值从0开始累加。
</span><span style="color: #008080;"> 80</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 81</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> AtomicInteger nextHashCode =
<span style="color: #008080;"> 82</span>             <span style="color: #0000ff;">new</span><span style="color: #000000;"> AtomicInteger();
</span><span style="color: #008080;"> 83</span> 
<span style="color: #008080;"> 84</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 85</span> <span style="color: #008000;">     * The difference between successively generated hash codes - turns
</span><span style="color: #008080;"> 86</span> <span style="color: #008000;">     * implicit sequential thread-local IDs into near-optimally spread
</span><span style="color: #008080;"> 87</span> <span style="color: #008000;">     * multiplicative hash values for power-of-two-sized tables.
</span><span style="color: #008080;"> 88</span> <span style="color: #008000;">     * 连续生成的哈希码间的差值，
</span><span style="color: #008080;"> 89</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 90</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> HASH_INCREMENT = 0x61c88647<span style="color: #000000;">;
</span><span style="color: #008080;"> 91</span> 
<span style="color: #008080;"> 92</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 93</span> <span style="color: #008000;">     * Returns the next hash code.
</span><span style="color: #008080;"> 94</span> <span style="color: #008000;">     * 返回下一个哈希码
</span><span style="color: #008080;"> 95</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 96</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> nextHashCode() {
</span><span style="color: #008080;"> 97</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> nextHashCode.getAndAdd(HASH_INCREMENT);
</span><span style="color: #008080;"> 98</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 99</span> 
<span style="color: #008080;">100</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">101</span> <span style="color: #008000;">     * Returns the current thread's "initial value" for this
</span><span style="color: #008080;">102</span> <span style="color: #008000;">     * thread-local variable.  This method will be invoked the first
</span><span style="color: #008080;">103</span> <span style="color: #008000;">     * time a thread accesses the variable with the {</span><span style="color: #808080;">@link</span><span style="color: #008000;"> #get}
</span><span style="color: #008080;">104</span> <span style="color: #008000;">     * method, unless the thread previously invoked the {</span><span style="color: #808080;">@link</span><span style="color: #008000;"> #set}
</span><span style="color: #008080;">105</span> <span style="color: #008000;">     * method, in which case the {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> initialValue} method will not
</span><span style="color: #008080;">106</span> <span style="color: #008000;">     * be invoked for the thread.  Normally, this method is invoked at
</span><span style="color: #008080;">107</span> <span style="color: #008000;">     * most once per thread, but it may be invoked again in case of
</span><span style="color: #008080;">108</span> <span style="color: #008000;">     * subsequent invocations of {</span><span style="color: #808080;">@link</span><span style="color: #008000;"> #remove} followed by {</span><span style="color: #808080;">@link</span><span style="color: #008000;"> #get}.
</span><span style="color: #008080;">109</span> <span style="color: #008000;">     * 翻译：
</span><span style="color: #008080;">110</span> <span style="color: #008000;">     * 返回当前线程持有的线程局部变量副本的初始值。线程在第一次通过get方法访问局部
</span><span style="color: #008080;">111</span> <span style="color: #008000;">     * 变量前如果没有调用过set方法为局部变量设置值，本函数就会被调用。通常每个线程
</span><span style="color: #008080;">112</span> <span style="color: #008000;">     * 最多会调用一次本方法，但是如果在之后依次调用了remove和get方法，它可能会再次被调用。
</span><span style="color: #008080;">113</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">114</span> <span style="color: #008000;">     * &lt;p&gt;This implementation simply returns {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> null}; if the
</span><span style="color: #008080;">115</span> <span style="color: #008000;">     * programmer desires thread-local variables to have an initial
</span><span style="color: #008080;">116</span> <span style="color: #008000;">     * value other than {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> null}, {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> ThreadLocal} must be
</span><span style="color: #008080;">117</span> <span style="color: #008000;">     * subclassed, and this method overridden.  Typically, an
</span><span style="color: #008080;">118</span> <span style="color: #008000;">     * anonymous inner class will be used.
</span><span style="color: #008080;">119</span> <span style="color: #008000;">     * 本实现仅返回null，如果开发者希望线程的局部变量具体其他初始值，只能通过声明子类并
</span><span style="color: #008080;">120</span> <span style="color: #008000;">     * 重写本方法。通常，将使用匿名内部类。（下面就有一个内部类）
</span><span style="color: #008080;">121</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">122</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> the initial value for this thread-local
</span><span style="color: #008080;">123</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">124</span>     <span style="color: #0000ff;">protected</span><span style="color: #000000;"> T initialValue() {
</span><span style="color: #008080;">125</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">126</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">127</span> 
<span style="color: #008080;">128</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">129</span> <span style="color: #008000;">     * Creates a thread local variable. The initial value of the variable is
</span><span style="color: #008080;">130</span> <span style="color: #008000;">     * determined by invoking the {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> get} method on the {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> Supplier}.
</span><span style="color: #008080;">131</span> <span style="color: #008000;">     * 创建一个线程局部变量的副本，变量的初始值是通过调用Supplier上的get方法确定的。
</span><span style="color: #008080;">132</span> <span style="color: #008000;">     * （Supplier是一个函数式接口）
</span><span style="color: #008080;">133</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">134</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> &lt;S&gt;      the type of the thread local's value
</span><span style="color: #008080;">135</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> supplier the supplier to be used to determine the initial value
</span><span style="color: #008080;">136</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> a new thread local variable
</span><span style="color: #008080;">137</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@throws</span><span style="color: #008000;"> NullPointerException if the specified supplier is null
</span><span style="color: #008080;">138</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@since</span><span style="color: #008000;"> 1.8
</span><span style="color: #008080;">139</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">140</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> &lt;S&gt; ThreadLocal&lt;S&gt; withInitial(Supplier&lt;? <span style="color: #0000ff;">extends</span> S&gt;<span style="color: #000000;"> supplier) {
</span><span style="color: #008080;">141</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> SuppliedThreadLocal&lt;&gt;<span style="color: #000000;">(supplier);
</span><span style="color: #008080;">142</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">143</span> 
<span style="color: #008080;">144</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">145</span> <span style="color: #008000;">     * 构造函数
</span><span style="color: #008080;">146</span> <span style="color: #008000;">     * Creates a thread local variable.
</span><span style="color: #008080;">147</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">148</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@see</span><span style="color: #008000;"> #withInitial(java.util.function.Supplier)
</span><span style="color: #008080;">149</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">150</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> ThreadLocal() {
</span><span style="color: #008080;">151</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">152</span> 
<span style="color: #008080;">153</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">154</span> <span style="color: #008000;">     * Returns the value in the current thread's copy of this
</span><span style="color: #008080;">155</span> <span style="color: #008000;">     * thread-local variable.  If the variable has no value for the
</span><span style="color: #008080;">156</span> <span style="color: #008000;">     * current thread, it is first initialized to the value returned
</span><span style="color: #008080;">157</span> <span style="color: #008000;">     * by an invocation of the {</span><span style="color: #808080;">@link</span><span style="color: #008000;"> #initialValue} method.
</span><span style="color: #008080;">158</span> <span style="color: #008000;">     * 译：
</span><span style="color: #008080;">159</span> <span style="color: #008000;">     * 返回当前线程持有的线程局部变量副本的值。如果该变量还没赋值，
</span><span style="color: #008080;">160</span> <span style="color: #008000;">     * 则先使用initialValue方法为其赋予初始值。
</span><span style="color: #008080;">161</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">162</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> the current thread's value of this thread-local
</span><span style="color: #008080;">163</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">164</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> T get() {
</span><span style="color: #008080;">165</span>         <span style="color: #008000;">//</span><span style="color: #008000;">1、确定当前线程</span>
<span style="color: #008080;">166</span>         Thread t =<span style="color: #000000;"> Thread.currentThread();
</span><span style="color: #008080;">167</span>         <span style="color: #008000;">//</span><span style="color: #008000;">2、</span>
<span style="color: #008080;">168</span>         ThreadLocalMap map =<span style="color: #000000;"> getMap(t);
</span><span style="color: #008080;">169</span>         <span style="color: #0000ff;">if</span> (map != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">170</span>             ThreadLocalMap.Entry e = map.getEntry(<span style="color: #0000ff;">this</span><span style="color: #000000;">);
</span><span style="color: #008080;">171</span>             <span style="color: #0000ff;">if</span> (e != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">172</span>                 @SuppressWarnings("unchecked"<span style="color: #000000;">)
</span><span style="color: #008080;">173</span>                 T result =<span style="color: #000000;"> (T) e.value;
</span><span style="color: #008080;">174</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;"> result;
</span><span style="color: #008080;">175</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">176</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">177</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> setInitialValue();
</span><span style="color: #008080;">178</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">179</span> 
<span style="color: #008080;">180</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">181</span> <span style="color: #008000;">     * Variant of set() to establish initialValue. Used instead
</span><span style="color: #008080;">182</span> <span style="color: #008000;">     * of set() in case user has overridden the set() method.
</span><span style="color: #008080;">183</span> <span style="color: #008000;">     * 译：
</span><span style="color: #008080;">184</span> <span style="color: #008000;">     * set方法的变体，用于设置初始值。如果用户已覆盖set（）方法，
</span><span style="color: #008080;">185</span> <span style="color: #008000;">     * 请使用它代替set（）。
</span><span style="color: #008080;">186</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">187</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> the initial value
</span><span style="color: #008080;">188</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">189</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> T setInitialValue() {
</span><span style="color: #008080;">190</span>         T value =<span style="color: #000000;"> initialValue();
</span><span style="color: #008080;">191</span>         Thread t =<span style="color: #000000;"> Thread.currentThread();
</span><span style="color: #008080;">192</span>         ThreadLocalMap map =<span style="color: #000000;"> getMap(t);
</span><span style="color: #008080;">193</span>         <span style="color: #0000ff;">if</span> (map != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">194</span>             map.set(<span style="color: #0000ff;">this</span><span style="color: #000000;">, value);
</span><span style="color: #008080;">195</span>         <span style="color: #0000ff;">else</span>
<span style="color: #008080;">196</span> <span style="color: #000000;">            createMap(t, value);
</span><span style="color: #008080;">197</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> value;
</span><span style="color: #008080;">198</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">199</span> 
<span style="color: #008080;">200</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">201</span> <span style="color: #008000;">     * Sets the current thread's copy of this thread-local variable
</span><span style="color: #008080;">202</span> <span style="color: #008000;">     * to the specified value.  Most subclasses will have no need to
</span><span style="color: #008080;">203</span> <span style="color: #008000;">     * override this method, relying solely on the {</span><span style="color: #808080;">@link</span><span style="color: #008000;"> #initialValue}
</span><span style="color: #008080;">204</span> <span style="color: #008000;">     * method to set the values of thread-locals.
</span><span style="color: #008080;">205</span> <span style="color: #008000;">     * 译：
</span><span style="color: #008080;">206</span> <span style="color: #008000;">     * 设置当前线程持有的线程局部变量副本的值为指定值。大部分子类不需要重写本
</span><span style="color: #008080;">207</span> <span style="color: #008000;">     * 方法，仅依靠initialValue方法来设置值。
</span><span style="color: #008080;">208</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">209</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> value the value to be stored in the current thread's copy of
</span><span style="color: #008080;">210</span> <span style="color: #008000;">     *              this thread-local.
</span><span style="color: #008080;">211</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">212</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> set(T value) {
</span><span style="color: #008080;">213</span>         Thread t =<span style="color: #000000;"> Thread.currentThread();
</span><span style="color: #008080;">214</span>         ThreadLocalMap map =<span style="color: #000000;"> getMap(t);
</span><span style="color: #008080;">215</span>         <span style="color: #0000ff;">if</span> (map != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">216</span>             map.set(<span style="color: #0000ff;">this</span><span style="color: #000000;">, value);
</span><span style="color: #008080;">217</span>         <span style="color: #0000ff;">else</span>
<span style="color: #008080;">218</span> <span style="color: #000000;">            createMap(t, value);
</span><span style="color: #008080;">219</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">220</span> 
<span style="color: #008080;">221</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">222</span> <span style="color: #008000;">     * Removes the current thread's value for this thread-local
</span><span style="color: #008080;">223</span> <span style="color: #008000;">     * variable.  If this thread-local variable is subsequently
</span><span style="color: #008080;">224</span> <span style="color: #008000;">     * {</span><span style="color: #808080;">@linkplain</span><span style="color: #008000;"> #get read} by the current thread, its value will be
</span><span style="color: #008080;">225</span> <span style="color: #008000;">     * reinitialized by invoking its {</span><span style="color: #808080;">@link</span><span style="color: #008000;"> #initialValue} method,
</span><span style="color: #008080;">226</span> <span style="color: #008000;">     * unless its value is {</span><span style="color: #808080;">@linkplain</span><span style="color: #008000;"> #set set} by the current thread
</span><span style="color: #008080;">227</span> <span style="color: #008000;">     * in the interim.  This may result in multiple invocations of the
</span><span style="color: #008080;">228</span> <span style="color: #008000;">     * {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> initialValue} method in the current thread.
</span><span style="color: #008080;">229</span> <span style="color: #008000;">     * 译：
</span><span style="color: #008080;">230</span> <span style="color: #008000;">     * 移除单前线程持有的线程本地变量的值。如果随后马上又通过get方法试图获取
</span><span style="color: #008080;">231</span> <span style="color: #008000;">     * 这个线程本地变量的值，这个变量的值会再次通过调用initialValue方法确定，
</span><span style="color: #008080;">232</span> <span style="color: #008000;">     * 除非在调用get方法前通过set方法设置了值就不会。这可能会导致initialValue
</span><span style="color: #008080;">233</span> <span style="color: #008000;">     * 方法被当前线程多次调用。
</span><span style="color: #008080;">234</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">235</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@since</span><span style="color: #008000;"> 1.5
</span><span style="color: #008080;">236</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">237</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> remove() {
</span><span style="color: #008080;">238</span>         ThreadLocalMap m =<span style="color: #000000;"> getMap(Thread.currentThread());
</span><span style="color: #008080;">239</span>         <span style="color: #0000ff;">if</span> (m != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">240</span>             m.remove(<span style="color: #0000ff;">this</span><span style="color: #000000;">);
</span><span style="color: #008080;">241</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">242</span> 
<span style="color: #008080;">243</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">244</span> <span style="color: #008000;">     * Get the map associated with a ThreadLocal. Overridden in
</span><span style="color: #008080;">245</span> <span style="color: #008000;">     * InheritableThreadLocal.
</span><span style="color: #008080;">246</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">247</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> t the current thread
</span><span style="color: #008080;">248</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> the map
</span><span style="color: #008080;">249</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">250</span> <span style="color: #000000;">    ThreadLocalMap getMap(Thread t) {
</span><span style="color: #008080;">251</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> t.threadLocals;
</span><span style="color: #008080;">252</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">253</span> 
<span style="color: #008080;">254</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">255</span> <span style="color: #008000;">     * Create the map associated with a ThreadLocal. Overridden in
</span><span style="color: #008080;">256</span> <span style="color: #008000;">     * InheritableThreadLocal.
</span><span style="color: #008080;">257</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">258</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> t          the current thread
</span><span style="color: #008080;">259</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> firstValue value for the initial entry of the map
</span><span style="color: #008080;">260</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">261</span>     <span style="color: #0000ff;">void</span><span style="color: #000000;"> createMap(Thread t, T firstValue) {
</span><span style="color: #008080;">262</span>         t.threadLocals = <span style="color: #0000ff;">new</span> ThreadLocalMap(<span style="color: #0000ff;">this</span><span style="color: #000000;">, firstValue);
</span><span style="color: #008080;">263</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">264</span> 
<span style="color: #008080;">265</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">266</span> <span style="color: #008000;">     * Factory method to create map of inherited thread locals.
</span><span style="color: #008080;">267</span> <span style="color: #008000;">     * Designed to be called only from Thread constructor.
</span><span style="color: #008080;">268</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">269</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> parentMap the map associated with parent thread
</span><span style="color: #008080;">270</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> a map containing the parent's inheritable bindings
</span><span style="color: #008080;">271</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">272</span>     <span style="color: #0000ff;">static</span><span style="color: #000000;"> ThreadLocalMap createInheritedMap(ThreadLocalMap parentMap) {
</span><span style="color: #008080;">273</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> ThreadLocalMap(parentMap);
</span><span style="color: #008080;">274</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">275</span> 
<span style="color: #008080;">276</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">277</span> <span style="color: #008000;">     * Method childValue is visibly defined in subclass
</span><span style="color: #008080;">278</span> <span style="color: #008000;">     * InheritableThreadLocal, but is internally defined here for the
</span><span style="color: #008080;">279</span> <span style="color: #008000;">     * sake of providing createInheritedMap factory method without
</span><span style="color: #008080;">280</span> <span style="color: #008000;">     * needing to subclass the map class in InheritableThreadLocal.
</span><span style="color: #008080;">281</span> <span style="color: #008000;">     * This technique is preferable to the alternative of embedding
</span><span style="color: #008080;">282</span> <span style="color: #008000;">     * instanceof tests in methods.
</span><span style="color: #008080;">283</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">284</span> <span style="color: #000000;">    T childValue(T parentValue) {
</span><span style="color: #008080;">285</span>         <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> UnsupportedOperationException();
</span><span style="color: #008080;">286</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">287</span> 
<span style="color: #008080;">288</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">289</span> <span style="color: #008000;">     * An extension of ThreadLocal that obtains its initial value from
</span><span style="color: #008080;">290</span> <span style="color: #008000;">     * the specified {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> Supplier}.
</span><span style="color: #008080;">291</span> <span style="color: #008000;">     * SuppliedThreadLocal类拓展了ThreadLocal类，该类重写了initialValue函数，
</span><span style="color: #008080;">292</span> <span style="color: #008000;">     * 用于从指定的Supplier获取初始值。
</span><span style="color: #008080;">293</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">294</span>     <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">class</span> SuppliedThreadLocal&lt;T&gt; <span style="color: #0000ff;">extends</span> ThreadLocal&lt;T&gt;<span style="color: #000000;"> {
</span><span style="color: #008080;">295</span> 
<span style="color: #008080;">296</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">297</span> <span style="color: #008000;">         * Supplier&lt;T&gt;是一个函数式接口
</span><span style="color: #008080;">298</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">299</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> Supplier&lt;? <span style="color: #0000ff;">extends</span> T&gt;<span style="color: #000000;"> supplier;
</span><span style="color: #008080;">300</span> 
<span style="color: #008080;">301</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">302</span> <span style="color: #008000;">         * 构造函数
</span><span style="color: #008080;">303</span> <span style="color: #008000;">         *
</span><span style="color: #008080;">304</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> supplier - 一个函数式接口，用来返回线程本地变量的初始值
</span><span style="color: #008080;">305</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">306</span>         SuppliedThreadLocal(Supplier&lt;? <span style="color: #0000ff;">extends</span> T&gt;<span style="color: #000000;"> supplier) {
</span><span style="color: #008080;">307</span>             <span style="color: #008000;">/**</span>
<span style="color: #008080;">308</span> <span style="color: #008000;">             *     public static &lt;T&gt; T requireNonNull(T obj) {
</span><span style="color: #008080;">309</span> <span style="color: #008000;">             *         if (obj == null)
</span><span style="color: #008080;">310</span> <span style="color: #008000;">             *             throw new NullPointerException();
</span><span style="color: #008080;">311</span> <span style="color: #008000;">             *         return obj;
</span><span style="color: #008080;">312</span> <span style="color: #008000;">             *     }
</span><span style="color: #008080;">313</span>              <span style="color: #008000;">*/</span>
<span style="color: #008080;">314</span>             <span style="color: #0000ff;">this</span>.supplier =<span style="color: #000000;"> Objects.requireNonNull(supplier);
</span><span style="color: #008080;">315</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">316</span> 
<span style="color: #008080;">317</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">318</span> <span style="color: #008000;">         * 这里很关键，需要去看看Supplier接口的源码。
</span><span style="color: #008080;">319</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">320</span> <span style="color: #000000;">        @Override
</span><span style="color: #008080;">321</span>         <span style="color: #0000ff;">protected</span><span style="color: #000000;"> T initialValue() {
</span><span style="color: #008080;">322</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> supplier.get();
</span><span style="color: #008080;">323</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">324</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">325</span> 
<span style="color: #008080;">326</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">327</span> <span style="color: #008000;">     * ThreadLocalMap is a customized hash map suitable only for
</span><span style="color: #008080;">328</span> <span style="color: #008000;">     * maintaining thread local values. No operations are exported
</span><span style="color: #008080;">329</span> <span style="color: #008000;">     * outside of the ThreadLocal class. The class is package private to
</span><span style="color: #008080;">330</span> <span style="color: #008000;">     * allow declaration of fields in class Thread.  To help deal with
</span><span style="color: #008080;">331</span> <span style="color: #008000;">     * very large and long-lived usages, the hash table entries use
</span><span style="color: #008080;">332</span> <span style="color: #008000;">     * WeakReferences for keys. However, since reference queues are not
</span><span style="color: #008080;">333</span> <span style="color: #008000;">     * used, stale entries are guaranteed to be removed only when
</span><span style="color: #008080;">334</span> <span style="color: #008000;">     * the table starts running out of space.
</span><span style="color: #008080;">335</span> <span style="color: #008000;">     * 译：
</span><span style="color: #008080;">336</span> <span style="color: #008000;">     * ThreadLocalMap是自定义的HashMap，仅适用于维护线程局部变量的值。
</span><span style="color: #008080;">337</span> <span style="color: #008000;">     * 没有操作导出到ThreadLocal类之外。这个类是包私有的，用于Thread类
</span><span style="color: #008080;">338</span> <span style="color: #008000;">     * 域声明。为了处理存储空间消耗大，使用时间长的使用情况，这个HashTable
</span><span style="color: #008080;">339</span> <span style="color: #008000;">     * 使用WeakReferences（弱引用）作为键。但是，由于未使用参考队列，因此
</span><span style="color: #008080;">340</span> <span style="color: #008000;">     * 仅在表开始空间不足时，才保证删除过时的条目。
</span><span style="color: #008080;">341</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">342</span>     <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ThreadLocalMap {
</span><span style="color: #008080;">343</span> 
<span style="color: #008080;">344</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">345</span> <span style="color: #008000;">         * The entries in this hash map extend WeakReference, using
</span><span style="color: #008080;">346</span> <span style="color: #008000;">         * its main ref field as the key (which is always a
</span><span style="color: #008080;">347</span> <span style="color: #008000;">         * ThreadLocal object).  Note that null keys (i.e. entry.get()
</span><span style="color: #008080;">348</span> <span style="color: #008000;">         * == null) mean that the key is no longer referenced, so the
</span><span style="color: #008080;">349</span> <span style="color: #008000;">         * entry can be expunged from table.  Such entries are referred to
</span><span style="color: #008080;">350</span> <span style="color: #008000;">         * as "stale entries" in the code that follows.
</span><span style="color: #008080;">351</span> <span style="color: #008000;">         * 译：
</span><span style="color: #008080;">352</span> <span style="color: #008000;">         * 该哈希表中的条目是WeakReference子类的对象，以其主域作为键（大多数情
</span><span style="color: #008080;">353</span> <span style="color: #008000;">         * 况下是一个ThreadLocal对象）。需要注意，当以null作为键时，意味着这个
</span><span style="color: #008080;">354</span> <span style="color: #008000;">         * 键已经不再被引用，因此这个键所在的条目能被表移除。这样的条目我们在下文
</span><span style="color: #008080;">355</span> <span style="color: #008000;">         * 中称为&ldquo;过时的条目&rdquo;
</span><span style="color: #008080;">356</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">357</span>         <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span> Entry <span style="color: #0000ff;">extends</span> WeakReference&lt;ThreadLocal&lt;?&gt;&gt;<span style="color: #000000;"> {
</span><span style="color: #008080;">358</span>             <span style="color: #008000;">/**</span>
<span style="color: #008080;">359</span> <span style="color: #008000;">             * The value associated with this ThreadLocal.
</span><span style="color: #008080;">360</span> <span style="color: #008000;">             * 与ThreadLocal相关联的值
</span><span style="color: #008080;">361</span>              <span style="color: #008000;">*/</span>
<span style="color: #008080;">362</span> <span style="color: #000000;">            Object value;
</span><span style="color: #008080;">363</span> 
<span style="color: #008080;">364</span>             <span style="color: #008000;">/**</span>
<span style="color: #008080;">365</span> <span style="color: #008000;">             * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> k - 以线程作为键
</span><span style="color: #008080;">366</span> <span style="color: #008000;">             * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> v - 线程持有的threal-local变量副本的值
</span><span style="color: #008080;">367</span>              <span style="color: #008000;">*/</span>
<span style="color: #008080;">368</span>             Entry(ThreadLocal&lt;?&gt;<span style="color: #000000;"> k, Object v) {
</span><span style="color: #008080;">369</span>                 <span style="color: #0000ff;">super</span><span style="color: #000000;">(k);
</span><span style="color: #008080;">370</span>                 value =<span style="color: #000000;"> v;
</span><span style="color: #008080;">371</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">372</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">373</span> 
<span style="color: #008080;">374</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">375</span> <span style="color: #008000;">         * The initial capacity -- MUST be a power of two.
</span><span style="color: #008080;">376</span> <span style="color: #008000;">         * 初始容量&mdash;&mdash;必须是2的幂
</span><span style="color: #008080;">377</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">378</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> INITIAL_CAPACITY = 16<span style="color: #000000;">;
</span><span style="color: #008080;">379</span> 
<span style="color: #008080;">380</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">381</span> <span style="color: #008000;">         * The table, resized as necessary.
</span><span style="color: #008080;">382</span> <span style="color: #008000;">         * table.length MUST always be a power of two.
</span><span style="color: #008080;">383</span> <span style="color: #008000;">         * 译：
</span><span style="color: #008080;">384</span> <span style="color: #008000;">         * 表在必要的时候会扩容，表的大小必须是2的幂
</span><span style="color: #008080;">385</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">386</span>         <span style="color: #0000ff;">private</span><span style="color: #000000;"> Entry[] table;
</span><span style="color: #008080;">387</span> 
<span style="color: #008080;">388</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">389</span> <span style="color: #008000;">         * The number of entries in the table.
</span><span style="color: #008080;">390</span> <span style="color: #008000;">         * 表中条目（键值对）的数量
</span><span style="color: #008080;">391</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">392</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> size = 0<span style="color: #000000;">;
</span><span style="color: #008080;">393</span> 
<span style="color: #008080;">394</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">395</span> <span style="color: #008000;">         * the next size value at which to resize.
</span><span style="color: #008080;">396</span> <span style="color: #008000;">         * 下一次调整表的大小时要增加的值
</span><span style="color: #008080;">397</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">398</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> threshold; <span style="color: #008000;">//</span><span style="color: #008000;"> Default to 0</span>
<span style="color: #008080;">399</span> 
<span style="color: #008080;">400</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">401</span> <span style="color: #008000;">         * Set the resize threshold to maintain at worst a 2/3 load factor.
</span><span style="color: #008080;">402</span> <span style="color: #008000;">         * 从这里可以看出，每次扩容，容量增加2/3。
</span><span style="color: #008080;">403</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">404</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> setThreshold(<span style="color: #0000ff;">int</span><span style="color: #000000;"> len) {
</span><span style="color: #008080;">405</span>             threshold = len * 2 / 3<span style="color: #000000;">;
</span><span style="color: #008080;">406</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">407</span> 
<span style="color: #008080;">408</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">409</span> <span style="color: #008000;">         * Increment i modulo len.
</span><span style="color: #008080;">410</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">411</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> nextIndex(<span style="color: #0000ff;">int</span> i, <span style="color: #0000ff;">int</span><span style="color: #000000;"> len) {
</span><span style="color: #008080;">412</span>             <span style="color: #0000ff;">return</span> ((i + 1 &lt; len) ? i + 1 : 0<span style="color: #000000;">);
</span><span style="color: #008080;">413</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">414</span> 
<span style="color: #008080;">415</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">416</span> <span style="color: #008000;">         * Decrement i modulo len.
</span><span style="color: #008080;">417</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">418</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> prevIndex(<span style="color: #0000ff;">int</span> i, <span style="color: #0000ff;">int</span><span style="color: #000000;"> len) {
</span><span style="color: #008080;">419</span>             <span style="color: #0000ff;">return</span> ((i - 1 &gt;= 0) ? i - 1 : len - 1<span style="color: #000000;">);
</span><span style="color: #008080;">420</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">421</span> 
<span style="color: #008080;">422</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">423</span> <span style="color: #008000;">         * Construct a new map initially containing (firstKey, firstValue).
</span><span style="color: #008080;">424</span> <span style="color: #008000;">         * ThreadLocalMaps are constructed lazily, so we only create
</span><span style="color: #008080;">425</span> <span style="color: #008000;">         * one when we have at least one entry to put in it.
</span><span style="color: #008080;">426</span> <span style="color: #008000;">         * 译：
</span><span style="color: #008080;">427</span> <span style="color: #008000;">         * 构造一个最初包含以下内容的新Map。ThreadLocalMaps是延迟创建的，所以
</span><span style="color: #008080;">428</span> <span style="color: #008000;">         * 只有当至少要添加一条条目时才创建一个。
</span><span style="color: #008080;">429</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">430</span>         ThreadLocalMap(ThreadLocal&lt;?&gt;<span style="color: #000000;"> firstKey, Object firstValue) {
</span><span style="color: #008080;">431</span>             table = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Entry[INITIAL_CAPACITY];
</span><span style="color: #008080;">432</span>             <span style="color: #0000ff;">int</span> i = firstKey.threadLocalHashCode &amp; (INITIAL_CAPACITY - 1<span style="color: #000000;">);
</span><span style="color: #008080;">433</span>             table[i] = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Entry(firstKey, firstValue);
</span><span style="color: #008080;">434</span>             size = 1<span style="color: #000000;">;
</span><span style="color: #008080;">435</span> <span style="color: #000000;">            setThreshold(INITIAL_CAPACITY);
</span><span style="color: #008080;">436</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">437</span> 
<span style="color: #008080;">438</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">439</span> <span style="color: #008000;">         * Construct a new map including all Inheritable ThreadLocals
</span><span style="color: #008080;">440</span> <span style="color: #008000;">         * from given parent map. Called only by createInheritedMap.
</span><span style="color: #008080;">441</span> <span style="color: #008000;">         *
</span><span style="color: #008080;">442</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> parentMap the map associated with parent thread.
</span><span style="color: #008080;">443</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">444</span>         <span style="color: #0000ff;">private</span><span style="color: #000000;"> ThreadLocalMap(ThreadLocalMap parentMap) {
</span><span style="color: #008080;">445</span>             Entry[] parentTable =<span style="color: #000000;"> parentMap.table;
</span><span style="color: #008080;">446</span>             <span style="color: #0000ff;">int</span> len =<span style="color: #000000;"> parentTable.length;
</span><span style="color: #008080;">447</span> <span style="color: #000000;">            setThreshold(len);
</span><span style="color: #008080;">448</span>             table = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Entry[len];
</span><span style="color: #008080;">449</span> 
<span style="color: #008080;">450</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> j = 0; j &lt; len; j++<span style="color: #000000;">) {
</span><span style="color: #008080;">451</span>                 Entry e =<span style="color: #000000;"> parentTable[j];
</span><span style="color: #008080;">452</span>                 <span style="color: #0000ff;">if</span> (e != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">453</span>                     @SuppressWarnings("unchecked"<span style="color: #000000;">)
</span><span style="color: #008080;">454</span>                     ThreadLocal&lt;Object&gt; key = (ThreadLocal&lt;Object&gt;<span style="color: #000000;">) e.get();
</span><span style="color: #008080;">455</span>                     <span style="color: #0000ff;">if</span> (key != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">456</span>                         Object value =<span style="color: #000000;"> key.childValue(e.value);
</span><span style="color: #008080;">457</span>                         Entry c = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Entry(key, value);
</span><span style="color: #008080;">458</span>                         <span style="color: #0000ff;">int</span> h = key.threadLocalHashCode &amp; (len - 1<span style="color: #000000;">);
</span><span style="color: #008080;">459</span>                         <span style="color: #0000ff;">while</span> (table[h] != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">460</span>                             h =<span style="color: #000000;"> nextIndex(h, len);
</span><span style="color: #008080;">461</span>                         table[h] =<span style="color: #000000;"> c;
</span><span style="color: #008080;">462</span>                         size++<span style="color: #000000;">;
</span><span style="color: #008080;">463</span> <span style="color: #000000;">                    }
</span><span style="color: #008080;">464</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">465</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">466</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">467</span> 
<span style="color: #008080;">468</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">469</span> <span style="color: #008000;">         * Get the entry associated with key.  This method
</span><span style="color: #008080;">470</span> <span style="color: #008000;">         * itself handles only the fast path: a direct hit of existing
</span><span style="color: #008080;">471</span> <span style="color: #008000;">         * key. It otherwise relays to getEntryAfterMiss.  This is
</span><span style="color: #008080;">472</span> <span style="color: #008000;">         * designed to maximize performance for direct hits, in part
</span><span style="color: #008080;">473</span> <span style="color: #008000;">         * by making this method readily inlinable.
</span><span style="color: #008080;">474</span> <span style="color: #008000;">         * 译：
</span><span style="color: #008080;">475</span> <span style="color: #008000;">         * 获取键关联的条目。
</span><span style="color: #008080;">476</span> <span style="color: #008000;">         * 理解：
</span><span style="color: #008080;">477</span> <span style="color: #008000;">         * 散列表中通过哈希函数和键计算哈希码，使用哈希码来决定数据存储的位置，
</span><span style="color: #008080;">478</span> <span style="color: #008000;">         * 不同的键通过哈希函数可能计算出相同的哈希码，这被称为&ldquo;冲突&rdquo;。遇到冲突
</span><span style="color: #008080;">479</span> <span style="color: #008000;">         * 时需要使用某种&ldquo;冲突解决策略&rdquo;重新确定一个哈希码，本函数假设没有冲突，
</span><span style="color: #008080;">480</span> <span style="color: #008000;">         * 尝试通过计算出来的哈希码直接取值。事实上好的哈希算法计算出来的哈希码
</span><span style="color: #008080;">481</span> <span style="color: #008000;">         * 分布的比较均匀，即很少发生冲突。
</span><span style="color: #008080;">482</span> <span style="color: #008000;">         *
</span><span style="color: #008080;">483</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> key the thread local object
</span><span style="color: #008080;">484</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> the entry associated with key, or null if no such
</span><span style="color: #008080;">485</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">486</span>         <span style="color: #0000ff;">private</span> Entry getEntry(ThreadLocal&lt;?&gt;<span style="color: #000000;"> key) {
</span><span style="color: #008080;">487</span>             <span style="color: #008000;">//</span><span style="color: #008000;">1、尝试直接取值</span>
<span style="color: #008080;">488</span>             <span style="color: #0000ff;">int</span> i = key.threadLocalHashCode &amp; (table.length - 1<span style="color: #000000;">);
</span><span style="color: #008080;">489</span>             Entry e =<span style="color: #000000;"> table[i];
</span><span style="color: #008080;">490</span>             <span style="color: #0000ff;">if</span> (e != <span style="color: #0000ff;">null</span> &amp;&amp; e.get() ==<span style="color: #000000;"> key)
</span><span style="color: #008080;">491</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;"> e;
</span><span style="color: #008080;">492</span>             <span style="color: #0000ff;">else</span>
<span style="color: #008080;">493</span>                 <span style="color: #0000ff;">return</span> getEntryAfterMiss(key, i, e);<span style="color: #008000;">//</span><span style="color: #008000;">2、冲突解决方案</span>
<span style="color: #008080;">494</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">495</span> 
<span style="color: #008080;">496</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">497</span> <span style="color: #008000;">         * Version of getEntry method for use when key is not found in
</span><span style="color: #008080;">498</span> <span style="color: #008000;">         * its direct hash slot.
</span><span style="color: #008080;">499</span> <span style="color: #008000;">         *
</span><span style="color: #008080;">500</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> key the thread local object
</span><span style="color: #008080;">501</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> i   the table index for key's hash code
</span><span style="color: #008080;">502</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> e   the entry at table[i]
</span><span style="color: #008080;">503</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> the entry associated with key, or null if no such
</span><span style="color: #008080;">504</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">505</span>         <span style="color: #0000ff;">private</span> Entry getEntryAfterMiss(ThreadLocal&lt;?&gt; key, <span style="color: #0000ff;">int</span><span style="color: #000000;"> i, Entry e) {
</span><span style="color: #008080;">506</span>             Entry[] tab =<span style="color: #000000;"> table;
</span><span style="color: #008080;">507</span>             <span style="color: #0000ff;">int</span> len =<span style="color: #000000;"> tab.length;
</span><span style="color: #008080;">508</span> 
<span style="color: #008080;">509</span>             <span style="color: #0000ff;">while</span> (e != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">510</span>                 ThreadLocal&lt;?&gt; k =<span style="color: #000000;"> e.get();
</span><span style="color: #008080;">511</span>                 <span style="color: #0000ff;">if</span> (k ==<span style="color: #000000;"> key)
</span><span style="color: #008080;">512</span>                     <span style="color: #0000ff;">return</span><span style="color: #000000;"> e;
</span><span style="color: #008080;">513</span>                 <span style="color: #0000ff;">if</span> (k == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">514</span> <span style="color: #000000;">                    expungeStaleEntry(i);
</span><span style="color: #008080;">515</span>                 <span style="color: #0000ff;">else</span>
<span style="color: #008080;">516</span>                     i =<span style="color: #000000;"> nextIndex(i, len);
</span><span style="color: #008080;">517</span>                 e =<span style="color: #000000;"> tab[i];
</span><span style="color: #008080;">518</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">519</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">520</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">521</span> 
<span style="color: #008080;">522</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">523</span> <span style="color: #008000;">         * Set the value associated with key.
</span><span style="color: #008080;">524</span> <span style="color: #008000;">         * 设置与键关联的值
</span><span style="color: #008080;">525</span> <span style="color: #008000;">         *
</span><span style="color: #008080;">526</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> key   the thread local object
</span><span style="color: #008080;">527</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> value the value to be set
</span><span style="color: #008080;">528</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">529</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> set(ThreadLocal&lt;?&gt;<span style="color: #000000;"> key, Object value) {
</span><span style="color: #008080;">530</span> 
<span style="color: #008080;">531</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> We don't use a fast path as with get() because it is at
</span><span style="color: #008080;">532</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> least as common to use set() to create new entries as
</span><span style="color: #008080;">533</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> it is to replace existing ones, in which case, a fast
</span><span style="color: #008080;">534</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> path would fail more often than not.</span>
<span style="color: #008080;">535</span> 
<span style="color: #008080;">536</span>             Entry[] tab =<span style="color: #000000;"> table;
</span><span style="color: #008080;">537</span>             <span style="color: #0000ff;">int</span> len =<span style="color: #000000;"> tab.length;
</span><span style="color: #008080;">538</span>             <span style="color: #0000ff;">int</span> i = key.threadLocalHashCode &amp; (len - 1<span style="color: #000000;">);
</span><span style="color: #008080;">539</span> 
<span style="color: #008080;">540</span>             <span style="color: #0000ff;">for</span> (Entry e =<span style="color: #000000;"> tab[i];
</span><span style="color: #008080;">541</span>                  e != <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">542</span>                  e = tab[i =<span style="color: #000000;"> nextIndex(i, len)]) {
</span><span style="color: #008080;">543</span>                 ThreadLocal&lt;?&gt; k =<span style="color: #000000;"> e.get();
</span><span style="color: #008080;">544</span> 
<span style="color: #008080;">545</span>                 <span style="color: #0000ff;">if</span> (k ==<span style="color: #000000;"> key) {
</span><span style="color: #008080;">546</span>                     e.value =<span style="color: #000000;"> value;
</span><span style="color: #008080;">547</span>                     <span style="color: #0000ff;">return</span><span style="color: #000000;">;
</span><span style="color: #008080;">548</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">549</span> 
<span style="color: #008080;">550</span>                 <span style="color: #0000ff;">if</span> (k == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">551</span> <span style="color: #000000;">                    replaceStaleEntry(key, value, i);
</span><span style="color: #008080;">552</span>                     <span style="color: #0000ff;">return</span><span style="color: #000000;">;
</span><span style="color: #008080;">553</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">554</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">555</span> 
<span style="color: #008080;">556</span>             tab[i] = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Entry(key, value);
</span><span style="color: #008080;">557</span>             <span style="color: #0000ff;">int</span> sz = ++<span style="color: #000000;">size;
</span><span style="color: #008080;">558</span>             <span style="color: #0000ff;">if</span> (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;=<span style="color: #000000;"> threshold)
</span><span style="color: #008080;">559</span> <span style="color: #000000;">                rehash();
</span><span style="color: #008080;">560</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">561</span> 
<span style="color: #008080;">562</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">563</span> <span style="color: #008000;">         * Remove the entry for key.
</span><span style="color: #008080;">564</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">565</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> remove(ThreadLocal&lt;?&gt;<span style="color: #000000;"> key) {
</span><span style="color: #008080;">566</span>             Entry[] tab =<span style="color: #000000;"> table;
</span><span style="color: #008080;">567</span>             <span style="color: #0000ff;">int</span> len =<span style="color: #000000;"> tab.length;
</span><span style="color: #008080;">568</span>             <span style="color: #0000ff;">int</span> i = key.threadLocalHashCode &amp; (len - 1<span style="color: #000000;">);
</span><span style="color: #008080;">569</span>             <span style="color: #0000ff;">for</span> (Entry e =<span style="color: #000000;"> tab[i];
</span><span style="color: #008080;">570</span>                  e != <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">571</span>                  e = tab[i =<span style="color: #000000;"> nextIndex(i, len)]) {
</span><span style="color: #008080;">572</span>                 <span style="color: #0000ff;">if</span> (e.get() ==<span style="color: #000000;"> key) {
</span><span style="color: #008080;">573</span> <span style="color: #000000;">                    e.clear();
</span><span style="color: #008080;">574</span> <span style="color: #000000;">                    expungeStaleEntry(i);
</span><span style="color: #008080;">575</span>                     <span style="color: #0000ff;">return</span><span style="color: #000000;">;
</span><span style="color: #008080;">576</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">577</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">578</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">579</span> 
<span style="color: #008080;">580</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">581</span> <span style="color: #008000;">         * Replace a stale entry encountered during a set operation
</span><span style="color: #008080;">582</span> <span style="color: #008000;">         * with an entry for the specified key.  The value passed in
</span><span style="color: #008080;">583</span> <span style="color: #008000;">         * the value parameter is stored in the entry, whether or not
</span><span style="color: #008080;">584</span> <span style="color: #008000;">         * an entry already exists for the specified key.
</span><span style="color: #008080;">585</span> <span style="color: #008000;">         * &lt;p&gt;
</span><span style="color: #008080;">586</span> <span style="color: #008000;">         * As a side effect, this method expunges all stale entries in the
</span><span style="color: #008080;">587</span> <span style="color: #008000;">         * "run" containing the stale entry.  (A run is a sequence of entries
</span><span style="color: #008080;">588</span> <span style="color: #008000;">         * between two null slots.)
</span><span style="color: #008080;">589</span> <span style="color: #008000;">         *
</span><span style="color: #008080;">590</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> key       the key
</span><span style="color: #008080;">591</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> value     the value to be associated with key
</span><span style="color: #008080;">592</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> staleSlot index of the first stale entry encountered while
</span><span style="color: #008080;">593</span> <span style="color: #008000;">         *                  searching for key.
</span><span style="color: #008080;">594</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">595</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> replaceStaleEntry(ThreadLocal&lt;?&gt;<span style="color: #000000;"> key, Object value,
</span><span style="color: #008080;">596</span>                                        <span style="color: #0000ff;">int</span><span style="color: #000000;"> staleSlot) {
</span><span style="color: #008080;">597</span>             Entry[] tab =<span style="color: #000000;"> table;
</span><span style="color: #008080;">598</span>             <span style="color: #0000ff;">int</span> len =<span style="color: #000000;"> tab.length;
</span><span style="color: #008080;">599</span> <span style="color: #000000;">            Entry e;
</span><span style="color: #008080;">600</span> 
<span style="color: #008080;">601</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> Back up to check for prior stale entry in current run.
</span><span style="color: #008080;">602</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> We clean out whole runs at a time to avoid continual
</span><span style="color: #008080;">603</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> incremental rehashing due to garbage collector freeing
</span><span style="color: #008080;">604</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> up refs in bunches (i.e., whenever the collector runs).</span>
<span style="color: #008080;">605</span>             <span style="color: #0000ff;">int</span> slotToExpunge =<span style="color: #000000;"> staleSlot;
</span><span style="color: #008080;">606</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i =<span style="color: #000000;"> prevIndex(staleSlot, len);
</span><span style="color: #008080;">607</span>                  (e = tab[i]) != <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">608</span>                  i =<span style="color: #000000;"> prevIndex(i, len))
</span><span style="color: #008080;">609</span>                 <span style="color: #0000ff;">if</span> (e.get() == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">610</span>                     slotToExpunge =<span style="color: #000000;"> i;
</span><span style="color: #008080;">611</span> 
<span style="color: #008080;">612</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> Find either the key or trailing null slot of run, whichever
</span><span style="color: #008080;">613</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> occurs first</span>
<span style="color: #008080;">614</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i =<span style="color: #000000;"> nextIndex(staleSlot, len);
</span><span style="color: #008080;">615</span>                  (e = tab[i]) != <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">616</span>                  i =<span style="color: #000000;"> nextIndex(i, len)) {
</span><span style="color: #008080;">617</span>                 ThreadLocal&lt;?&gt; k =<span style="color: #000000;"> e.get();
</span><span style="color: #008080;">618</span> 
<span style="color: #008080;">619</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> If we find key, then we need to swap it
</span><span style="color: #008080;">620</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> with the stale entry to maintain hash table order.
</span><span style="color: #008080;">621</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> The newly stale slot, or any other stale slot
</span><span style="color: #008080;">622</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> encountered above it, can then be sent to expungeStaleEntry
</span><span style="color: #008080;">623</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> to remove or rehash all of the other entries in run.</span>
<span style="color: #008080;">624</span>                 <span style="color: #0000ff;">if</span> (k ==<span style="color: #000000;"> key) {
</span><span style="color: #008080;">625</span>                     e.value =<span style="color: #000000;"> value;
</span><span style="color: #008080;">626</span> 
<span style="color: #008080;">627</span>                     tab[i] =<span style="color: #000000;"> tab[staleSlot];
</span><span style="color: #008080;">628</span>                     tab[staleSlot] =<span style="color: #000000;"> e;
</span><span style="color: #008080;">629</span> 
<span style="color: #008080;">630</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> Start expunge at preceding stale entry if it exists</span>
<span style="color: #008080;">631</span>                     <span style="color: #0000ff;">if</span> (slotToExpunge ==<span style="color: #000000;"> staleSlot)
</span><span style="color: #008080;">632</span>                         slotToExpunge =<span style="color: #000000;"> i;
</span><span style="color: #008080;">633</span> <span style="color: #000000;">                    cleanSomeSlots(expungeStaleEntry(slotToExpunge), len);
</span><span style="color: #008080;">634</span>                     <span style="color: #0000ff;">return</span><span style="color: #000000;">;
</span><span style="color: #008080;">635</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">636</span> 
<span style="color: #008080;">637</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> If we didn't find stale entry on backward scan, the
</span><span style="color: #008080;">638</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> first stale entry seen while scanning for key is the
</span><span style="color: #008080;">639</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> first still present in the run.</span>
<span style="color: #008080;">640</span>                 <span style="color: #0000ff;">if</span> (k == <span style="color: #0000ff;">null</span> &amp;&amp; slotToExpunge ==<span style="color: #000000;"> staleSlot)
</span><span style="color: #008080;">641</span>                     slotToExpunge =<span style="color: #000000;"> i;
</span><span style="color: #008080;">642</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">643</span> 
<span style="color: #008080;">644</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> If key not found, put new entry in stale slot</span>
<span style="color: #008080;">645</span>             tab[staleSlot].value = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">646</span>             tab[staleSlot] = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Entry(key, value);
</span><span style="color: #008080;">647</span> 
<span style="color: #008080;">648</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> If there are any other stale entries in run, expunge them</span>
<span style="color: #008080;">649</span>             <span style="color: #0000ff;">if</span> (slotToExpunge !=<span style="color: #000000;"> staleSlot)
</span><span style="color: #008080;">650</span> <span style="color: #000000;">                cleanSomeSlots(expungeStaleEntry(slotToExpunge), len);
</span><span style="color: #008080;">651</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">652</span> 
<span style="color: #008080;">653</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">654</span> <span style="color: #008000;">         * Expunge a stale entry by rehashing any possibly colliding entries
</span><span style="color: #008080;">655</span> <span style="color: #008000;">         * lying between staleSlot and the next null slot.  this also expunges
</span><span style="color: #008080;">656</span> <span style="color: #008000;">         * any other stale entries encountered before the trailing null.  See
</span><span style="color: #008080;">657</span> <span style="color: #008000;">         * Knuth, Section 6.4
</span><span style="color: #008080;">658</span> <span style="color: #008000;">         * 译：
</span><span style="color: #008080;">659</span> <span style="color: #008000;">         * 通过重新散列位于staleSlot和下一个null插槽之间的任何可能冲突的条目来清除
</span><span style="color: #008080;">660</span> <span style="color: #008000;">         * 陈旧的条目。这还将删除尾随null之前遇到的所有其他过时的条目。
</span><span style="color: #008080;">661</span> <span style="color: #008000;">         *
</span><span style="color: #008080;">662</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> staleSlot index of slot known to have null key
</span><span style="color: #008080;">663</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> the index of the next null slot after staleSlot
</span><span style="color: #008080;">664</span> <span style="color: #008000;">         * (all between staleSlot and this slot will have been checked
</span><span style="color: #008080;">665</span> <span style="color: #008000;">         * for expunging).
</span><span style="color: #008080;">666</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">667</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> expungeStaleEntry(<span style="color: #0000ff;">int</span><span style="color: #000000;"> staleSlot) {
</span><span style="color: #008080;">668</span>             Entry[] tab =<span style="color: #000000;"> table;
</span><span style="color: #008080;">669</span>             <span style="color: #0000ff;">int</span> len =<span style="color: #000000;"> tab.length;
</span><span style="color: #008080;">670</span> 
<span style="color: #008080;">671</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> expunge entry at staleSlot</span>
<span style="color: #008080;">672</span>             tab[staleSlot].value = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">673</span>             tab[staleSlot] = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">674</span>             size--<span style="color: #000000;">;
</span><span style="color: #008080;">675</span> 
<span style="color: #008080;">676</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> Rehash until we encounter null</span>
<span style="color: #008080;">677</span> <span style="color: #000000;">            Entry e;
</span><span style="color: #008080;">678</span>             <span style="color: #0000ff;">int</span><span style="color: #000000;"> i;
</span><span style="color: #008080;">679</span>             <span style="color: #0000ff;">for</span> (i =<span style="color: #000000;"> nextIndex(staleSlot, len);
</span><span style="color: #008080;">680</span>                  (e = tab[i]) != <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">681</span>                  i =<span style="color: #000000;"> nextIndex(i, len)) {
</span><span style="color: #008080;">682</span>                 ThreadLocal&lt;?&gt; k =<span style="color: #000000;"> e.get();
</span><span style="color: #008080;">683</span>                 <span style="color: #0000ff;">if</span> (k == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">684</span>                     e.value = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">685</span>                     tab[i] = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">686</span>                     size--<span style="color: #000000;">;
</span><span style="color: #008080;">687</span>                 } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">688</span>                     <span style="color: #0000ff;">int</span> h = k.threadLocalHashCode &amp; (len - 1<span style="color: #000000;">);
</span><span style="color: #008080;">689</span>                     <span style="color: #0000ff;">if</span> (h !=<span style="color: #000000;"> i) {
</span><span style="color: #008080;">690</span>                         tab[i] = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">691</span> 
<span style="color: #008080;">692</span>                         <span style="color: #008000;">//</span><span style="color: #008000;"> Unlike Knuth 6.4 Algorithm R, we must scan until
</span><span style="color: #008080;">693</span>                         <span style="color: #008000;">//</span><span style="color: #008000;"> null because multiple entries could have been stale.</span>
<span style="color: #008080;">694</span>                         <span style="color: #0000ff;">while</span> (tab[h] != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">695</span>                             h =<span style="color: #000000;"> nextIndex(h, len);
</span><span style="color: #008080;">696</span>                         tab[h] =<span style="color: #000000;"> e;
</span><span style="color: #008080;">697</span> <span style="color: #000000;">                    }
</span><span style="color: #008080;">698</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">699</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">700</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> i;
</span><span style="color: #008080;">701</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">702</span> 
<span style="color: #008080;">703</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">704</span> <span style="color: #008000;">         * Heuristically scan some cells looking for stale entries.
</span><span style="color: #008080;">705</span> <span style="color: #008000;">         * This is invoked when either a new element is added, or
</span><span style="color: #008080;">706</span> <span style="color: #008000;">         * another stale one has been expunged. It performs a
</span><span style="color: #008080;">707</span> <span style="color: #008000;">         * logarithmic number of scans, as a balance between no
</span><span style="color: #008080;">708</span> <span style="color: #008000;">         * scanning (fast but retains garbage) and a number of scans
</span><span style="color: #008080;">709</span> <span style="color: #008000;">         * proportional to number of elements, that would find all
</span><span style="color: #008080;">710</span> <span style="color: #008000;">         * garbage but would cause some insertions to take O(n) time.
</span><span style="color: #008080;">711</span> <span style="color: #008000;">         * 译：
</span><span style="color: #008080;">712</span> <span style="color: #008000;">         * 启发式扫描某些单元以查找陈旧条目。当添加了新元素或已删除另一旧
</span><span style="color: #008080;">713</span> <span style="color: #008000;">         * 元素时，将调用此方法。它执行对数扫描，作为无扫描（快速但保留垃
</span><span style="color: #008080;">714</span> <span style="color: #008000;">         * 圾）和与元素数量成正比的扫描数量之间的平衡，这会发现所有垃圾，
</span><span style="color: #008080;">715</span> <span style="color: #008000;">         * 但会导致某些插入花费O（n）时间。
</span><span style="color: #008080;">716</span> <span style="color: #008000;">         *
</span><span style="color: #008080;">717</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> i a position known NOT to hold a stale entry. The
</span><span style="color: #008080;">718</span> <span style="color: #008000;">         *          scan starts at the element after i.
</span><span style="color: #008080;">719</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> n scan control: {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> log2(n)} cells are scanned,
</span><span style="color: #008080;">720</span> <span style="color: #008000;">         *          unless a stale entry is found, in which case
</span><span style="color: #008080;">721</span> <span style="color: #008000;">         *          {</span><span style="color: #808080;">@code</span><span style="color: #008000;"> log2(table.length)-1} additional cells are scanned.
</span><span style="color: #008080;">722</span> <span style="color: #008000;">         *          When called from insertions, this parameter is the number
</span><span style="color: #008080;">723</span> <span style="color: #008000;">         *          of elements, but when from replaceStaleEntry, it is the
</span><span style="color: #008080;">724</span> <span style="color: #008000;">         *          table length. (Note: all this could be changed to be either
</span><span style="color: #008080;">725</span> <span style="color: #008000;">         *          more or less aggressive by weighting n instead of just
</span><span style="color: #008080;">726</span> <span style="color: #008000;">         *          using straight log n. But this version is simple, fast, and
</span><span style="color: #008080;">727</span> <span style="color: #008000;">         *          seems to work well.)
</span><span style="color: #008080;">728</span> <span style="color: #008000;">         * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> true if any stale entries have been removed.
</span><span style="color: #008080;">729</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">730</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> cleanSomeSlots(<span style="color: #0000ff;">int</span> i, <span style="color: #0000ff;">int</span><span style="color: #000000;"> n) {
</span><span style="color: #008080;">731</span>             <span style="color: #0000ff;">boolean</span> removed = <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;">732</span>             Entry[] tab =<span style="color: #000000;"> table;
</span><span style="color: #008080;">733</span>             <span style="color: #0000ff;">int</span> len =<span style="color: #000000;"> tab.length;
</span><span style="color: #008080;">734</span>             <span style="color: #0000ff;">do</span><span style="color: #000000;"> {
</span><span style="color: #008080;">735</span>                 i =<span style="color: #000000;"> nextIndex(i, len);
</span><span style="color: #008080;">736</span>                 Entry e =<span style="color: #000000;"> tab[i];
</span><span style="color: #008080;">737</span>                 <span style="color: #0000ff;">if</span> (e != <span style="color: #0000ff;">null</span> &amp;&amp; e.get() == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">738</span>                     n =<span style="color: #000000;"> len;
</span><span style="color: #008080;">739</span>                     removed = <span style="color: #0000ff;">true</span><span style="color: #000000;">;
</span><span style="color: #008080;">740</span>                     i =<span style="color: #000000;"> expungeStaleEntry(i);
</span><span style="color: #008080;">741</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">742</span>             } <span style="color: #0000ff;">while</span> ((n &gt;&gt;&gt;= 1) != 0<span style="color: #000000;">);
</span><span style="color: #008080;">743</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> removed;
</span><span style="color: #008080;">744</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">745</span> 
<span style="color: #008080;">746</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">747</span> <span style="color: #008000;">         * Re-pack and/or re-size the table. First scan the entire
</span><span style="color: #008080;">748</span> <span style="color: #008000;">         * table removing stale entries. If this doesn't sufficiently
</span><span style="color: #008080;">749</span> <span style="color: #008000;">         * shrink the size of the table, double the table size.
</span><span style="color: #008080;">750</span> <span style="color: #008000;">         * 译：
</span><span style="color: #008080;">751</span> <span style="color: #008000;">         * 重新包装和/或调整表大小。首先扫描整个表，删除陈旧的条目。
</span><span style="color: #008080;">752</span> <span style="color: #008000;">         * 如果这还不足以缩小表格的大小，请将表格大小加倍。
</span><span style="color: #008080;">753</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">754</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> rehash() {
</span><span style="color: #008080;">755</span> <span style="color: #000000;">            expungeStaleEntries();
</span><span style="color: #008080;">756</span> 
<span style="color: #008080;">757</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> Use lower threshold for doubling to avoid hysteresis</span>
<span style="color: #008080;">758</span>             <span style="color: #0000ff;">if</span> (size &gt;= threshold - threshold / 4<span style="color: #000000;">)
</span><span style="color: #008080;">759</span> <span style="color: #000000;">                resize();
</span><span style="color: #008080;">760</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">761</span> 
<span style="color: #008080;">762</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">763</span> <span style="color: #008000;">         * Double the capacity of the table.
</span><span style="color: #008080;">764</span> <span style="color: #008000;">         * 使表的容积几倍。
</span><span style="color: #008080;">765</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">766</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> resize() {
</span><span style="color: #008080;">767</span>             Entry[] oldTab =<span style="color: #000000;"> table;
</span><span style="color: #008080;">768</span>             <span style="color: #0000ff;">int</span> oldLen =<span style="color: #000000;"> oldTab.length;
</span><span style="color: #008080;">769</span>             <span style="color: #0000ff;">int</span> newLen = oldLen * 2<span style="color: #000000;">;
</span><span style="color: #008080;">770</span>             Entry[] newTab = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Entry[newLen];
</span><span style="color: #008080;">771</span>             <span style="color: #0000ff;">int</span> count = 0<span style="color: #000000;">;
</span><span style="color: #008080;">772</span> 
<span style="color: #008080;">773</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> j = 0; j &lt; oldLen; ++<span style="color: #000000;">j) {
</span><span style="color: #008080;">774</span>                 Entry e =<span style="color: #000000;"> oldTab[j];
</span><span style="color: #008080;">775</span>                 <span style="color: #0000ff;">if</span> (e != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">776</span>                     ThreadLocal&lt;?&gt; k =<span style="color: #000000;"> e.get();
</span><span style="color: #008080;">777</span>                     <span style="color: #0000ff;">if</span> (k == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">778</span>                         e.value = <span style="color: #0000ff;">null</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> Help the GC</span>
<span style="color: #008080;">779</span>                     } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">780</span>                         <span style="color: #0000ff;">int</span> h = k.threadLocalHashCode &amp; (newLen - 1<span style="color: #000000;">);
</span><span style="color: #008080;">781</span>                         <span style="color: #0000ff;">while</span> (newTab[h] != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">782</span>                             h =<span style="color: #000000;"> nextIndex(h, newLen);
</span><span style="color: #008080;">783</span>                         newTab[h] =<span style="color: #000000;"> e;
</span><span style="color: #008080;">784</span>                         count++<span style="color: #000000;">;
</span><span style="color: #008080;">785</span> <span style="color: #000000;">                    }
</span><span style="color: #008080;">786</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">787</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">788</span> 
<span style="color: #008080;">789</span> <span style="color: #000000;">            setThreshold(newLen);
</span><span style="color: #008080;">790</span>             size =<span style="color: #000000;"> count;
</span><span style="color: #008080;">791</span>             table =<span style="color: #000000;"> newTab;
</span><span style="color: #008080;">792</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">793</span> 
<span style="color: #008080;">794</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">795</span> <span style="color: #008000;">         * Expunge all stale entries in the table.
</span><span style="color: #008080;">796</span> <span style="color: #008000;">         * 清除表中所有过时条目
</span><span style="color: #008080;">797</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">798</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> expungeStaleEntries() {
</span><span style="color: #008080;">799</span>             Entry[] tab =<span style="color: #000000;"> table;
</span><span style="color: #008080;">800</span>             <span style="color: #0000ff;">int</span> len =<span style="color: #000000;"> tab.length;
</span><span style="color: #008080;">801</span>             <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> j = 0; j &lt; len; j++<span style="color: #000000;">) {
</span><span style="color: #008080;">802</span>                 Entry e =<span style="color: #000000;"> tab[j];
</span><span style="color: #008080;">803</span>                 <span style="color: #0000ff;">if</span> (e != <span style="color: #0000ff;">null</span> &amp;&amp; e.get() == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">804</span> <span style="color: #000000;">                    expungeStaleEntry(j);
</span><span style="color: #008080;">805</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">806</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">807</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">808</span> }</pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/*</span>
<span style="color: #008080;"> 2</span> <span style="color: #008000;"> * Copyright (c) 2012, 2013, Oracle and/or its affiliates. All rights reserved.
</span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> * ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
</span><span style="color: #008080;"> 4</span> <span style="color: #008000;"> *
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;"> *
</span><span style="color: #008080;"> 6</span> <span style="color: #008000;"> *
</span><span style="color: #008080;"> 7</span> <span style="color: #008000;"> *
</span><span style="color: #008080;"> 8</span> <span style="color: #008000;"> *
</span><span style="color: #008080;"> 9</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">10</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">11</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">12</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">13</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">14</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">15</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">16</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">17</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">18</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">19</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">20</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">21</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">22</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">23</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">24</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;">25</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> java.util.function;
</span><span style="color: #008080;">26</span> 
<span style="color: #008080;">27</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;">28</span> <span style="color: #008000;"> * 该类函数式接口应用于支持Lambda表达式的API中，
</span><span style="color: #008080;">29</span> <span style="color: #008000;"> * Supplier接口用于提供一个T类对象。
</span><span style="color: #008080;">30</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;">31</span> 
<span style="color: #008080;">32</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;">33</span> <span style="color: #008000;"> * Represents a supplier of results.
</span><span style="color: #008080;">34</span> <span style="color: #008000;"> * 代表结果的提供者
</span><span style="color: #008080;">35</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">36</span> <span style="color: #008000;"> * &lt;p&gt;There is no requirement that a new or distinct result be returned each
</span><span style="color: #008080;">37</span> <span style="color: #008000;"> * time the supplier is invoked.
</span><span style="color: #008080;">38</span> <span style="color: #008000;"> * 并不要求每次调用都返回一个新的或者不同的结果。
</span><span style="color: #008080;">39</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">40</span> <span style="color: #008000;"> * &lt;p&gt;This is a &lt;a href="package-summary.html"&gt;functional interface&lt;/a&gt;
</span><span style="color: #008080;">41</span> <span style="color: #008000;"> * whose functional method is {</span><span style="color: #808080;">@link</span><span style="color: #008000;"> #get()}.
</span><span style="color: #008080;">42</span> <span style="color: #008000;"> *
</span><span style="color: #008080;">43</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> &lt;T&gt; the type of results supplied by this supplier
</span><span style="color: #008080;">44</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@since</span><span style="color: #008000;"> 1.8
</span><span style="color: #008080;">45</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;">46</span> <span style="color: #000000;">@FunctionalInterface
</span><span style="color: #008080;">47</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span> Supplier&lt;T&gt;<span style="color: #000000;"> {
</span><span style="color: #008080;">48</span> 
<span style="color: #008080;">49</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">50</span> <span style="color: #008000;">     * Gets a result.
</span><span style="color: #008080;">51</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">52</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> a result
</span><span style="color: #008080;">53</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">54</span> <span style="color: #000000;">    T get();
</span><span style="color: #008080;">55</span> }</pre>
</div>
]]></description></item><item><title>Java锁对象和条件对象的使用</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/13/12035248.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Fri, 13 Dec 2019 07:14:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/13/12035248.html</guid><description><![CDATA[<h3><strong>锁对象</strong></h3>
<p>临界区：临界区是一个特殊的代码段，该代码段访问某种特殊的公共资源，该资源同一时间只允许一个线程使用。</p>
<p>Java<span style="font-family: 宋体;">中可以使用锁对象创造一个临界区：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #000000;">myLock.lock();
</span><span style="color: #008080;">2</span> <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
</span><span style="color: #008080;">3</span> <span style="color: #000000;">    关键代码
</span><span style="color: #008080;">4</span> } <span style="color: #0000ff;">finally</span><span style="color: #000000;"> {
</span><span style="color: #008080;">5</span> <span style="color: #000000;">    myLock.unlock();
</span><span style="color: #008080;">6</span> }</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">使用这种结构可以确保关键代码不会同时被多个线程执行，线程想要执行关键代码必须先获取</span>&ldquo;锁&rdquo;，&ldquo;锁&rdquo;只能被一个线程持有，在该线程将&ldquo;锁&rdquo;释放前，其他线程因为获取不到锁而被阻塞，&ldquo;锁&rdquo;被释放的时候，之前因为获取这个锁被挂起的线程都会被唤醒，共同竞争着去获取锁。</p>
<p><span style="font-family: 宋体;">将释放锁的操作写在</span>finally<span style="font-family: 宋体;">里是很重要的，防止某个线程执行关键代码的时候因为抛出异常而没有将锁释放。</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('bd1ba4ad-2a6b-431b-9454-1366c0a1aa0b')"><img id="code_img_closed_bd1ba4ad-2a6b-431b-9454-1366c0a1aa0b" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_bd1ba4ad-2a6b-431b-9454-1366c0a1aa0b" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('bd1ba4ad-2a6b-431b-9454-1366c0a1aa0b',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_bd1ba4ad-2a6b-431b-9454-1366c0a1aa0b" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> learnspringboot.xiao.learnjava.thread;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.HashMap;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Map;
</span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.concurrent.locks.Condition;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.concurrent.locks.Lock;
</span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.concurrent.locks.ReentrantLock;
</span><span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;">10</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> xzy
</span><span style="color: #008080;">11</span> <span style="color: #008000;"> * @date 2019-12-13 11:01
</span><span style="color: #008080;">12</span> <span style="color: #008000;"> * 说明：模拟银行转账
</span><span style="color: #008080;">13</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;">14</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Bank {
</span><span style="color: #008080;">15</span>     <span style="color: #0000ff;">private</span> Map&lt;String, Double&gt; accountMap = <span style="color: #0000ff;">new</span> HashMap&lt;&gt;<span style="color: #000000;">();
</span><span style="color: #008080;">16</span>     <span style="color: #0000ff;">private</span> Lock myLock = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ReentrantLock();
</span><span style="color: #008080;">17</span>     <span style="color: #0000ff;">private</span> Condition haveMoney =<span style="color: #000000;"> myLock.newCondition();
</span><span style="color: #008080;">18</span> 
<span style="color: #008080;">19</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Bank() {
</span><span style="color: #008080;">20</span>         <span style="color: #0000ff;">this</span>.accountMap.put("ZhangSan", 100.0<span style="color: #000000;">);
</span><span style="color: #008080;">21</span>         <span style="color: #0000ff;">this</span>.accountMap.put("WangWu", 1000.0<span style="color: #000000;">);
</span><span style="color: #008080;">22</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">23</span> 
<span style="color: #008080;">24</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> transfer(String from, String to, Double money) {
</span><span style="color: #008080;">25</span>         <span style="color: #008000;">//</span><span style="color: #008000;">线程执行后面的代码段需要先获得锁，获取不到就挂起。</span>
<span style="color: #008080;">26</span> <span style="color: #000000;">        myLock.lock();
</span><span style="color: #008080;">27</span>         System.out.println("当前获得锁的线程：" +<span style="color: #000000;"> Thread.currentThread().getName());
</span><span style="color: #008080;">28</span>         System.out.println(from + "想给" + to + "转" + money + "元," + from + "现在有" + accountMap.get(from) + "元"<span style="color: #000000;">);
</span><span style="color: #008080;">29</span>         <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
</span><span style="color: #008080;">30</span>             <span style="color: #0000ff;">while</span> (accountMap.get(from) &lt;<span style="color: #000000;"> money) {
</span><span style="color: #008080;">31</span>                 System.out.println("线程阻塞：" +<span style="color: #000000;"> Thread.currentThread().getName());
</span><span style="color: #008080;">32</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">获取到锁的线程需要等待本条件成立，条件成立前将锁释放，线程阻塞。</span>
<span style="color: #008080;">33</span> <span style="color: #000000;">                haveMoney.await();
</span><span style="color: #008080;">34</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">35</span>             accountMap.put(from, accountMap.get(from) -<span style="color: #000000;"> money);
</span><span style="color: #008080;">36</span>             accountMap.put(to, accountMap.get(to) +<span style="color: #000000;"> money);
</span><span style="color: #008080;">37</span>             System.out.println(from + "转给" + to + money + "元  线程：" +<span style="color: #000000;"> Thread.currentThread().getName());
</span><span style="color: #008080;">38</span>             <span style="color: #008000;">//</span><span style="color: #008000;">通知因本条件而挂起的线程，条件现在可能已经满足，可以试着再去获取肯看。</span>
<span style="color: #008080;">39</span> <span style="color: #000000;">            haveMoney.signalAll();
</span><span style="color: #008080;">40</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {
</span><span style="color: #008080;">41</span> <span style="color: #000000;">            e.printStackTrace();
</span><span style="color: #008080;">42</span>         } <span style="color: #0000ff;">finally</span><span style="color: #000000;"> {
</span><span style="color: #008080;">43</span> <span style="color: #000000;">            myLock.unlock();
</span><span style="color: #008080;">44</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">45</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">46</span> 
<span style="color: #008080;">47</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
</span><span style="color: #008080;">48</span>         Bank bank = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Bank();
</span><span style="color: #008080;">49</span>         Thread thread1 = <span style="color: #0000ff;">new</span> Thread(() -&gt;<span style="color: #000000;"> {
</span><span style="color: #008080;">50</span>             bank.transfer("ZhangSan", "WangWu", 500.0<span style="color: #000000;">);
</span><span style="color: #008080;">51</span> <span style="color: #000000;">        });
</span><span style="color: #008080;">52</span>         Thread thread2 = <span style="color: #0000ff;">new</span> Thread(() -&gt;<span style="color: #000000;"> {
</span><span style="color: #008080;">53</span>             bank.transfer("WangWu", "ZhangSan", 1000.0<span style="color: #000000;">);
</span><span style="color: #008080;">54</span> <span style="color: #000000;">        });
</span><span style="color: #008080;">55</span>         Thread thread3 = <span style="color: #0000ff;">new</span> Thread(() -&gt;<span style="color: #000000;"> {
</span><span style="color: #008080;">56</span>             bank.transfer("ZhangSan", "WangWu", 500.0<span style="color: #000000;">);
</span><span style="color: #008080;">57</span> <span style="color: #000000;">        });
</span><span style="color: #008080;">58</span>         thread1.setName("张三给王五500 x1"<span style="color: #000000;">);
</span><span style="color: #008080;">59</span>         thread2.setName("王五给张三1000"<span style="color: #000000;">);
</span><span style="color: #008080;">60</span>         thread3.setName("张三给王五500 x2"<span style="color: #000000;">);
</span><span style="color: #008080;">61</span> <span style="color: #000000;">        thread1.start();
</span><span style="color: #008080;">62</span> <span style="color: #000000;">        thread2.start();
</span><span style="color: #008080;">63</span> <span style="color: #000000;">        thread3.start();
</span><span style="color: #008080;">64</span>         <span style="color: #0000ff;">while</span> (<span style="color: #0000ff;">true</span><span style="color: #000000;">) {
</span><span style="color: #008080;">65</span> 
<span style="color: #008080;">66</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">67</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">68</span> }</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201912/1689384-20191213151423027-1418702096.png" alt="" /></p>
]]></description></item><item><title>Java迭代器源码解析</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/07/12003380.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 07 Dec 2019 13:03:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/12/07/12003380.html</guid><description><![CDATA[<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span>  <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">class</span> Itr <span style="color: #0000ff;">implements</span> Iterator&lt;E&gt;<span style="color: #000000;"> {
</span><span style="color: #008080;"> 2</span>         <span style="color: #0000ff;">int</span> cursor;       <span style="color: #008000;">//</span><span style="color: #008000;"> 调用next方法返回的元素的索引</span>
<span style="color: #008080;"> 3</span>         <span style="color: #0000ff;">int</span> lastRet = -1; <span style="color: #008000;">//</span><span style="color: #008000;"> 最近一次调用next方法返回的元素的索引（如果没有调用过next方法，这个值等于-1）</span>
<span style="color: #008080;"> 4</span>         <span style="color: #0000ff;">int</span> expectedModCount =<span style="color: #000000;"> modCount;
</span><span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span> <span style="color: #000000;">        Itr() {}
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span>         <span style="color: #008000;">/*</span>
<span style="color: #008080;"> 9</span> <span style="color: #008000;">        *判断光标指向的位置是否还有元素，即迭代器下一次迭代是否还能获取到元素。
</span><span style="color: #008080;">10</span>         <span style="color: #008000;">*/</span>
<span style="color: #008080;">11</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> hasNext() {
</span><span style="color: #008080;">12</span>             <span style="color: #0000ff;">return</span> cursor !=<span style="color: #000000;"> size;
</span><span style="color: #008080;">13</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">14</span> 
<span style="color: #008080;">15</span>         <span style="color: #008000;">/*</span>
<span style="color: #008080;">16</span> <span style="color: #008000;">        *返回光标指向位置的元素，然后移动光标。
</span><span style="color: #008080;">17</span>         <span style="color: #008000;">*/</span>
<span style="color: #008080;">18</span>         @SuppressWarnings("unchecked"<span style="color: #000000;">)
</span><span style="color: #008080;">19</span>         <span style="color: #0000ff;">public</span><span style="color: #000000;"> E next() {
</span><span style="color: #008080;">20</span> <span style="color: #000000;">            checkForComodification();
</span><span style="color: #008080;">21</span>             <span style="color: #008000;">//</span><span style="color: #008000;">1、所以调用next方法前需要先调用hasNext方法进行判断&mdash;&mdash;避免抛出异常</span>
<span style="color: #008080;">22</span>             <span style="color: #0000ff;">int</span> i =<span style="color: #000000;"> cursor;
</span><span style="color: #008080;">23</span>             <span style="color: #0000ff;">if</span> (i &gt;=<span style="color: #000000;"> size)
</span><span style="color: #008080;">24</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> NoSuchElementException();
</span><span style="color: #008080;">25</span>             Object[] elementData = ArrayList.<span style="color: #0000ff;">this</span><span style="color: #000000;">.elementData;
</span><span style="color: #008080;">26</span>             <span style="color: #0000ff;">if</span> (i &gt;=<span style="color: #000000;"> elementData.length)
</span><span style="color: #008080;">27</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> ConcurrentModificationException();
</span><span style="color: #008080;">28</span>             <span style="color: #008000;">//</span><span style="color: #008000;">2、先移动光标，后返回数值</span>
<span style="color: #008080;">29</span>             cursor = i + 1<span style="color: #000000;">;
</span><span style="color: #008080;">30</span>             <span style="color: #008000;">//</span><span style="color: #008000;">3、lastRest变量记录本次返回的元素在集合中的位置</span>
<span style="color: #008080;">31</span>             <span style="color: #0000ff;">return</span> (E) elementData[lastRet =<span style="color: #000000;"> i];
</span><span style="color: #008080;">32</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">33</span> 
<span style="color: #008080;">34</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> remove() {
</span><span style="color: #008080;">35</span>             <span style="color: #0000ff;">if</span> (lastRet &lt; 0<span style="color: #000000;">)
</span><span style="color: #008080;">36</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> IllegalStateException();
</span><span style="color: #008080;">37</span> <span style="color: #000000;">            checkForComodification();
</span><span style="color: #008080;">38</span> 
<span style="color: #008080;">39</span>             <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
</span><span style="color: #008080;">40</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">2、从这里可以看出，remove方法移除的是上一次调用next方法返回的元素。</span>
<span style="color: #008080;">41</span>                 ArrayList.<span style="color: #0000ff;">this</span><span style="color: #000000;">.remove(lastRet);
</span><span style="color: #008080;">42</span>                 cursor =<span style="color: #000000;"> lastRet;
</span><span style="color: #008080;">43</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">3、从这里可以看出，remove方法和next方法是紧密相关的。
</span><span style="color: #008080;">44</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">只有调用了next方法才能调用remove方法，remove方法不能联系调用，
</span><span style="color: #008080;">45</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">下一次调用remove方法前必须调用next方法。</span>
<span style="color: #008080;">46</span>                 lastRet = -1<span style="color: #000000;">;
</span><span style="color: #008080;">47</span>                 expectedModCount =<span style="color: #000000;"> modCount;
</span><span style="color: #008080;">48</span>             } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IndexOutOfBoundsException ex) {
</span><span style="color: #008080;">49</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> ConcurrentModificationException();
</span><span style="color: #008080;">50</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">51</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">52</span> 
<span style="color: #008080;">53</span> <span style="color: #000000;">        @Override
</span><span style="color: #008080;">54</span>         @SuppressWarnings("unchecked"<span style="color: #000000;">)
</span><span style="color: #008080;">55</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> forEachRemaining(Consumer&lt;? <span style="color: #0000ff;">super</span> E&gt;<span style="color: #000000;"> consumer) {
</span><span style="color: #008080;">56</span> <span style="color: #000000;">            Objects.requireNonNull(consumer);
</span><span style="color: #008080;">57</span>             <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> size = ArrayList.<span style="color: #0000ff;">this</span><span style="color: #000000;">.size;
</span><span style="color: #008080;">58</span>             <span style="color: #0000ff;">int</span> i =<span style="color: #000000;"> cursor;
</span><span style="color: #008080;">59</span>             <span style="color: #0000ff;">if</span> (i &gt;=<span style="color: #000000;"> size) {
</span><span style="color: #008080;">60</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;">;
</span><span style="color: #008080;">61</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">62</span>             <span style="color: #0000ff;">final</span> Object[] elementData = ArrayList.<span style="color: #0000ff;">this</span><span style="color: #000000;">.elementData;
</span><span style="color: #008080;">63</span>             <span style="color: #0000ff;">if</span> (i &gt;=<span style="color: #000000;"> elementData.length) {
</span><span style="color: #008080;">64</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> ConcurrentModificationException();
</span><span style="color: #008080;">65</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">66</span>             <span style="color: #0000ff;">while</span> (i != size &amp;&amp; modCount ==<span style="color: #000000;"> expectedModCount) {
</span><span style="color: #008080;">67</span>                 consumer.accept((E) elementData[i++<span style="color: #000000;">]);
</span><span style="color: #008080;">68</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">69</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> update once at end of iteration to reduce heap write traffic</span>
<span style="color: #008080;">70</span>             cursor =<span style="color: #000000;"> i;
</span><span style="color: #008080;">71</span>             lastRet = i - 1<span style="color: #000000;">;
</span><span style="color: #008080;">72</span> <span style="color: #000000;">            checkForComodification();
</span><span style="color: #008080;">73</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">74</span> 
<span style="color: #008080;">75</span>         <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> checkForComodification() {
</span><span style="color: #008080;">76</span>             <span style="color: #0000ff;">if</span> (modCount !=<span style="color: #000000;"> expectedModCount)
</span><span style="color: #008080;">77</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> ConcurrentModificationException();
</span><span style="color: #008080;">78</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">79</span>     }</pre>
</div>
<p>&nbsp;</p>]]></description></item><item><title>Spring 配置内容外部化</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/30/11963920.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 30 Nov 2019 12:56:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/30/11963920.html</guid><description><![CDATA[<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191130205315706-2023254279.png" alt="" width="1000" /></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191130205414249-544741092.png" alt="" width="1000" /></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191130205558549-575493656.png" alt="" width="1000" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>Spring命令行参数</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/27/11942726.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 27 Nov 2019 07:39:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/27/11942726.html</guid><description><![CDATA[<p><span style="font-family: 仿宋; font-size: 18px;">　　一般我们通过java -jar xxx.jar的方式启动应用，其实除了启动应用我们还能在命令中指定应用的参数，比如<strong>java -jar xxx.jar --server.port=1234</strong>，直接以命令行的方式设置server.port属性的值，最终启动的应用的端口号被设置为1234。</span></p>
<p><span style="font-family: 仿宋; font-size: 18px;">　　在以命令行方式启动Spring Boot应用时，连续两个减号--就是对application.properties中的属性值进行赋值的标识。所以java -jar xxx.jar --server.port=1234命令，等价于在application.properties中添加属性server.port=1234</span></p>]]></description></item><item><title>Spring Boot 配置文件中使用变量、使用随机数</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/27/11942539.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 27 Nov 2019 07:20:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/27/11942539.html</guid><description><![CDATA[<h2>参数引用</h2>
<p><span style="font-family: 仿宋; font-size: 18px;">　　在application.properties中的各个参数之间可以直接通过是使用placeHolder的方式进行引用，如：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #ff6600;">book.author</span>=<span style="color: #339966;">Clark
</span><span style="color: #008080;">2</span> <span style="color: #ff6600;">book.name</span>=<span style="color: #339966;">C++</span>
<span style="color: #008080;">3</span> <span style="color: #ff6600;">book.price</span>=<span style="color: #339966;">100.0</span>
<span style="color: #008080;">4</span> <span style="color: #ff6600;">book.desc</span>=<span style="color: #339966;">author</span>:${<span style="color: #ff6600;">book.author</span><span style="color: #339966;">} name:${</span><span style="color: #ff6600;">book.name</span><span style="color: #339966;">} price:${</span><span style="color: #ff6600;">book.price</span><span style="color: #339966;">}</span></pre>
</div>
<h2>使用随机数</h2>
<p><span style="font-family: 仿宋; font-size: 18px;">　　在一些特殊情况下，我们希望有些参数每次被加载时不是一个固定的值，比如密钥、服务端口号等。在Spring Boot属性配置文件中，我们通过使用${random}配置来产生随机的int值、long值或者string字符串，这样我们就可以通过配置随机生成属性。</span></p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191127151843290-1881794304.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>Java集合使用之next方法与remove方法  |  Java集合使用之remove方法使用易错</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/26/11938633.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Tue, 26 Nov 2019 13:35:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/26/11938633.html</guid><description><![CDATA[<p><span style="font-family: 仿宋; font-size: 18px;">&nbsp; Iterator接口的remove方法将会删除上次调用next方法时返回的元素。</span></p>
<p><span style="font-family: 仿宋; font-size: 18px;">&nbsp;<span style="color: #ff0000;"> next方法和remove方法的调用具有相互依赖性，如果调用remove方法前没有调用next方法是不合法的。</span></span></p>
<p><span style="font-family: 仿宋; font-size: 18px;"><span style="color: #ff0000;">错误使用1：</span></span></p>
<p><span style="font-family: 仿宋; font-size: 18px;"><span style="color: #ff0000;"><img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191126213228131-8090121.png" alt="" /></span></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 仿宋; font-size: 18px;"><span style="color: #ff0000;"></span></span></p>
<p><span style="font-family: 仿宋; font-size: 18px;">&nbsp;如果想要删除集合中两个相邻的元素，不能直接这样调用：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #000000;">iterator.remove();
</span><span style="color: #008080;">2</span> iterator.remove();</pre>
</div>
<p><span style="font-family: 仿宋; font-size: 18px;">必须在中间添加一个next方法的调用。</span></p>]]></description></item><item><title>Java 迭代器须知 | “for each”与迭代器的关系 </title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/26/11938588.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Tue, 26 Nov 2019 13:27:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/26/11938588.html</guid><description><![CDATA[<p><span style="font-size: 18px; font-family: 仿宋;">&nbsp; Iterator接口包含4个方法：</span></p>
<p><span style="font-size: 18px;"><img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191126211150527-541213292.png" alt="" width="500" /></span></p>
<p><span style="font-size: 14pt; font-family: 仿宋;">&nbsp; 通过反复调用next方法就可以逐个访问集合中的每个元素。需要注意，如果到达了集合的末尾，再次调用next方法将会抛出一个NoSuchElementException，因此，通常遍历在调用next方法前先调用hasNext方法。</span></p>
<p><span style="font-size: 18px;"><span style="font-size: 14pt; font-family: 仿宋;">&nbsp; 如果想要遍历集合中的所有元素，可以请求一个迭代器，并在hasNext方法返回true时反复地调用next方法，如：</span></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
</span><span style="color: #008080;"> 2</span>         List&lt;String&gt; nameList = <span style="color: #0000ff;">new</span> LinkedList&lt;&gt;<span style="color: #000000;">();
</span><span style="color: #008080;"> 3</span>         nameList.add("aaa"<span style="color: #000000;">);
</span><span style="color: #008080;"> 4</span>         nameList.add("bbb"<span style="color: #000000;">);
</span><span style="color: #008080;"> 5</span>         nameList.add("ccc"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>         nameList.add("ddd"<span style="color: #000000;">);
</span><span style="color: #008080;"> 7</span>         <span style="background-color: #ffff99;">Iterator&lt;String&gt;</span> nameIterator =<span style="color: #000000;"> nameList.iterator();
</span><span style="color: #008080;"> 8</span>         <span style="color: #0000ff;">while</span><span style="color: #000000;"> (nameIterator.<span style="background-color: #ffff99;">hasNext()</span>) {
</span><span style="color: #008080;"> 9</span> <span style="color: #000000;">            System.out.println(nameIterator.<span style="background-color: #ffff99;">next()</span>);
</span><span style="color: #008080;">10</span> <span style="color: #000000;">            //nameIterator.remove();
</span><span style="color: #008080;">11</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">12</span>     }</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 仿宋; font-size: 18px;">&nbsp; 也可以使用&ldquo;for each&rdquo;更加简练地实现同样地操作：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
</span><span style="color: #008080;"> 2</span>         List&lt;String&gt; nameList = <span style="color: #0000ff;">new</span> LinkedList&lt;&gt;<span style="color: #000000;">();
</span><span style="color: #008080;"> 3</span>         nameList.add("aaa"<span style="color: #000000;">);
</span><span style="color: #008080;"> 4</span>         nameList.add("bbb"<span style="color: #000000;">);
</span><span style="color: #008080;"> 5</span>         nameList.add("ccc"<span style="color: #000000;">);
</span><span style="color: #008080;"> 6</span>         nameList.add("ddd"<span style="color: #000000;">);
</span><span style="color: #008080;"> 7</span>         <span style="color: #0000ff;">for</span><span style="color: #000000;"> (String name : nameList) {
</span><span style="color: #008080;"> 8</span> <span style="color: #000000;">            System.out.println(name);
</span><span style="color: #008080;"> 9</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">10</span>     }</pre>
</div>
<p><span style="font-family: 仿宋; font-size: 18px; color: #ff0000;">&nbsp; 事实上，&ldquo;for each&rdquo;会被编译器翻译为带有迭代器地循环。</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>SpringDataJpa多条件查询代码封装</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/25/11927618.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Mon, 25 Nov 2019 06:36:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/25/11927618.html</guid><description><![CDATA[<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.pantech.cloud.mlogistics.util;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.mysql.jdbc.StringUtils;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.domain.PageRequest;
</span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.domain.Pageable;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.domain.Sort;
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Map;
</span><span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;">11</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> xzy
</span><span style="color: #008080;">12</span> <span style="color: #008000;"> * @date 2019-11-25 10:15
</span><span style="color: #008080;">13</span> <span style="color: #008000;"> * 说明：用于生成sort、pageable
</span><span style="color: #008080;">14</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;">15</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> PageableUtils {
</span><span style="color: #008080;">16</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">17</span> <span style="color: #008000;">     * Meta = {"sortColumn":"","sortDirection":"","pageNumber","","pageSize":""}
</span><span style="color: #008080;">18</span> <span style="color: #008000;">     * 排序字段、排序方向、页码、分页大小
</span><span style="color: #008080;">19</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">20</span>     <span style="color: #0000ff;">private</span> Map&lt;String, Object&gt; meta = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">21</span>     <span style="color: #0000ff;">private</span> String sortColumn = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">22</span>     <span style="color: #0000ff;">private</span> String sortDirection = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">23</span>     <span style="color: #0000ff;">private</span> Integer pageNumber = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">24</span>     <span style="color: #0000ff;">private</span> Integer pageSize = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">25</span> 
<span style="color: #008080;">26</span>     <span style="color: #0000ff;">public</span> Map&lt;String, Object&gt;<span style="color: #000000;"> getMeta() {
</span><span style="color: #008080;">27</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> meta;
</span><span style="color: #008080;">28</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">29</span> 
<span style="color: #008080;">30</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setMeta(Map&lt;String, Object&gt;<span style="color: #000000;"> meta) {
</span><span style="color: #008080;">31</span>         <span style="color: #0000ff;">this</span>.meta =<span style="color: #000000;"> meta;
</span><span style="color: #008080;">32</span>         <span style="color: #008000;">//</span><span style="color: #008000;">排序字段和排序方向必须同时指定，且值不能为null</span>
<span style="color: #008080;">33</span>         <span style="color: #0000ff;">if</span> (meta.containsKey("sortColumn") &amp;&amp; meta.get("sortColumn") != <span style="color: #0000ff;">null</span>
<span style="color: #008080;">34</span>                 &amp;&amp; meta.containsKey("sortDirection") &amp;&amp; meta.get("sortDirection") != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">35</span>             sortColumn = String.valueOf(meta.get("sortColumn"<span style="color: #000000;">));
</span><span style="color: #008080;">36</span>             sortDirection = String.valueOf(meta.get("sortDirection"<span style="color: #000000;">));
</span><span style="color: #008080;">37</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">38</span>         <span style="color: #0000ff;">if</span> (meta.containsKey("pageNumber") &amp;&amp; !"".equals(meta.get("pageNumber"<span style="color: #000000;">))
</span><span style="color: #008080;">39</span>                 &amp;&amp; meta.containsKey("pageSize") &amp;&amp; !"".equals(meta.get("pageSize"<span style="color: #000000;">))) {
</span><span style="color: #008080;">40</span>             pageNumber = Integer.parseInt(meta.get("pageNumber"<span style="color: #000000;">).toString());
</span><span style="color: #008080;">41</span>             pageSize = Integer.parseInt(meta.get("pageSize"<span style="color: #000000;">).toString());
</span><span style="color: #008080;">42</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">43</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">44</span> 
<span style="color: #008080;">45</span>     <span style="color: #0000ff;">public</span> PageableUtils(Map&lt;String, Object&gt;<span style="color: #000000;"> meta) {
</span><span style="color: #008080;">46</span> <span style="color: #000000;">        setMeta(meta);
</span><span style="color: #008080;">47</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">48</span> 
<span style="color: #008080;">49</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">50</span> <span style="color: #008000;">     * 获取排序条件
</span><span style="color: #008080;">51</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">52</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Sort getSort() {
</span><span style="color: #008080;">53</span>         Sort sort = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">54</span>         <span style="color: #008000;">//</span><span style="color: #008000;">确保排序字段有效,确保排序方向有效</span>
<span style="color: #008080;">55</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (StringUtils.isNullOrEmpty(sortColumn)) {
</span><span style="color: #008080;">56</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">57</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> ("ASC".equals(sortDirection) || "asc"<span style="color: #000000;">.equals(sortDirection)) {
</span><span style="color: #008080;">58</span>             sort = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Sort(Sort.Direction.ASC, sortColumn);
</span><span style="color: #008080;">59</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> ("DESC".equals(sortDirection) || "desc"<span style="color: #000000;">.equals(sortDirection)) {
</span><span style="color: #008080;">60</span>             sort = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Sort(Sort.Direction.DESC, sortColumn);
</span><span style="color: #008080;">61</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">62</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> sort;
</span><span style="color: #008080;">63</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">64</span> 
<span style="color: #008080;">65</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">66</span> <span style="color: #008000;">     * 获取分页条件
</span><span style="color: #008080;">67</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">68</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> sort - 排序条件
</span><span style="color: #008080;">69</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">70</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Pageable getPageable(Sort sort) {
</span><span style="color: #008080;">71</span> <span style="color: #000000;">        Pageable pageable;
</span><span style="color: #008080;">72</span>         <span style="color: #0000ff;">if</span> (pageNumber == <span style="color: #0000ff;">null</span> || pageSize == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">73</span>             pageable = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">74</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (sort != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">75</span>             pageable =<span style="color: #000000;"> PageRequest.of(pageNumber, pageSize, sort);
</span><span style="color: #008080;">76</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">77</span>             pageable =<span style="color: #000000;"> PageRequest.of(pageNumber, pageSize);
</span><span style="color: #008080;">78</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">79</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> pageable;
</span><span style="color: #008080;">80</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">81</span> 
<span style="color: #008080;">82</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Pageable getPageable() {
</span><span style="color: #008080;">83</span>         Sort sort =<span style="color: #000000;"> getSort();
</span><span style="color: #008080;">84</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> getPageable(sort);
</span><span style="color: #008080;">85</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">86</span> }</pre>
</div>
<p>PageableUtils.java工具类负责从参数中提取排序、分页条件</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.pantech.cloud.mlogistics.util;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.cloud.common.msg.Message;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.cloud.common.msg.MessageBox;
</span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.domain.Pageable;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.domain.Sort;
</span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.jpa.domain.Specification;
</span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.jpa.repository.JpaRepository;
</span><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.jpa.repository.JpaSpecificationExecutor;
</span><span style="color: #008080;">10</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.jpa.repository.support.SimpleJpaRepository;
</span><span style="color: #008080;">11</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.repository.Repository;
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Map;
</span><span style="color: #008080;">14</span> 
<span style="color: #008080;">15</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;">16</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> xzy
</span><span style="color: #008080;">17</span> <span style="color: #008000;"> * @date 2019-11-25 10:26
</span><span style="color: #008080;">18</span> <span style="color: #008000;"> * 说明：条件查询
</span><span style="color: #008080;">19</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;">20</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ConditionalQueryUtils&lt;T <span style="color: #0000ff;">extends</span> JpaRepository &amp; JpaSpecificationExecutor&gt;<span style="color: #000000;"> {
</span><span style="color: #008080;">21</span> 
<span style="color: #008080;">22</span>     <span style="color: #0000ff;">private</span> T repository = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">23</span> 
<span style="color: #008080;">24</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> T getRepository() {
</span><span style="color: #008080;">25</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> repository;
</span><span style="color: #008080;">26</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">27</span> 
<span style="color: #008080;">28</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setRepository(T repository) {
</span><span style="color: #008080;">29</span>         <span style="color: #0000ff;">this</span>.repository =<span style="color: #000000;"> repository;
</span><span style="color: #008080;">30</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">31</span> 
<span style="color: #008080;">32</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> ConditionalQueryUtils(T repository) {
</span><span style="color: #008080;">33</span>         <span style="color: #0000ff;">this</span>.repository =<span style="color: #000000;"> repository;
</span><span style="color: #008080;">34</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">35</span> 
<span style="color: #008080;">36</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">37</span> <span style="color: #008000;">     * 条件查询：多条件查询||排序查询||分页查询
</span><span style="color: #008080;">38</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">39</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> specification - 多条件查询条件
</span><span style="color: #008080;">40</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> meta          - 包含条件查询、分页查询条件
</span><span style="color: #008080;">41</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">42</span>     <span style="color: #0000ff;">public</span> Message findByConditions(Specification specification, Map&lt;String, Object&gt;<span style="color: #000000;"> meta) {
</span><span style="color: #008080;">43</span>         PageableUtils pageableUtils = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PageableUtils(meta);
</span><span style="color: #008080;">44</span>         <span style="color: #008000;">//</span><span style="color: #008000;">排序条件</span>
<span style="color: #008080;">45</span>         Sort sort =<span style="color: #000000;"> pageableUtils.getSort();
</span><span style="color: #008080;">46</span>         <span style="color: #008000;">//</span><span style="color: #008000;">分页条件</span>
<span style="color: #008080;">47</span>         Pageable pageable =<span style="color: #000000;"> pageableUtils.getPageable();
</span><span style="color: #008080;">48</span>         <span style="color: #008000;">/**</span>
<span style="color: #008080;">49</span> <span style="color: #008000;">         * 查询
</span><span style="color: #008080;">50</span>          <span style="color: #008000;">*/</span>
<span style="color: #008080;">51</span>         <span style="color: #0000ff;">if</span> (specification != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">52</span>             <span style="color: #008000;">//</span><span style="color: #008000;">1、多条件查询</span>
<span style="color: #008080;">53</span>             <span style="color: #0000ff;">if</span> (pageable != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">54</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">1.1多条件查询+排序查询+分页查询</span>
<span style="color: #008080;">55</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> MessageBox&lt;&gt;<span style="color: #000000;">(repository.findAll(specification, pageable));
</span><span style="color: #008080;">56</span>             } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">57</span>                 <span style="color: #0000ff;">if</span> (sort != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">58</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">1.2.1多条件查询+排序查询</span>
<span style="color: #008080;">59</span>                     <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> MessageBox&lt;&gt;<span style="color: #000000;">(repository.findAll(specification, sort));
</span><span style="color: #008080;">60</span>                 } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">61</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">1.2.2多条件查询</span>
<span style="color: #008080;">62</span>                     <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> MessageBox&lt;&gt;<span style="color: #000000;">(repository.findAll(specification));
</span><span style="color: #008080;">63</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">64</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">65</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">66</span>             <span style="color: #008000;">//</span><span style="color: #008000;">2、查询所有数据</span>
<span style="color: #008080;">67</span>             <span style="color: #0000ff;">if</span> (pageable != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">68</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">2.1查询所有数据+排序查询+分页查询</span>
<span style="color: #008080;">69</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> MessageBox&lt;&gt;<span style="color: #000000;">(repository.findAll(pageable));
</span><span style="color: #008080;">70</span>             } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">71</span>                 <span style="color: #0000ff;">if</span> (sort != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">72</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">2.2.1查询所有数据+排序查询</span>
<span style="color: #008080;">73</span>                     <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> MessageBox&lt;&gt;<span style="color: #000000;">(sort);
</span><span style="color: #008080;">74</span>                 } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">75</span>                     <span style="color: #008000;">//</span><span style="color: #008000;">2.2.2查询所有数据</span>
<span style="color: #008080;">76</span>                     <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> MessageBox&lt;&gt;<span style="color: #000000;">(repository.findAll());
</span><span style="color: #008080;">77</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">78</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">79</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">80</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">81</span> }</pre>
</div>
<p>使用说明：</p>
<p>1、Entity中包含参数</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">2</span> <span style="color: #008000;">     * 附加参数
</span><span style="color: #008080;">3</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">4</span> <span style="color: #000000;">    @Transient
</span><span style="color: #008080;">5</span> <span style="color: #000000;">    @JsonInclude(JsonInclude.Include.NON_DEFAULT)
</span><span style="color: #008080;">6</span>     <span style="color: #0000ff;">private</span> Map&lt;String, Object&gt; meta = <span style="color: #0000ff;">new</span> HashMap&lt;&gt;();</pre>
</div>
<p>2、Repository实现接口</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.pantech.cloud.mlogistics.repository.ina;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.cloud.mlogistics.entity.ina.WaybillReturnViewEntity;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.jpa.repository.JpaRepository;
</span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.jpa.repository.JpaSpecificationExecutor;
</span><span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 8</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> xzy
</span><span style="color: #008080;"> 9</span> <span style="color: #008000;"> * @date 2019-11-25 09:43
</span><span style="color: #008080;">10</span> <span style="color: #008000;"> * 说明：
</span><span style="color: #008080;">11</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;">12</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span> WaybillReturnViewRepository <span style="color: #0000ff;">extends</span> JpaRepository&lt;WaybillReturnViewEntity, String&gt;, JpaSpecificationExecutor&lt;WaybillReturnViewEntity&gt;<span style="color: #000000;"> {
</span><span style="color: #008080;">13</span> }</pre>
</div>
<p>使用例子：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.pantech.cloud.mlogistics.service.impl.ina;
</span><span style="color: #008080;">  2</span> 
<span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.mysql.jdbc.StringUtils;
</span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.cloud.common.msg.Message;
</span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.cloud.mlogistics.entity.ina.WaybillReturnViewEntity;
</span><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.cloud.mlogistics.repository.ina.WaybillReturnViewRepository;
</span><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.cloud.mlogistics.service.ina.WaybillReturnViewService;
</span><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.cloud.mlogistics.util.ConditionalQueryUtils;
</span><span style="color: #008080;">  9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.cloud.mlogistics.util.SpecificationFactory;
</span><span style="color: #008080;"> 10</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.beans.factory.annotation.Autowired;
</span><span style="color: #008080;"> 11</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.data.jpa.domain.Specification;
</span><span style="color: #008080;"> 12</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.stereotype.Service;
</span><span style="color: #008080;"> 13</span> 
<span style="color: #008080;"> 14</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.text.ParseException;
</span><span style="color: #008080;"> 15</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.text.SimpleDateFormat;
</span><span style="color: #008080;"> 16</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.ArrayList;
</span><span style="color: #008080;"> 17</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Date;
</span><span style="color: #008080;"> 18</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;
</span><span style="color: #008080;"> 19</span> 
<span style="color: #008080;"> 20</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 21</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> xzy
</span><span style="color: #008080;"> 22</span> <span style="color: #008000;"> * @date 2019-11-25 09:46
</span><span style="color: #008080;"> 23</span> <span style="color: #008000;"> * 说明：
</span><span style="color: #008080;"> 24</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 25</span> <span style="color: #000000;">@Service
</span><span style="color: #008080;"> 26</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> WaybillReturnViewServiceImpl <span style="color: #0000ff;">implements</span><span style="color: #000000;"> WaybillReturnViewService {
</span><span style="color: #008080;"> 27</span> 
<span style="color: #008080;"> 28</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> WaybillReturnViewRepository repository;
</span><span style="color: #008080;"> 29</span> 
<span style="color: #008080;"> 30</span> <span style="color: #000000;">    @Autowired
</span><span style="color: #008080;"> 31</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> dependenceInject(WaybillReturnViewRepository repository) {
</span><span style="color: #008080;"> 32</span>         <span style="color: #0000ff;">this</span>.repository =<span style="color: #000000;"> repository;
</span><span style="color: #008080;"> 33</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 34</span> 
<span style="color: #008080;"> 35</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 36</span> <span style="color: #008000;">     * 获取所有数据
</span><span style="color: #008080;"> 37</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 38</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;"> 39</span>     <span style="color: #0000ff;">public</span> List&lt;WaybillReturnViewEntity&gt;<span style="color: #000000;"> findAll() {
</span><span style="color: #008080;"> 40</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> repository.findAll();
</span><span style="color: #008080;"> 41</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 42</span> 
<span style="color: #008080;"> 43</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 44</span> <span style="color: #008000;">     * 多条件查询
</span><span style="color: #008080;"> 45</span> <span style="color: #008000;">     *
</span><span style="color: #008080;"> 46</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> conditions - 查询条件
</span><span style="color: #008080;"> 47</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> - 返回符合条件的数据
</span><span style="color: #008080;"> 48</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 49</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;"> 50</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Message findByConditions(WaybillReturnViewEntity conditions) {
</span><span style="color: #008080;"> 51</span>         Specification specification =<span style="color: #000000;"> getConditions(conditions);
</span><span style="color: #008080;"> 52</span>         ConditionalQueryUtils&lt;WaybillReturnViewRepository&gt; conditionUtils = <span style="color: #0000ff;">new</span> ConditionalQueryUtils&lt;&gt;<span style="color: #000000;">(repository);
</span><span style="color: #008080;"> 53</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> conditionUtils.findByConditions(specification, conditions.getMeta());
</span><span style="color: #008080;"> 54</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 55</span> 
<span style="color: #008080;"> 56</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 57</span> <span style="color: #008000;">     * 确认查询条件
</span><span style="color: #008080;"> 58</span> <span style="color: #008000;">     *
</span><span style="color: #008080;"> 59</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> conditions - 包含查询条件的实体
</span><span style="color: #008080;"> 60</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> - 查询条件
</span><span style="color: #008080;"> 61</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 62</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Specification getConditions(WaybillReturnViewEntity conditions) {
</span><span style="color: #008080;"> 63</span>         List&lt;Specification&gt; specificationList = <span style="color: #0000ff;">new</span> ArrayList&lt;&gt;<span style="color: #000000;">();
</span><span style="color: #008080;"> 64</span>         Specification specification = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 65</span> 
<span style="color: #008080;"> 66</span>         <span style="color: #008000;">//</span><span style="color: #008000;">主单号</span>
<span style="color: #008080;"> 67</span>         <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">StringUtils.isNullOrEmpty(conditions.getMainBill())) {
</span><span style="color: #008080;"> 68</span>             specificationList.add(SpecificationFactory.equal("mainBill"<span style="color: #000000;">, conditions.getMainBill()));
</span><span style="color: #008080;"> 69</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 70</span>         <span style="color: #008000;">//</span><span style="color: #008000;">分单号</span>
<span style="color: #008080;"> 71</span>         <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">StringUtils.isNullOrEmpty(conditions.getHawbBill())) {
</span><span style="color: #008080;"> 72</span>             specificationList.add(SpecificationFactory.equal("hawbBill"<span style="color: #000000;">, conditions.getHawbBill()));
</span><span style="color: #008080;"> 73</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 74</span>         <span style="color: #008000;">//</span><span style="color: #008000;">退货客户</span>
<span style="color: #008080;"> 75</span>         <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">StringUtils.isNullOrEmpty(conditions.getCustomerName())) {
</span><span style="color: #008080;"> 76</span>             specificationList.add(SpecificationFactory.equal("customerName"<span style="color: #000000;">, conditions.getCustomerName()));
</span><span style="color: #008080;"> 77</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 78</span>         <span style="color: #0000ff;">if</span> (conditions.getMeta().containsKey("returnDateLeft") &amp;&amp; !"".equals(conditions.getMeta().get("returnDateLeft"<span style="color: #000000;">).toString())) {
</span><span style="color: #008080;"> 79</span>             Date returnDateLeft = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 80</span>             <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
</span><span style="color: #008080;"> 81</span>                 SimpleDateFormat dateFormat = <span style="color: #0000ff;">new</span> SimpleDateFormat("yyyy-MM-dd HH:mm:ss"<span style="color: #000000;">);
</span><span style="color: #008080;"> 82</span>                 returnDateLeft = dateFormat.parse(conditions.getMeta().get("returnDateLeft"<span style="color: #000000;">).toString());
</span><span style="color: #008080;"> 83</span>             } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (ParseException e) {
</span><span style="color: #008080;"> 84</span> <span style="color: #000000;">                e.printStackTrace();
</span><span style="color: #008080;"> 85</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 86</span>             specificationList.add(SpecificationFactory.greaterOrEqual("returnDate"<span style="color: #000000;">, (Date) returnDateLeft));
</span><span style="color: #008080;"> 87</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 88</span>         <span style="color: #0000ff;">if</span> (conditions.getMeta().containsKey("returnDateRight") &amp;&amp; !"".equals(conditions.getMeta().get("returnDateRight"<span style="color: #000000;">).toString())) {
</span><span style="color: #008080;"> 89</span>             Date returnDateRight = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 90</span>             <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
</span><span style="color: #008080;"> 91</span>                 SimpleDateFormat dateFormat = <span style="color: #0000ff;">new</span> SimpleDateFormat("yyyy-MM-dd HH:mm:ss"<span style="color: #000000;">);
</span><span style="color: #008080;"> 92</span>                 returnDateRight = dateFormat.parse(conditions.getMeta().get("returnDateRight"<span style="color: #000000;">).toString());
</span><span style="color: #008080;"> 93</span>             } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (ParseException e) {
</span><span style="color: #008080;"> 94</span> <span style="color: #000000;">                e.printStackTrace();
</span><span style="color: #008080;"> 95</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 96</span>             specificationList.add(SpecificationFactory.smallerOrEqual("returnDate"<span style="color: #000000;">, returnDateRight));
</span><span style="color: #008080;"> 97</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 98</span> 
<span style="color: #008080;"> 99</span>         <span style="color: #0000ff;">for</span><span style="color: #000000;"> (Specification spec : specificationList) {
</span><span style="color: #008080;">100</span>             <span style="color: #0000ff;">if</span> (specification == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">101</span>                 specification =<span style="color: #000000;"> spec;
</span><span style="color: #008080;">102</span>             } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">103</span>                 specification =<span style="color: #000000;"> specification.and(spec);
</span><span style="color: #008080;">104</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">105</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">106</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> specification;
</span><span style="color: #008080;">107</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">108</span> }</pre>
</div>
<p>请求参数：</p>
<p><img id="uploading_image_77509" src="https://common.cnblogs.com/images/loading.gif" alt="" /></p>
<p>&nbsp;</p>]]></description></item><item><title>二叉树</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/23/11916950.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 23 Nov 2019 03:36:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/23/11916950.html</guid><description><![CDATA[<h1><span style="font-family: 宋体;"><span style="font-family: 宋体;"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191123101420702-601504964.png" alt="" width="500" /></span></span></h1>
<h1><span style="font-family: 宋体;">1、树结构常见概念</span></h1>
<p>&nbsp;</p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="color: #0000ff;">度</span>：结点拥有的子树的数量被称作结点的度。</span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="color: #0000ff;">叶子结点</span>：度为零的结点被称作叶子节点，也叫终端结点。</span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="color: #0000ff;">分支结点</span>：树中除了叶子结点以外的其他结点被称作分支结点，也叫非终端结点。</span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="color: #0000ff;">根结点</span>：根结点是特殊的分支结点，根结点没有父结点。</span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="color: #0000ff;">树的度</span>：树内部各结点度的最大值被称作树的度。</span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="color: #0000ff;">树的高度</span>：树中结点的最大层次被称为树的高度，也叫树的深度。</span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="color: #0000ff;">有序树</span>：如果将树中结点的子树看作从左到右有序（即不可交换），则称该树是有序树。</span></p>
<h1><span style="font-family: 宋体;">2、二叉树的定义</span></h1>
<p><span style="font-family: 仿宋; font-size: 18pt;">&nbsp; 二叉树是一种特殊的有序树，树中的结点的度数不大于2，即树中的结点最多只有两棵子树。</span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><img style="display: block; margin-left: auto; margin-right: auto; vertical-align: top;" title="二叉树的5种基本形态" src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191123103214762-1730224595.png" alt="二叉树的5种基本形态" /></span></p>
<p>&nbsp;</p>
<p style="text-align: center;"><span style="color: #0000ff;">二叉树的5种基本形态</span></p>
<p>&nbsp;</p>
<h1><span style="font-family: 宋体;">3、二叉树的性质</span></h1>
<p><span style="font-family: 仿宋; font-size: 18pt;"><strong>性质1 &nbsp;</strong><span style="color: #0000ff;">二叉树第i层最多有2<sup>i-1</sup>个结点（i&gt;=1）</span></span></p>
<p><span style="font-family: 仿宋; font-size: 18px;">&nbsp; 等比数列通项公式：a<sub>n = </sub>a<sub>1&middot;</sub>q<sup>n-1</sup></span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><strong>性质2</strong>&nbsp; <span style="color: #0000ff;">高度为h的二叉树最多有2<sup>h </sup>-1个结点（h&gt;=1）</span></span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;">&nbsp; <span style="font-size: 18px;">等比数列求和公式：S<sub>n </sub>= a<sub>1</sub>(1-q<sup>n</sup>)/(1-q) </span></span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><strong>性质3</strong>&nbsp; <span style="color: #0000ff;">对任何一棵二叉树，n<sub>0</sub> = n<sub>2</sub> + 1</span>（n<sub>0</sub>、n<sub>1</sub>、n<sub>2分别表示树中度为0、1、2的结点的数量</sub>）</span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;">&nbsp; <span style="font-size: 18px;">①结点总数：</span></span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="font-size: 18px;">&nbsp;&nbsp;&nbsp; 树的结点总数n = n<sub>0</sub> + n<sub>1</sub> + n<sub>2</sub></span></span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="font-size: 18px;">&nbsp;&nbsp; ②分支总数：</span></span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="font-size: 18px;">&nbsp;&nbsp;&nbsp; 树的分支总数 = n - 1 = n<sub>1</sub> + 2n<sub>2&nbsp; </sub>=&gt; n = <span style="font-size: 18px;">n<sub>1</sub> + 2n<sub>2</sub></span> + 1</span></span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="font-size: 18px;">&nbsp;&nbsp; （树中除了根结点，其他所有结点都有一个分支进入，所以树的分支总数等于结点总数减1；又因为所有的分支都是由度为1和度为2的结点射出，所有树的分支总数又等于<span style="font-family: 仿宋; font-size: 18pt;"><span style="font-size: 18px;">n<sub>1</sub> + 2n<sub>2</sub></span></span>）</span></span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;"><span style="font-size: 18px;">&nbsp;&nbsp; 由①②得：<span style="font-family: 仿宋; font-size: 18pt;">n<sub>0</sub> = n<sub>2</sub> + 1</span></span></span></p>
<h1>&nbsp;</h1>
<h1><span style="font-family: 宋体;">4、特殊二叉树</span></h1>
<p><span style="font-family: 宋体;"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191123112756002-2121267833.png" alt="" /></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;"></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 仿宋; font-size: 18pt;">&nbsp; 满度二叉树和完全二叉树是两种特殊形态的二叉树。</span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;">&nbsp; 若二叉树的高度为h，且树的总结点数为2<sup>h</sup> - 1,则称该二叉树为<span style="color: #0000ff;">满二叉树</span>，也称满度二叉树，该树的特点是，每一层的节点数都达到最大值。</span></p>
<p><span style="font-family: 仿宋; font-size: 18pt;">&nbsp; 对于深度为K的，有n个结点的二叉树，当且仅当其每一个结点都与深度为K的满二叉树中编号从1至n的结点一一对应时称之为<span style="color: #0000ff;">完全二叉树</span>。</span></p>
<h1>&nbsp;</h1>
<p>&nbsp;</p>]]></description></item><item><title>Java函数式接口与Lambda表达式</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/17/11876759.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sun, 17 Nov 2019 07:42:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/17/11876759.html</guid><description><![CDATA[<p>什么是函数式接口？</p>
<p>&nbsp;&nbsp;&nbsp; 函数式接口是一种特殊的接口，接口中只有一个抽象方法。</p>
<p>函数式接口与Lambda表达式有什么关系？</p>
<p>&nbsp;&nbsp;&nbsp; 当需要一个函数式接口的对象时，可以提供一个lambda表达式。</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> learnspringboot.xiao.learnjava;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 4</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> xzy
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;"> * @date 2019-11-17 15:24
</span><span style="color: #008080;"> 6</span> <span style="color: #008000;"> * 说明：函数式接口
</span><span style="color: #008080;"> 7</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 8</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> FunctionalInterface {
</span><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">void</span><span style="color: #000000;"> aFunction(Object... args);
</span><span style="color: #008080;">10</span> }</pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> learnspringboot.xiao;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> learnspringboot.xiao.learnjava.FunctionalInterface;
</span><span style="color: #008080;"> 4</span> 
<span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.ArrayList;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Arrays;
</span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Comparator;
</span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;
</span><span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;">11</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> 肖政宇
</span><span style="color: #008080;">12</span> <span style="color: #008000;"> * @date 2019-10-23 16:22
</span><span style="color: #008080;">13</span> <span style="color: #008000;"> * 说明：
</span><span style="color: #008080;">14</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;">15</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> MainFunction {
</span><span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
</span><span style="color: #008080;">18</span>         FunctionalInterface functionalInterface = <span style="background-color: #00ff00;">(objects) -&gt;<span style="color: #000000;"> {
</span></span><span style="color: #008080;">19</span>             <span style="background-color: #00ff00;"><span style="color: #0000ff;">for</span><span style="color: #000000;"> (Object o : objects) {
</span><span style="color: #008080;">20</span> <span style="color: #000000;">                System.out.println(o.toString());
</span><span style="color: #008080;">21</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">22</span><span style="color: #000000;">         };
</span></span><span style="color: #008080;">23</span>         <strong>functionalInterface.aFunction("123", "456", "aaa"<span style="color: #000000;">);
</span></strong><span style="color: #008080;">24</span> 
<span style="color: #008080;">25</span>         functionalInterface = <span style="background-color: #ffff00;">(objects) -&gt;<span style="color: #000000;"> {
</span></span><span style="color: #008080;">26</span>            <span style="background-color: #ffff00;"> <span style="color: #0000ff;">double</span> total = 0<span style="color: #000000;">;
</span><span style="color: #008080;">27</span>             <span style="color: #0000ff;">for</span><span style="color: #000000;"> (Object o : objects) {
</span><span style="color: #008080;">28</span>                 total +=<span style="color: #000000;"> Double.valueOf(o.toString());
</span><span style="color: #008080;">29</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">30</span> <span style="color: #000000;">            System.out.println(total);
</span><span style="color: #008080;">31</span> <span style="color: #000000;">        };
</span></span><span style="color: #008080;">32</span>         <strong>functionalInterface.aFunction(1,2<span style="color: #000000;">);
</span></strong><span style="color: #008080;">33</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">34</span> }</pre>
</div>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191117154039099-1863988594.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>对象克隆</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/16/11872002.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 16 Nov 2019 07:37:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/16/11872002.html</guid><description><![CDATA[<p><span style="font-size: 16px;">&nbsp;&nbsp;&nbsp; 在C++中，有一个特殊的构造函数叫做拷贝构造函数，用于解决对象间浅层拷贝存在的问题。</span></p>
<p><span style="font-size: 16px;">&nbsp;&nbsp;&nbsp; C++中每一个类会有一个默认的拷贝构造函数，使用默认的拷贝构造函数实现的是对象的浅层拷贝，大致的工作就是将一个对象的&ldquo;<span style="color: #0000ff;">成员属性</span>&rdquo;值逐一复制到另外一个对象。默认的拷贝构造函数能够满足大多数的使用需求，但如果类的成员属性中含有指针变量，使用默认的拷贝构造函数就会出现<span style="color: #ff0000;">&ldquo;指针悬挂&rdquo;</span>的问题。</span></p>
<p><span style="font-size: 16px;">&nbsp;&nbsp;&nbsp; 什么是指针悬挂？简单的说是这么个情况：某个类A的成员属性中含有指针变量p，通过默认的拷贝构造函数由对象a1创建一个对象a2，由于默认的拷贝构造函数实现的是数值的简单复制，所以最终对象a1和a2的指针变量将具有相同的数值，即指向相同的内存空间，如果某个对象将这个空间释放，另一个对象并不知情，继续使用这个空间......</span></p>
<hr />
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 16px;">&nbsp;&nbsp;&nbsp; Java中没有指针变量，也存在类似的问题。</span></p>]]></description></item><item><title>使用回调的方式实现定时任务</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/16/11871922.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 16 Nov 2019 07:17:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/16/11871922.html</guid><description><![CDATA[<p>&nbsp; 回调（callback）是一种常见的程序设计模式。在这种模式中，可以指定某个特定事件发生时应该采取的动作。例如，当某种资源被释放时，应该唤醒因这个资源而被挂起的任务。</p>
<p>&nbsp; 在java.swing包中有一个Timer类，可以使用它在到达给定的时间间隔发出通知。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('37f7dca5-fbe4-45a3-b6c3-c02084329f88')"><img id="code_img_closed_37f7dca5-fbe4-45a3-b6c3-c02084329f88" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_37f7dca5-fbe4-45a3-b6c3-c02084329f88" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('37f7dca5-fbe4-45a3-b6c3-c02084329f88',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_37f7dca5-fbe4-45a3-b6c3-c02084329f88" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> learnspringboot.xiao;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.Timer;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.awt.event.ActionEvent;
</span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.awt.event.ActionListener;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span> java.util.*<span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 9</span> <span style="color: #008000;"> * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> 肖政宇
</span><span style="color: #008080;">10</span> <span style="color: #008000;"> * @date 2019-10-23 16:22
</span><span style="color: #008080;">11</span> <span style="color: #008000;"> * 说明：
</span><span style="color: #008080;">12</span>  <span style="color: #008000;">*/</span>
<span style="color: #008080;">13</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainFunction <span style="color: #0000ff;">implements</span><span style="color: #000000;"> ActionListener {
</span><span style="color: #008080;">14</span> 
<span style="color: #008080;">15</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">16</span> <span style="color: #008000;">     * Invoked when an action occurs.
</span><span style="color: #008080;">17</span> <span style="color: #008000;">     *
</span><span style="color: #008080;">18</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> e - 该参数提供了事件的相关信息，例如事件的源对象。
</span><span style="color: #008080;">19</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">20</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> actionPerformed(ActionEvent e) {
</span><span style="color: #008080;">22</span>         System.out.println(<span style="color: #0000ff;">new</span><span style="color: #000000;"> Date());
</span><span style="color: #008080;">23</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">24</span> 
<span style="color: #008080;">25</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
</span><span style="color: #008080;">26</span>         ActionListener actionListener = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MainFunction();
</span><span style="color: #008080;">27</span>         <span style="color: #0000ff;">int</span> delay = 1000<span style="color: #000000;">;
</span><span style="color: #008080;">28</span>         Timer timer = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Timer(delay, actionListener);
</span><span style="color: #008080;">29</span> <span style="color: #000000;">        timer.start();
</span><span style="color: #008080;">30</span>         <span style="color: #0000ff;">while</span> (<span style="color: #0000ff;">true</span><span style="color: #000000;">) {
</span><span style="color: #008080;">31</span> 
<span style="color: #008080;">32</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">33</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">34</span> }</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191116151607582-1670974775.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp; 在构建定时器时，设置一个时间间隔，并告知计时器，每一次时间间隔到达的时候需要做哪些事情。</p>]]></description></item><item><title>事务</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/13/11853335.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 13 Nov 2019 13:29:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/13/11853335.html</guid><description><![CDATA[<p><span style="font-size: 18pt;">1、事务</span></p>
<p><span style="font-size: 18px;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="font-size: 18px;">事务是用户定义的一个<span style="color: #0000ff;">数据库操作序列</span>，这些操作<span style="color: #0000ff;">要么全做，要么全不做</span>，事务是一个不可分割的工作单位。在关系数据库中，一个事务可以是一条SQL语句、一组SQL语句。</span></p>
<p><span style="font-size: 18px;">&nbsp; &nbsp; &nbsp; 事务的开始和结束可以由用户显式控制，也可以由系统自动划分。在SQL中，定义事务的语句一般有三条：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">begin</span> <span style="color: #0000ff;">transaction</span><span style="color: #000000;">；//开始事务
</span><span style="color: #008080;">2</span> 
<span style="color: #008080;">3</span> <span style="color: #0000ff;">commit</span><span style="color: #000000;">；//结束事务：提交
</span><span style="color: #008080;">4</span> 
<span style="color: #008080;">5</span> <span style="color: #0000ff;">rollback</span>；//结束事务：回滚</pre>
</div>
<p><span style="font-size: 18px;">&nbsp; 事务通常由begin transaction开始，以commit或rollback结束。commit表示提交，即提交事务的操作，具体的说就是将事务中对数据库的更新写回到磁盘上的物理数据库中去，事务正常结束。rollback表示回滚，即所有已完成的操作全部撤销，回滚到事务开始前的状态。</span></p>
<hr />
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">2、事务的ACID特性</span></p>
<p><span style="font-size: 18px;">&nbsp; 事务具有4个特性：原子性、一致性、隔离性、持续性（Atomicity、Consistency、Isolation、Durability）</span></p>
<p><span style="font-size: 18px;">（1）原子性</span></p>
<p><span style="font-size: 18px;">&nbsp; 事务是数据库的<span style="color: #0000ff;">逻辑工作单位</span>，事务中包含的操作要么都做，要么不做。例如，某银行中有A1和A2两个账户，由A1向A2转账就是一个事务：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">A1账户扣除1w元；
A2账户增加1w元；</span></pre>
</div>
<p><span style="font-size: 18px;">A1账户扣除1w元的操作和A2账户增加1w元的操作只能全做或全部做。</span></p>
<p><span style="font-size: 18px;">（2）一致性</span></p>
<p><span style="font-size: 18px;">&nbsp; 事务的执行结果必须是使数据库从一个一致性状态变到另一个一致性状态。当数据库只包含成功事务提交的结果时，就称数据库处于一致性状态。事务的原子性保证了事务的一致性。</span></p>
<p><span style="font-size: 18px;">（3）隔离性</span></p>
<p><span style="font-size: 18px;">&nbsp; 事务与事务之间相互独立，互不干扰。<span style="color: #0000ff;">一个事务内部操作和使用的数据对其他事务应该是隔离的</span>，并发执行的事务之间不能相互干扰。</span></p>
<p><span style="font-size: 18px;">（4）持续性</span></p>
<p><span style="font-size: 18px;">&nbsp; 持续性也称永久性，指的是一个事务一旦提交，它对数据库中数据的改变就应该时永久的。</span></p>]]></description></item><item><title>交叉并发、同时并发</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/13/11853046.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 13 Nov 2019 12:42:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/13/11853046.html</guid><description><![CDATA[<ul>
<li>交叉并发
<div>&nbsp;</div>
<div>在单处理器系统中，多个任务的并发执行其实是多个任务的轮流交叉执行。</div>
<div>&nbsp;</div>
</li>
<li>同时并发</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在多处理器系统中，单个处理器可以处理一个任务，多个处理器可以同时处理多个任务，从而实现真正的多任务并发执行。</p>]]></description></item><item><title>浅析Java hashCode()方法</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/09/11826995.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 09 Nov 2019 09:31:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/09/11826995.html</guid><description><![CDATA[<p><strong>&nbsp; 散列码</strong>（hash code）是<span style="color: #0000ff; font-size: 18px;">由对象导出的一个整数值</span>。</p>
<p>&nbsp; 散列码没有规律，两个不同的对象x和y，x.hashCode()与y.hashCode()基本上不会相同。</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
</span><span style="color: #008080;">2</span>         String str1 = "HELLO WORLD!"<span style="color: #000000;">;
</span><span style="color: #008080;">3</span>         String str2 = "hello world!"<span style="color: #000000;">;
</span><span style="color: #008080;">4</span> <span style="color: #000000;">        System.out.println(str1.hashCode());
</span><span style="color: #008080;">5</span> <span style="color: #000000;">        System.out.println(str2.hashCode());
</span><span style="color: #008080;">6</span>     }</pre>
</div>
<p>&nbsp; 上面的代码输出两个字符串的散列码：</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191109165901557-1441097933.png" alt="" /></p>
<p>&nbsp;</p>
<p>String 类中计算散列码的源码如下：</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191109171736059-1825118468.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp; 可以看出，<span style="color: #0000ff; font-size: 18px;">字符串的散列码是由内容导出的</span>。</p>
<hr />
<p>&nbsp;</p>
<p>&nbsp; <strong>Object类是所有类的父类，hashCode()方法定义在Object类中，因此每一个类都有一个默认的计算对象散列码的方法，</strong></p>
<p><strong>使用默认的方法计算对象的散列码得到的值是对象的存储地址。</strong></p>
<p>&nbsp;</p>
<p><strong>&nbsp; </strong>如果在子类中重新定义equals()方法，必须重新定义hashCode()方法，如果x.equals(y)放回true，那么x.hashCode()就必须与y.hashCode()具有相同的值。</p>
<p>例如Student.equals()通过学生ID比较对象，那么hashCode()就需要基于ID生成散列码。</p>
<p>&nbsp; </p>
<p>&nbsp; hashCode()方法应该返回一个整数值（可以是负数），并合理地组合实体域的散列码，以便让各个不同的对象产生的散列码分布的更加均匀。</p>
<p>&nbsp; 一个比较好的生成方法是：</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191109172900536-125902469.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp; 调用Objects.hash()方法，这个方法会对各个参数调用Objects.hashCode()方法，然后组合各个参数的散列值。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>Spring MVC 请求处理过程</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/04/11791767.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Mon, 04 Nov 2019 06:12:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/04/11791767.html</guid><description><![CDATA[<p><strong>1、</strong></p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191104140549208-2090079967.png" alt="" width="602" height="434" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr />
<p><strong>&nbsp;2、</strong></p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191104140640429-259556939.png" alt="" width="569" height="459" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<p><strong>3、</strong></p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191104140703015-183432750.png" alt="" width="738" height="408" /></p>
<hr />
<p>&nbsp;</p>
<p><strong>4、</strong></p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191104140731219-989243335.png" alt="" width="670" height="374" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<p><strong>5、</strong></p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191104140752207-2077610685.png" alt="" width="710" height="323" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr />
<p>6、</p>
<p><img src="https://img2018.cnblogs.com/i-beta/1689384/201911/1689384-20191104140815661-378431102.png" alt="" width="777" height="413" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>]]></description></item><item><title>Java字符串比较</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/02/11783964.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 02 Nov 2019 12:39:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/11/02/11783964.html</guid><description><![CDATA[<p>&nbsp; 一定不要使用==运算符检测两个字符串是否相等！这个运算符<strong><span style="color: #ff0000;">只能确定两个字符串是否放置在同一个位置上</span></strong>。当然，如果字符串放置在同一个位置上，它们必然相等。但<strong><span style="color: #ff0000;">内容相同的多个字符串完全有可能被拷贝放置在不同的位置上</span></strong>。</p>
<p>&nbsp; 如果虚拟机始终将相同的字符串共享，就可以使用==运算符检测字符串是否相等。但实际上<strong><span style="color: #ff0000;">只有字符串常量才是共享的</span></strong>，而<strong><span style="color: #ff0000;">通过+号拼接产生或者substring等操作产生的字符串并不是共享的</span></strong>。因此使用==比较字符串是不可靠的，相当于在程序中埋下一颗炸弹，是不是产生令人头疼的BUG。</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp; 可以使用<span style="color: #0000ff;"><strong>equals()</strong></span>方法检测两个字符串是否相等。</p>
<div class="cnblogs_code">
<pre>stringA.equals(stringB);</pre>
</div>
<div class="cnblogs_code">
<pre>"Hello".equals("Hello");</pre>
</div>
<p>&nbsp; 如果想要忽略大小写的区别，可以使用<strong><span style="color: #0000ff;">equalsIgnoreCase()</span></strong>方法。</p>]]></description></item><item><title>SQL MAX()函数处理字符型字段</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/31/11774173.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 31 Oct 2019 14:07:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/31/11774173.html</guid><description><![CDATA[<p>&nbsp; 假设有数据库表student，表中有字段studentCode，它是<span style="color: #ff0000;">字符型</span>的，现有需求：&ldquo;每次向student表插入数据时，自动生成studentCode字段的值&rdquo;</p>
<hr />
<p>&nbsp;</p>
<p>&nbsp; 如果你的实现思路是这样的：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">if</span><span style="color: #000000;">(student表为空){
    待插入数据studentCode字段的值设置为1;
}</span><span style="color: #0000ff;">else</span><span style="color: #000000;">{
    查询出表中studentCode字段的最大值max;
    待插入数据studentCode字段的值设置为max</span>+1<span style="color: #000000;">;
}
将数据插入student表;</span></pre>
</div>
<p>&nbsp; 你可能使用以下SQL语句查询studentCode字段的最大值:</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">SELECT</span> <span style="color: #ff00ff;">MAX</span>(studentCode) <span style="color: #0000ff;">FROM</span> `student`</pre>
</div>
<p>&nbsp; 测试一下程序，试着插入几条数据：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> 插入第1条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">1</span>
<span style="color: #008080;"> 2</span> 插入第2条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">2</span>
<span style="color: #008080;"> 3</span> 插入第3条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">3</span>
<span style="color: #008080;"> 4</span> 插入第4条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">4</span>
<span style="color: #008080;"> 5</span> 插入第5条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">5</span>
<span style="color: #008080;"> 6</span> 插入第6条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">6</span>
<span style="color: #008080;"> 7</span> 插入第7条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">7</span>
<span style="color: #008080;"> 8</span> 插入第8条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">8</span>
<span style="color: #008080;"> 9</span> 插入第9条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">9</span>
<span style="color: #008080;">10</span> 插入第10条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">10</span>
<span style="color: #008080;">11</span> 插入第11条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">10</span>
<span style="color: #008080;">12</span> 插入第12条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">10</span>
<span style="color: #008080;">13</span> 插入第13条数据：studentCode <span style="color: #808080;">==</span> <span style="color: #800000; font-weight: bold;">10</span></pre>
</div>
<p>&nbsp; 最开始插入前10条数据studentCode字段的值还是正常的，可是从第11条数据开始，为什么studentCode字段的值全不变了呢？</p>
<p>&nbsp; 原因就是studentCode字段是字符型的，从指定第11条数据的插入操作开始，<span style="color: #0000ff;">SELECT <span style="color: #ff00ff;">MAX(studentCode) <span style="color: #0000ff;">FROM `student`</span></span></span> 的结果将永远是9，所以就导致了最终设置的studentCode的值永远是10.</p>
<p>&nbsp; 解决办法：类型转换</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">SELECT</span> <span style="color: #ff00ff;">MAX</span>(<span style="color: #ff00ff;">CONVERT</span>(studentCode,<span style="color: #0000ff;">INT</span>)) <span style="color: #0000ff;">FROM</span> `student`</pre>
</div>]]></description></item><item><title>Java 解析Exception信息</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/30/11766220.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 30 Oct 2019 09:16:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/30/11766220.html</guid><description><![CDATA[<p>最近的项目需要捕获系统抛出的异常，并将异常信息保存，记录以下解析Exception的方法。</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<ul>
<li><span style="font-size: 18pt;"><strong>异常详细信息</strong></span>
<div>这里说的&ldquo;异常详细信息&rdquo;指的是平时打印到控制台的那种信息，如下图</div>
</li>
</ul>
<div><img src="https://img2018.cnblogs.com/blog/1689384/201910/1689384-20191030171143662-1689305468.png" alt="" />
<p>&nbsp;</p>
<p>获取方法：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.pantech.boot.common.systemlog.util;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.ByteArrayOutputStream;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.IOException;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.PrintStream;

</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> 肖政宇
 * @date 2019-10-30 11:11
 * 说明：异常解析
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ExceptionInformation {

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 异常解析
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> String getExceptionInformation(Exception exception) {
        ByteArrayOutputStream outputStream </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> ByteArrayOutputStream();
        PrintStream printStream </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> PrintStream(outputStream);
        exception.printStackTrace(printStream);

        String exceptionInformation </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> String(outputStream.toByteArray());
        printStream.close();
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            outputStream.close();
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException e) {
            e.printStackTrace();
        }
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> exceptionInformation;
    }
}</span></pre>
</div>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
</div>
<ul>
<li><span style="font-size: 18pt;"><strong>异常具体信息</strong></span></li>
</ul>
<p><span style="font-size: 14px;">这里说的异常具体信息指的是，具体的某一项信息，比如异常从哪个类抛出、异常用哪个方法抛出、产生异常的代码在第几行</span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.pantech.boot.module.log.serviceimpl;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.boot.common.systemlog.SystemException;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.boot.common.systemlog.util.ExceptionInformation;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.boot.common.systemlog.util.IpAddress;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.boot.module.log.entity.SystemExceptionLogEntity;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.boot.module.log.entity.SystemOperationLogEntity;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.boot.module.log.repository.SystemExceptionLogRepository;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.pantech.boot.module.log.service.SystemExceptionLogService;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.slf4j.Logger;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.slf4j.LoggerFactory;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.beans.factory.annotation.Autowired;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.stereotype.Service;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;

</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> 肖政宇
 * @date 2019-10-29 17:06
 * 说明：系统异常记录
 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
@Service
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> SystemExceptionLogServiceImpl <span style="color: #0000ff;">implements</span><span style="color: #000000;"> SystemExceptionLogService {
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> Logger logger = LoggerFactory.getLogger(SystemExceptionLogServiceImpl.<span style="color: #0000ff;">class</span><span style="color: #000000;">);

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> SystemExceptionLogRepository repository;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> IpAddress ipAddress;

    @Autowired
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setRepository(SystemExceptionLogRepository repository) {
        </span><span style="color: #0000ff;">this</span>.repository =<span style="color: #000000;"> repository;
    }

    @Autowired
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setIpAddress(IpAddress ipAddress) {
        </span><span style="color: #0000ff;">this</span>.ipAddress =<span style="color: #000000;"> ipAddress;
    }

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 保存一条系统异常
     *
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> systemExceptionLog - 异常信息
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    @Override
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> SystemExceptionLogEntity save(SystemExceptionLogEntity systemExceptionLog) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> repository.save(systemExceptionLog);
    }

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 用于手动添加异常日志
     *
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> e - 异常类型
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    @Override
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> SystemExceptionLogEntity exceptionLog(Exception e) {
        </span><span style="color: #008000;">/**</span><span style="color: #008000;">
         * 1、解析异常信息
         </span><span style="color: #008000;">*/</span>
        <span style="color: #008000;">//</span><span style="color: #008000;">获取异常栈首个元素，用以解析异常部分信息</span>
        StackTraceElement stackTraceElement = e.getStackTrace()[0<span style="color: #000000;">];
        </span><span style="color: #008000;">//</span><span style="color: #008000;">异常类型</span>
        String exceptionType =<span style="color: #000000;"> e.toString();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">异常抛出于某个类</span>
        String className =<span style="color: #000000;"> stackTraceElement.getClassName();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">异常抛出于某个方法</span>
        String methodName =<span style="color: #000000;"> stackTraceElement.getMethodName();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">异常抛出于第几行</span>
        <span style="color: #0000ff;">int</span> lineNumber =<span style="color: #000000;"> stackTraceElement.getLineNumber();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">异常抛出地点详细信息</span>
        String throwPlace = className + "." + methodName + "[" + lineNumber + "]"<span style="color: #000000;">;
        </span><span style="color: #008000;">//</span><span style="color: #008000;">异常详细信息</span>
        String content =<span style="color: #000000;"> ExceptionInformation.getExceptionInformation(e);
        String[] con </span>= content.split("\n"<span style="color: #000000;">);
        </span><span style="color: #0000ff;">if</span> (con.length &gt; 50<span style="color: #000000;">) {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">保存前50行</span>
            StringBuilder stringBuilder = <span style="color: #0000ff;">new</span><span style="color: #000000;"> StringBuilder();
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 0; i &lt; 50; i++<span style="color: #000000;">) {
                stringBuilder.append(con[i]);
                stringBuilder.append(</span>"\n"<span style="color: #000000;">);
            }
            content </span>=<span style="color: #000000;"> stringBuilder.toString();
        }
        </span><span style="color: #008000;">//</span><span style="color: #008000;">ip地址</span>
        String ip =<span style="color: #000000;"> ipAddress.getIpAddress();
        </span><span style="color: #008000;">/**</span><span style="color: #008000;">
         * 2、保存异常信息到数据库
         </span><span style="color: #008000;">*/</span><span style="color: #000000;">
        SystemExceptionLogEntity systemExceptionLog </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> SystemExceptionLogEntity();
        systemExceptionLog.setExceptionType(exceptionType);
        systemExceptionLog.setIpAddress(ip);
        systemExceptionLog.setThrowPlace(throwPlace);
        systemExceptionLog.setContent(content);
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">.save(systemExceptionLog);
    }
}</span></pre>
</div>
<p>&nbsp;</p>]]></description></item><item><title>如何根据HttpServletRequets获取用户真实IP地址</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/30/11766127.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 30 Oct 2019 09:06:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/30/11766127.html</guid><description><![CDATA[<p>　　最近的一个项目的某个功能获取用户的ip地址，添加用户的系统使用记录。</p>
<p>　　我发现当我<span style="color: #ff0000;">直接使用getRemoteAddr<span style="font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">()</span>方法从HttpServletRequet中获取用户的ip时，获取到的是服务器的ip地址</span>，为什么会这样呢？</p>
<hr />
<p>&nbsp;</p>
<p>网上找到的<span style="font-size: 18px;"><strong><span style="color: #0000ff;">答案</span></strong></span>：</p>
<p>　　　　&ldquo;<span style="color: #0000ff;" data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">当我们通过request获取客户端IP时，自身服务器通常会为了保护信息或者负载均衡的目的，对自身服务器做反向代理。此时如果我们通过request.getRemoteAddr();可能获取到的是自身代理服务器的IP，而无法达到获取用户请求ip的目的。</span>&rdquo;</p>
<hr />
<p>&nbsp;</p>
<p>最终的<strong><span style="color: #0000ff; font-size: 18px;">解决方案</span></strong>：</p>
<p>　　<span data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">以下整理了各个代理服务器自己开发的转发服务请求头，这些请求头都不是标准的http请求头，不一定所有的代理都会带上这些请求头，所以通过这方式只能尽可能的获取到真实ip，但不能保证一定可以获取到真实ip，而且代理服务器请求头中获取的ip是可伪造的。</span></p>
<p data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">参数：</p>
<table border="0">
<tbody>
<tr>
<td><span class="token p">nginx服务代理</span></td>
<td><span class="token p">X-Real-IP</span></td>
</tr>
<tr>
<td><span class="token p">Squid 服务代理</span></td>
<td><span class="token p">X-Forwarded-For</span></td>
</tr>
<tr>
<td><span class="token p">apache 服务代理</span></td>
<td><span class="token p">Proxy-Client-IP</span></td>
</tr>
<tr>
<td><span class="token p">weblogic 服务代理</span></td>
<td><span class="token p">WL-Proxy-Client-IP</span></td>
</tr>
<tr>
<td><span class="token p"><span class="token lf"><span class="token p"><span class="token lf"><span class="token p"><span class="token lf"><span class="token p"><span class="token em"><span class="token md md-em md-start"><span class="token md md-em md-close">有些代理服务器</span></span></span></span></span></span></span></span></span></span></td>
<td><span class="token p"><span class="token lf"><span class="token p"><span class="token lf"><span class="token p"><span class="token lf"><span class="token p">HTTP<span class="token em"><span class="token md md-em md-start">_CLIENT<span class="token md md-em md-close">_IP</span></span></span></span></span></span></span></span></span></span></td>
</tr>
</tbody>
</table>
<p data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">以下是获取用户真实ip的工具类：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.pantech.boot.common.systemlog.util;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.beans.factory.annotation.Autowired;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.stereotype.Component;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.http.HttpServletRequest;

</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> 肖政宇
 * @date 2019-10-29 13:41
 * 说明：客户端ip地址相关操作
 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
@Component
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> IpAddress {

    @Autowired
    HttpServletRequest request;

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 获取发送请求的客户端的ip地址
     *
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> request - 请求头
     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> - ip地址
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span><span style="color: #000000;"> String getIpAddress(HttpServletRequest request) {
        String ip </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;

        </span><span style="color: #008000;">//</span><span style="color: #008000;">X-Forwarded-For：Squid 服务代理</span>
        String ipAddresses = request.getHeader("X-Forwarded-For"<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;">X-Real-IP：nginx服务代理</span>
        <span style="color: #0000ff;">if</span> (ipAddresses == <span style="color: #0000ff;">null</span> || ipAddresses.length() == 0 || "unknown"<span style="color: #000000;">.equalsIgnoreCase(ipAddresses)) {
            ipAddresses </span>= request.getHeader("X-Real-IP"<span style="color: #000000;">);
        }

        </span><span style="color: #008000;">//</span><span style="color: #008000;">Proxy-Client-IP：apache 服务代理</span>
        <span style="color: #0000ff;">if</span> (ipAddresses == <span style="color: #0000ff;">null</span> || ipAddresses.length() == 0 || "unknown"<span style="color: #000000;">.equalsIgnoreCase(ipAddresses)) {
            ipAddresses </span>= request.getHeader("Proxy-Client-IP"<span style="color: #000000;">);
        }

        </span><span style="color: #008000;">//</span><span style="color: #008000;">WL-Proxy-Client-IP：weblogic 服务代理</span>
        <span style="color: #0000ff;">if</span> (ipAddresses == <span style="color: #0000ff;">null</span> || ipAddresses.length() == 0 || "unknown"<span style="color: #000000;">.equalsIgnoreCase(ipAddresses)) {
            ipAddresses </span>= request.getHeader("WL-Proxy-Client-IP"<span style="color: #000000;">);
        }

        </span><span style="color: #008000;">//</span><span style="color: #008000;">HTTP_CLIENT_IP：有些代理服务器</span>
        <span style="color: #0000ff;">if</span> (ipAddresses == <span style="color: #0000ff;">null</span> || ipAddresses.length() == 0 || "unknown"<span style="color: #000000;">.equalsIgnoreCase(ipAddresses)) {
            ipAddresses </span>= request.getHeader("HTTP_CLIENT_IP"<span style="color: #000000;">);
        }

        </span><span style="color: #008000;">//</span><span style="color: #008000;">有些网络通过多层代理，那么获取到的ip就会有多个，一般都是通过逗号（,）分割开来，并且第一个ip为客户端的真实IP</span>
        <span style="color: #0000ff;">if</span> (ipAddresses != <span style="color: #0000ff;">null</span> &amp;&amp; ipAddresses.length() != 0<span style="color: #000000;">) {
            ip </span>= ipAddresses.split(",")[0<span style="color: #000000;">];
        }

        </span><span style="color: #008000;">//</span><span style="color: #008000;">还是不能获取到，最后再通过request.getRemoteAddr();获取</span>
        <span style="color: #0000ff;">if</span> (ip == <span style="color: #0000ff;">null</span> || ip.length() == 0 || "unknown"<span style="color: #000000;">.equalsIgnoreCase(ipAddresses)) {
            ip </span>=<span style="color: #000000;"> request.getRemoteAddr();
        }
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ip;
    }

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String getIpAddress() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> getIpAddress(request);
    }
}</span></pre>
</div>
<p>&nbsp;</p>
<p>文中提到的解决方案原文地址：<a href="https://www.cnblogs.com/Mauno/p/Mauno.html">https://www.cnblogs.com/Mauno/p/Mauno.html </a></p>]]></description></item><item><title>SpringBoot拦截器没有生效的原因</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/30/11765986.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 30 Oct 2019 08:53:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/30/11765986.html</guid><description><![CDATA[<p>　　最近的一个项目中，需要实现一个记录系统请求日志的功能，我通过拦截器实现了这个功能，但是，测试的时候发现拦截器没有发挥作用，检查了很久，没有发现错的地方，系统也没有报错，最终在网上找打了答案。</p>
<p>&nbsp;　　<img src="https://img2018.cnblogs.com/blog/1689384/201910/1689384-20191030164743355-2079386876.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;原来之前已经有在系统中创建了一个继承自WebMvcConfigurationSupport的配置类，所以我的配置类没有生效。</p>]]></description></item><item><title>视图</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/29/11761821.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Tue, 29 Oct 2019 13:52:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/29/11761821.html</guid><description><![CDATA[<p>&nbsp; 视图是从一张或几张基本表或视图导出的表。它与基本表不同，是一个<span style="color: #0000ff;">虚表</span>。</p>
<p>&nbsp; 之所以说视图是虚表，因为数据库中只存放视图的定义，不存放视图对应的数据，这些数据依旧存放在原来的基本表中。所以一旦基本表中的数据发生了变化，从视图中查询出的数据也就随之改变。从这个意义上讲，视图就像一个窗口，透过它可以看到数据库中自己感兴趣的数据及其变化。</p>
<ul>
<li><strong>创建视图</strong></li>
</ul>
<p>&nbsp; SQL语句创建视图的一般格式为：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">view</span> <span style="color: #808080;">&lt;</span>视图名<span style="color: #808080;">&gt;</span><span style="color: #ff0000;">[</span><span style="color: #ff0000;">列名1,列名2,......</span><span style="color: #ff0000;">]</span>
<span style="color: #0000ff;">as</span> <span style="color: #808080;">&lt;</span>子查询<span style="color: #808080;">&gt;</span>
<span style="color: #ff0000;">[</span><span style="color: #ff0000;">with check option</span><span style="color: #ff0000;">]</span></pre>
</div>
<p>&nbsp; 关系数据库管理系统执行创建视图的SQL语句的结果是，将视图的定义存入数据字典，并不执行其中的子查询。只有在对视图进行查询时，才会按照视图定义中的子查询从基本表中将数据查询出来。</p>
<p>&nbsp; 关系数据库管理系统执行对视图的查询时，首先进行有效性检查，检查查询中涉及的表、视图是否存在。如果存在，则从数据字典中取出视图的定义，把定义中的子查询和用户查询结合起来，转换成等价的对基本表的查询，然后再执行修正了的查询。这一过程称为<span style="color: #0000ff;">视图消解</span>（view resolution）</p>
<ul>
<li><strong>视图的作用</strong></li>
</ul>
<p>1、简化用户操作</p>
<p>2、使不同的用户以不同的角度看待数据</p>
<p>3、对重构数据库提供了一定程度的逻辑独立性</p>
<p>4、对数据提供一定程度的保护</p>
<p>5、使用视图能够更加清晰的表达查询</p>]]></description></item><item><title>“数据库系统的出现使信息系统从以加工数据的应用程序为中心转向围绕共享的数据库为中心的新阶段”</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/27/11748483.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sun, 27 Oct 2019 10:32:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/27/11748483.html</guid><description><![CDATA[<p>　　这是书中的原话，读起来有些生涩，需要认真的去理解。</p>
<ul>
<li><span style="color: #ff0000;">&ldquo;以加工数据的程序为中心&rdquo;</span></li>
</ul>
<p>　　在数据库系统还没有被设计出来的时候，应用程序想要存储数据，需要负责数据存储结构的设计，需要自行将数据保存到存储空间，应用程序如果想要读取数据，需要自行从存储空间寻找并读取数据，然后应用程序还要自行对数据进行解析。</p>
<p>　　回想自己大一那会，写了一个&ldquo;推箱子&rdquo;，还没学数据库，我是怎么对游戏记录进行保存和读取的呢？</p>
<p>　　保存：新建/打开一个文件，将数据保存到文件，关闭文件。</p>
<p>　　读取：打开数据存储文件，读取数据。</p>
<ul>
<li><span style="color: #ff0000;">&ldquo;围绕共享的数据库为中心&rdquo;</span></li>
</ul>
<p>　　自从有了数据库系统，数据由数据库系统集中维护，应用程序能够更加专注于实现核心业务的逻辑。</p>
<p>　　</p>
<p>　　如果你有很多很多很多的书，如果需要你自己来管理这写书，你可能需要考虑，怎样存储这些更方便找书，怎样存储这些书更节省空间，如果有专门有人帮你管理这些书，以上问题就不需要由你来考虑，你将有更多的精力去做更重要的事情。</p>]]></description></item><item><title>数据库、数据库管理系统、数据库系统</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/27/11748418.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sun, 27 Oct 2019 10:06:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/27/11748418.html</guid><description><![CDATA[<ul>
<li><strong>数据库</strong></li>
</ul>
<p>　　<span style="color: #0000ff;">数据库是长期存储在计算机内、有组织、可共享的大量数据的集合</span>。概括的说数据库数据具有永久存储、有组织和可共享三个基本特点。</p>
<ul>
<li><strong>数据库管理系统</strong></li>
</ul>
<p>　　数据库管理系统是实现科学管理数据的一个<span style="color: #0000ff;">系统软件</span>。数据库管理系统是位于用户和操作系统之间的一层数据管理软件。数据库管理系统和操作系统一样是计算机的基础软件，也是一个大型复杂的软件系统。</p>
<ul>
<li><strong>数据库系统</strong></li>
</ul>
<p>　　数据库系统是<span style="color: #0000ff;">由数据库、数据库管理系统、应用程序和数据库管理员组成</span>的存储、管理、处理和维护数据的系统。</p>]]></description></item><item><title>“数据的含义和数据的语义不可分”</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/27/11748400.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sun, 27 Oct 2019 09:58:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/27/11748400.html</guid><description><![CDATA[<p>可以对数据做如下定义：</p>
<p>　　<strong><span style="color: #0000ff;">描述事物的符号记录称为数据</span></strong>。</p>
<p>　　描述事物的符号可以是数字，也可以是文字、图像、声音、视频等，数据的表现形式多种多样，它们都可以经过数字化后存入计算机。</p>
<p>　　数据的表现形式还不能完全表达其内容，需要经过解释，数据和关于数据的解释是不可分的。例如，93是一个数据，它可以是一个同学某门课程的成绩，也可以是某个同学的体重。数据的解释是指对数据含义的说明，数据的含义称为数据的语义，<strong><span style="color: #0000ff;">数据与其语义是不可分的</span></strong>。</p>]]></description></item><item><title>Java 自增、自减</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/17/11692110.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 17 Oct 2019 07:01:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/17/11692110.html</guid><description><![CDATA[<p><span style="font-size: 18px;"><strong>i++/i--</strong></span></p>
<p>　　先使用变量的值，然后改变该变量的值；</p>
<p><strong><span style="font-size: 18px;">++i/--</span>i</strong></p>
<p>　　先改变该变量的值，然后使用变量的值；</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;" data-darkreader-inline-color="">学习Java的时候没有思考过java中变量自增的原理，今天遇到一道java题目，有点懵：<br />int</span> i = <span style="color: #800080;" data-darkreader-inline-color="">0</span><span style="color: #000000;" data-darkreader-inline-color="">；
i </span>= i++;</pre>
</div>
<p>　　最终变量i的值到底是变成1呢还是保持为0呢？</p>
<p>　　java中变量自增、自减的实现其实使用了一个临时中间变量作为缓存。</p>
<p>以i++为例：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;" data-darkreader-inline-color="">1</span>     <span style="color: #0000ff;" data-darkreader-inline-color="">public</span> <span style="color: #0000ff;" data-darkreader-inline-color="">static</span> <span style="color: #0000ff;" data-darkreader-inline-color="">void</span><span style="color: #000000;" data-darkreader-inline-color=""> main(String[] args) {
</span><span style="color: #008080;" data-darkreader-inline-color="">2</span>         <span style="color: #0000ff;" data-darkreader-inline-color="">int</span> i = 0<span style="color: #000000;" data-darkreader-inline-color="">;
</span><span style="color: #008080;" data-darkreader-inline-color="">3</span>         <span style="color: #0000ff;" data-darkreader-inline-color="">int</span> j = i++<span style="color: #000000;" data-darkreader-inline-color="">;
</span><span style="color: #008080;" data-darkreader-inline-color="">4</span>     }</pre>
</div>
<p>以上代码其实相当于：</p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff;" data-darkreader-inline-color="">public</span> <span style="color: #0000ff;" data-darkreader-inline-color="">static</span> <span style="color: #0000ff;" data-darkreader-inline-color="">void</span><span style="color: #000000;" data-darkreader-inline-color=""> main(String[] args) {
        </span><span style="color: #0000ff;" data-darkreader-inline-color="">int</span> i = 0<span style="color: #000000;" data-darkreader-inline-color="">;
        </span><span style="color: #0000ff;" data-darkreader-inline-color="">int</span> temp =<span style="color: #000000;" data-darkreader-inline-color=""> i;
        i </span>+= 1<span style="color: #000000;" data-darkreader-inline-color="">;
        </span><span style="color: #0000ff;" data-darkreader-inline-color="">int</span> j =<span style="color: #000000;" data-darkreader-inline-color=""> temp;
    }</span></pre>
</div>
<p>所以，i = i++的结果是i的值为保持不变。</p>
<pre>public static void main(String[] args) {<br />    int i = 0;<br />    i = i++;<br />}<br /><br />其实等于</pre>
<pre>public static void main(String[] args) {<br />    int i = 0;<br />    int temp = i;<br />    i += 1;<br />    i = temp;<br />}</pre>
<p>&nbsp;</p>]]></description></item><item><title>实体对象中，避免使用基本数据类型</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/16/11684042.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 16 Oct 2019 02:40:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/16/11684042.html</guid><description><![CDATA[<p>在创建与数据库表映射的实体类时，应该避免使用基本数据类型，最好采用包装类型代替。</p>]]></description></item><item><title>列表</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/13/11666234.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sun, 13 Oct 2019 05:43:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/13/11666234.html</guid><description><![CDATA[<p>1、列表和链表</p>
<p>　　列表是一种数据结构，是一种<span style="color: #0000ff;">概念性</span>表示法，链表是一种具体的实现策略，列表和栈、队列一样可以用数组和链表实现。</p>
<p>2、栈、队列、列表</p>
<p>　　列表和栈与队列一样，是一种线性结构，但列表更加一般，栈和队列只能在集合末端进行元素的增加和删除，<span style="color: #000000;">列表可以在集合<span style="color: #0000ff;">中间和末端</span>进行元素的增加和删除。</span></p>
<p>　　此外列表含有3种类型：</p>
<ul>
<li><strong>有序列表：</strong>其元素按照元素的某种内在特性进行排序。</li>
<li><strong>无序列表：</strong>其元素不具有内在顺序，元素按照它们在列表中的位置进行排序。</li>
<li><strong>索引列表：</strong>其元素可以使用数字索引来使用。</li>
</ul>
<p>　　有序列表是<span style="color: #0000ff;">基于列表中元素的某种特性进行排序</span>的，添加新元素时会根据元素的特性确定元素在列表中应该存储的位置。</p>
<p>　　无序列表中各元素的位置并不基于元素的任何特性，但<span style="color: #0000ff;">不要被其名字误导</span>，&ldquo;无序&rdquo;指的是不按照元素的任何特性进行排序，而不是指序列是无序的，事实上序列中的元素是按照特殊顺序放置的，只不过这种顺序与元素本身无关&mdash;&mdash;列表的使用者或决定元素的顺序。</p>
<p>　　与无序列表类似，索引列表中的元素不按照任何元素特性进行排列，元素在列表中的位置由使用者决定。不过，列表中的每一个元素都能通过一个数字索引值进行引用。是否觉得索引列表和数组很像？注意，<span style="color: #0000ff;">索引列表和数组最根本的区别</span>在于：索引列表的索引值总是连续的，索引列表中的元素是&ldquo;挨着&rdquo;的，如果删除了列表中的一个元素，列表中其他元素的位置会进行调整，以消除删除元素带来的空位置。</p>
<p>　　　　</p>]]></description></item><item><title>Spring MVC拦截器配置</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/10/11647078.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 10 Oct 2019 03:51:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/10/11647078.html</guid><description><![CDATA[<h1 align="center"><strong>Spring MVC<span style="font-family: 宋体;">拦截器配置</span></strong></h1>
<h3>（1）<strong><span style="font-family: 宋体;">自定义拦截器</span></strong></h3>
<pre><span style="color: #cc7832;">package learnspringboot.xiao.other<span style="color: #cc7832;">;<br /><span style="color: #cc7832;"><br /><span style="color: #cc7832;">import org.springframework.web.servlet.ModelAndView<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">import org.springframework.web.servlet.handler.HandlerInterceptorAdapter<span style="color: #cc7832;">;<br /><span style="color: #cc7832;"><br /><span style="color: #cc7832;">import javax.servlet.http.HttpServletRequest<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">import javax.servlet.http.HttpServletResponse<span style="color: #cc7832;">;<br /><span style="color: #cc7832;"><br /><span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;"> * <span style="color: #629755; font-weight: bold; font-style: italic;">@author <span style="color: #629755; font-style: italic;">肖政宇<br /><span style="color: #629755; font-style: italic;"> * <span style="color: #629755; font-weight: bold; font-style: italic;">@date <span style="color: #629755; font-style: italic;">2019-10-10 11:01<br /><span style="color: #629755; font-style: italic;"> * 说明：拦截器实例<br /><span style="color: #629755; font-style: italic;"> * 拦截器能够在处理每一个请求的前后做一些事情。<br /><span style="color: #629755; font-style: italic;"> * 可以让普通的Bean事项HandlerInterceptor接口<span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #cc7832;"><span style="color: #629755; font-style: italic;"><span style="color: #629755; font-style: italic;"><span style="color: #629755; font-weight: bold; font-style: italic;"><span style="color: #629755; font-style: italic;"><span style="color: #629755; font-style: italic;"><span style="color: #629755; font-weight: bold; font-style: italic;"><span style="color: #629755; font-style: italic;"><span style="color: #629755; font-style: italic;"><span style="color: #629755; font-style: italic;"><span style="color: #629755; font-style: italic;"><span style="color: #629755; font-style: italic;">或者继承HandlerInterceptorAdapter类来实现自定义的拦截器。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="color: #629755; font-style: italic;"><br /><span style="color: #629755; font-style: italic;"> * 拦截器需要在配置类中注册。<br /><span style="color: #629755; font-style: italic;"> */<br /><span style="color: #cc7832;">public class DemoInterceptor <span style="color: #cc7832;">extends HandlerInterceptorAdapter <span style="color: #9876aa; font-style: italic;">{<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * 本拦截器实现的功能：计算每一次请求的处理时间<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;"><br /><span style="color: #629755; font-style: italic;">    /**<br /><span style="color: #629755; font-style: italic;">     * 在控制器处理web请求前执行的工作<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #bbb529;">@Override<br /><span style="color: #bbb529;">    <span style="color: #cc7832;">public boolean <span style="color: #ffc66d;">preHandle<span style="color: #9876aa; font-style: italic;">(HttpServletRequest request<span style="color: #cc7832;">, HttpServletResponse response<span style="color: #cc7832;">, Object handler<span style="color: #9876aa; font-style: italic;">) <span style="color: #cc7832;">throws Exception <span style="color: #9876aa; font-style: italic;">{<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #808080;">//1、获取接收到请求时的系统时间，即开始处理请求的时间<br /><span style="color: #808080;">        <span style="color: #cc7832;">long startTime = System.<span style="font-style: italic;">currentTimeMillis<span style="color: #9876aa; font-style: italic;">()<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        <span style="color: #808080;">//2、将时间保存的request体中<br /><span style="color: #808080;">        request.setAttribute<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">"startTime"<span style="color: #cc7832;">, startTime<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        return super.preHandle<span style="color: #9876aa; font-style: italic;">(request<span style="color: #cc7832;">, response<span style="color: #cc7832;">, handler<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * 在控制器处理web请求后执行的工作<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #bbb529;">@Override<br /><span style="color: #bbb529;">    <span style="color: #cc7832;">public void <span style="color: #ffc66d;">postHandle<span style="color: #9876aa; font-style: italic;">(HttpServletRequest request<span style="color: #cc7832;">, HttpServletResponse response<span style="color: #cc7832;">, Object handler<span style="color: #cc7832;">, ModelAndView modelAndView<span style="color: #9876aa; font-style: italic;">) <span style="color: #cc7832;">throws Exception <span style="color: #9876aa; font-style: italic;">{<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #808080;">//1、从request体中取出之前存进去的&ldquo;处理本次请求的开始时间&rdquo;<br /><span style="color: #808080;">        <span style="color: #cc7832;">long startTime = <span style="color: #9876aa; font-style: italic;">(Long<span style="color: #9876aa; font-style: italic;">) request.getAttribute<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">"startTime"<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        request.removeAttribute<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">"startTime"<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        <span style="color: #808080;">//2、获取当前系统时间，即处理完当前请求的时间<br /><span style="color: #808080;">        <span style="color: #cc7832;">long endTime = System.<span style="font-style: italic;">currentTimeMillis<span style="color: #9876aa; font-style: italic;">()<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        <span style="color: #808080;">//3、计算得出处理本次请求的总时间<br /><span style="color: #808080;">        <span style="color: #cc7832;">long totalTime = endTime - startTime<span style="color: #cc7832;">;<br /><span style="color: #cc7832;"><br /><span style="color: #cc7832;">        System.<span style="color: #9876aa; font-style: italic;">out.println<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">"本次请求的处理时常：" + totalTime<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        request.setAttribute<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">"totalTime"<span style="color: #cc7832;">, totalTime<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        super.postHandle<span style="color: #9876aa; font-style: italic;">(request<span style="color: #cc7832;">, response<span style="color: #cc7832;">, handler<span style="color: #cc7832;">, modelAndView<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<h3>（2）<strong><span style="font-family: 宋体;">注册拦截器</span></strong></h3>
<p>&nbsp;</p>
<pre><span style="color: #cc7832;">package learnspringboot.xiao.other<span style="color: #cc7832;">;<br /><span style="color: #cc7832;"><br /><span style="color: #cc7832;">import org.springframework.context.annotation.<span style="color: #bbb529;">Bean<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">import org.springframework.context.annotation.<span style="color: #bbb529;">Configuration<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">import org.springframework.web.servlet.config.annotation.<span style="color: #bbb529;">EnableWebMvc<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">import org.springframework.web.servlet.config.annotation.InterceptorRegistry<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">import org.springframework.web.servlet.config.annotation.WebMvcConfigurer<span style="color: #cc7832;">;<br /><span style="color: #cc7832;"><br /><span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;"> * <span style="color: #629755; font-weight: bold; font-style: italic;">@author <span style="color: #629755; font-style: italic;">肖政宇<br /><span style="color: #629755; font-style: italic;"> * <span style="color: #629755; font-weight: bold; font-style: italic;">@date <span style="color: #629755; font-style: italic;">2019-10-10 11:06<br /><span style="color: #629755; font-style: italic;"> * 说明：注册拦截器<br /><span style="color: #629755; font-style: italic;"> */<br /><span style="color: #bbb529;">@Configuration<br /><span style="color: #bbb529;">@EnableWebMvc<br /><span style="color: #cc7832;">public class InterceptorConfig <span style="color: #cc7832;">implements WebMvcConfigurer <span style="color: #9876aa; font-style: italic;">{<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * 显式声明Bean<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #bbb529;">@Bean<br /><span style="color: #bbb529;">    <span style="color: #cc7832;">public DemoInterceptor <span style="color: #ffc66d;">demoInterceptor<span style="color: #9876aa; font-style: italic;">() {<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #cc7832;">return new DemoInterceptor<span style="color: #9876aa; font-style: italic;">()<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * 注册拦截器<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #bbb529;">@Override<br /><span style="color: #bbb529;">    <span style="color: #cc7832;">public void <span style="color: #ffc66d;">addInterceptors<span style="color: #9876aa; font-style: italic;">(InterceptorRegistry registry<span style="color: #9876aa; font-style: italic;">) {<br /><span style="color: #9876aa; font-style: italic;">        registry.addInterceptor<span style="color: #9876aa; font-style: italic;">(demoInterceptor<span style="color: #9876aa; font-style: italic;">())<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<h3>（3）<strong><span style="font-family: 宋体;">测试</span></strong></h3>
<p><strong><span style="font-family: 宋体;"><img style="vertical-align: middle; display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/blog/1689384/201910/1689384-20191010114309541-283347735.png" alt="" width="1000" /></span></strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p style="text-align: center;"><strong><span style="font-family: 宋体;">图1 运行程序</span></strong></p>
<p>&nbsp;</p>
<p style="text-align: center;"><strong><span style="font-family: 宋体;"><strong><span style="font-family: 宋体;"><img src="https://img2018.cnblogs.com/blog/1689384/201910/1689384-20191010114808681-1592035508.png" alt="" /></span></strong></span></strong></p>
<p>&nbsp;</p>
<p style="text-align: center;">&nbsp;</p>
<p style="text-align: center;"><strong><span style="font-family: 宋体;"><strong><span style="font-family: 宋体;">图2 发送请求</span></strong></span></strong></p>
<p style="text-align: center;">&nbsp;</p>
<p><strong><span style="font-family: 宋体;"><strong><span style="font-family: 宋体;"><strong><span style="font-family: 宋体;"><strong><span style="font-family: 宋体;"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/blog/1689384/201910/1689384-20191010114906114-1209230100.png" alt="" width="1000" /></span></strong></span></strong></span></strong></span></strong></p>
<p style="text-align: center;">图3 拦截器工作结果</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p style="text-align: center;">&nbsp;</p>
<p>&nbsp;</p>
<p style="text-align: center;">&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>]]></description></item><item><title>Spring MVC常用注解</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/10/11646204.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 10 Oct 2019 02:21:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/10/11646204.html</guid><description><![CDATA[<h1 align="center"><strong>Spring MVC <span style="font-family: 宋体;">常用注解</span></strong></h1>
<h2>（1）<strong>@Controller</strong></h2>
<p>　　@Controller<span style="font-family: 宋体;">注解在类上，表明这个类是</span><span style="font-family: Calibri;">SpringMVC</span><span style="font-family: 宋体;">中的</span><span style="font-family: Calibri;">Controller</span><span style="font-family: 宋体;">，将其声明为</span><span style="font-family: Calibri;">Spring</span><span style="font-family: 宋体;">的一个</span><span style="font-family: Calibri;">Bean</span><span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">Dispatcher Servlet</span><span style="font-family: 宋体;">会自动扫描此注解标注的类，并将</span><span style="font-family: Calibri;">Web</span><span style="font-family: 宋体;">请求映射到使用</span><span style="font-family: Calibri;">@RequestMapping</span><span style="font-family: 宋体;">注解的方法上。</span></p>
<h2>（2）<strong>@ResponseBody</strong></h2>
<p>　　@ResponseBody<span style="font-family: 宋体;">支持将返回值放在</span><span style="font-family: Calibri;">response</span><span style="font-family: 宋体;">体内，而不是返回一个页面。此注解能够帮助我们实现前后端分离，此注解标注的方法返回数据而不是页面；此注解可以放置在返回值前或者方法上。</span></p>
<h2>（3）<strong>@RestController</strong></h2>
<p>　　@RestController<span style="font-family: 宋体;">注解是一个组合注解，组合了</span><span style="font-family: Calibri;">@Controller</span><span style="font-family: 宋体;">和</span><span style="font-family: Calibri;">@ResponseBody</span><span style="font-family: 宋体;">，这意味着当我们在前后端分离的项目中，可以使用此注解标注类，否则，或者使用</span><span style="font-family: Calibri;">@Controller</span><span style="font-family: 宋体;">和</span><span style="font-family: Calibri;">@ResponseBody</span><span style="font-family: 宋体;">。</span></p>
<p align="center">&nbsp;<img src="https://img2018.cnblogs.com/blog/1689384/201910/1689384-20191010101940281-773443056.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>（4）<strong>@RequestBody</strong></h2>
<p>　　@RequestBody<span style="font-family: 宋体;">允许将请求参数放在</span><span style="font-family: Calibri;">request</span><span style="font-family: 宋体;">体中，而不是直接放在请求地址后面。此注解放在参数前。</span></p>
<h2>（5）<strong>@RequestMapping</strong></h2>
<p>　　@RequestMapping<span style="font-family: 宋体;">注解用于映射</span><span style="font-family: Calibri;">Web</span><span style="font-family: 宋体;">请求（访问路径和参数）、处理类和方法。此注解可以置于类或方法上。置于在方法上的注解的路径会继承置于类上的注解的路径，即如果在类上有注解</span><span style="font-family: Calibri;">@RequestMapping(</span>&ldquo;test/&rdquo;)<span style="font-family: 宋体;">，在方法上有注解</span><span style="font-family: Calibri;">@RequestMapping(</span>&ldquo;hello&rdquo;)<span style="font-family: 宋体;">，相当于在方法上有注解</span><span style="font-family: Calibri;">@RequestMapping(</span>&ldquo;test/hello&rdquo;)<span style="font-family: 宋体;">。</span></p>
<h2>（6）<strong>@GetMapping</strong></h2>
<p>　　@GetMapping<span style="font-family: 宋体;">相当于</span><span style="font-family: Calibri;">@RequestMapping(method = RequestMethod.GET)</span><span style="font-family: 宋体;">，即如下两个用法是等价的：</span></p>
<p align="center"><img src="https://img2018.cnblogs.com/blog/1689384/201910/1689384-20191010101952216-1087237487.png" alt="" /></p>
<p>&nbsp;</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/blog/1689384/201910/1689384-20191010101957531-2046619375.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">　　从</span>@GetMapping<span style="font-family: 宋体;">注解的源码看：</span></p>
<p align="center"><img src="https://img2018.cnblogs.com/blog/1689384/201910/1689384-20191010102007969-312197581.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="center">&nbsp;</p>
<h2>（7）<strong>@PostMapping</strong></h2>
<p>　　@PostMapping<span style="font-family: 宋体;">相当于</span><span style="font-family: Calibri;">@RequestMapping(method = RequestMethod.POST)</span><span style="font-family: 宋体;">。</span></p>
<p><span style="font-family: 宋体;">　　注解的源码：</span></p>
<p align="center"><img src="https://img2018.cnblogs.com/blog/1689384/201910/1689384-20191010102015074-979216949.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="center">&nbsp;</p>
<h2><strong>@PathVariable</strong></h2>
<p>　　@PathVariable<span style="font-family: 宋体;">用于接收路径参数，此注解置于参数前。</span></p>
<p>&nbsp;</p>]]></description></item><item><title>SQL预处理</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/09/11644565.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 09 Oct 2019 13:40:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/09/11644565.html</guid><description><![CDATA[<p>　　每向数据库发送一条SQL语句，数据库中的SQL解释器就会将SQL语句转换成数据库底层命令，然后执行该命令完成相关的数据库操作。如果频繁的向数据库提交SQL语句，势必会增加数据库中SQL解释器的负担，进而影响数据库的性能。</p>
<p>　　对于JDBC，可以通过Connection对象的preparedStatement(String sql)方法对SQL语句进行预处理，生成数据库底层的内部命令，并将该命令封装在PreparedStatement对象中。通过调用该对象的相应方法，可以执行这些内部命令。也就是说，应用程序能够针对连接的数据库，将SQL语句解释成对应数据库的底层命令，然后让数据库执行这个命令，这样能够减轻数据库的负担，提高访问数据库的速度。</p>]]></description></item><item><title>浅析用链表实现的队列</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/04/11622977.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Fri, 04 Oct 2019 11:49:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/10/04/11622977.html</guid><description><![CDATA[<p>队列与栈一样是一种线性集合，队列与栈的不同之处在于，队列需要在两端进行操作，在用链表实现的队列中，需要在表头和表尾进行操作。</p>
<p>&nbsp;</p>
<p><span style="color: #0000ff;"><strong>思考一下，在链表实现的队列中，入队和出队操作在表头和表尾进行有什么差异？</strong></span>（假设链表为单链表，head指向链表头节点，end指向链表尾节点）</p>
<p>&nbsp;</p>
<p>先考虑入队操作，<span style="color: #ff0000;">入队操作在链表头和链表尾进行操作都不会复杂</span>:</p>
<div class="cnblogs_code">
<pre>newNode.next =<span style="color: #000000;"> head;
head </span>=<span style="color: #000000;"> newNode; 

newNode.next </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;
end.next </span>= newNode;</pre>
</div>
<p>&nbsp;</p>
<p>继续考虑出队操作，如果出队操作在链表头进行：</p>
<div class="cnblogs_code">
<pre>newNode =<span style="color: #000000;"> head;
head </span>=<span style="color: #000000;"> head.next;
</span><span style="color: #0000ff;">return</span> newNode.data</pre>
</div>
<p><span style="color: #ff0000;">如果出队操作在链表尾进行就比较麻烦</span>了，因为我们需要将链表尾节点的上一个节点的next属性的值修改为null，我们需要遍历链表找到这个节点。</p>
<p><strong><span style="color: #0000ff;">所以使用链表实现队列，最好将链表头作为队列头，将链表尾作为队列尾。</span></strong></p>]]></description></item><item><title>存储在集合中的对象不应该含有基本数据结构的任何实现细节</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/30/11611597.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Mon, 30 Sep 2019 03:02:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/30/11611597.html</guid><description><![CDATA[<p>　　</p>
<p>　　开卷有益，最近正按计划巩固自己算法与数据结构的基础知识，目前看来收获开始很多的，重拾了很多遗忘的知识，注意到很多以前没有留意的细节。在复习使用链表实现栈是，注意到了一句话：&ldquo;链表结构的细节内容应该与链表所存储的元素区分开来&rdquo;。</p>
<p>&nbsp;</p>
<p>　　我试着去理解这句话中包含的东西，以前我使用的链表大概是这样的：</p>
<p><img src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190930104206607-1798514358.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;　　DATA是我们要存储的数据，如果我们想要用DATA实现链表结构，我们需要在DATA中添加一个存储DATA对象地址的变量next。之前我并没有意识到也没有去思考过这种使用方式会有什么缺陷，今天思考了一下，确实发现了这种使用方式的一些缺陷：</p>
<p>　　1、为了使用链表存储DATA对象，DATA被迫存储了与自己无关的next变量。</p>
<p>　　2、DATA必须明确的知道，自己会成为DATA对象链表中的一个元素。</p>
<p>　　3、链表存储的数据和链表的结构耦合度过高，违背了集合实现细节与集合使用相分离的目标。</p>
<p>　　解决以上问题的方案是，定义一个独立的节点类，节点类中仅包含两个成员属性，一个为指向下一节点的next，一个为指向本节点存储数据的data。next和data可以是指针，也可以是引用。</p>
<p><img src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190930105854444-602622797.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　在java中，在可以设置data的类型为Object，因为Object是所有类的父类，利用向上转型，data可以指向任何类的对象，即我们定义的链表能够存储所有类型的数据。</p>
<p>&nbsp;</p>
<p>&nbsp;　　</p>]]></description></item><item><title>排序算法的稳定性</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/29/11608811.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sun, 29 Sep 2019 09:01:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/29/11608811.html</guid><description><![CDATA[<p>日期：2019年9月29日</p>
<p>学习内容：排序算法的稳定性</p>
<p>笔记：</p>
<p>　　假设待排序序列中有若干个数值相同的元素，使用某排序算法使序列有序，如果在有序序列中数值相同的元素保持相对位置不变，则称排序算法是稳定的，反之，称排序算法是不稳定的。</p>
<p>　　[5,4,3a,3b,3c,2,1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; &nbsp; &nbsp; &nbsp; [1,2,3a,3b,3c,4,5]</p>
<p>　　排序算法是否为稳定的是由具体算法决定的，不稳定的算法在某种条件下可以变为稳定的算法，而稳定的算法在某种条件下也可以变为不稳定的算法。例如，对于如下冒泡排序算法，原本是稳定的排序算法，如果将记录交换的条件改成r[j]&gt;=r[j+1]，则两个相等的记录就会交换位置，从而变成不稳定的算法。</p>]]></description></item><item><title>drop-out栈</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/29/11606234.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sun, 29 Sep 2019 02:15:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/29/11606234.html</guid><description><![CDATA[<h2>1、<strong>drop-out<span style="font-family: 黑体;">栈能够用来做什么？</span></strong></h2>
<p align="justify"><span style="font-family: 宋体;">　　在许多提供编辑功能的软件，如</span>word<span style="font-family: 宋体;">、</span><span style="font-family: Calibri;">ps</span><span style="font-family: 宋体;">、画图，都会提供&ldquo;撤销&rdquo;和&ldquo;恢复&rdquo;功能，使用drop-out能够实现这些功能。</span></p>
<p align="justify">&nbsp;</p>
<h2>2、<strong>drop-out<span style="font-family: 黑体;">栈特性</span></strong></h2>
<p align="justify">　　drop-out<span style="font-family: 宋体;">栈是一种特殊的栈，具有如下特征：</span></p>
<p align="justify">　　1、<span style="font-family: 宋体;">栈的大小固定</span></p>
<p align="justify">　　2、<span style="font-family: 宋体;">如果在栈满的情况下希望往栈中压入一个数据，栈底的数据会被清除以腾出空间容纳要新的数据。</span></p>
<p align="justify">&nbsp;</p>
<h2>3、<strong>drop-out<span style="font-family: 黑体;">栈实现</span></strong></h2>
<p align="justify"><span style="font-family: 宋体;">　　在此提供一种</span>drop-out<span style="font-family: 宋体;">栈的实现方法：循环队列</span></p>
<p align="justify"><span style="font-family: 宋体;"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190929100916750-2029584874.png" alt="" /></span></p>
<p align="justify"><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190929101024464-1653964397.gif" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="justify">&nbsp;</p>
<p align="justify">&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">&nbsp;</span></p>
<pre><span style="color: #cc7832;">package learnspring.learnspring.normalJava<span style="color: #cc7832;">;<br /><span style="color: #cc7832;"><br /><span style="color: #cc7832;"><br /><span style="color: #cc7832;">import java.awt.datatransfer.StringSelection<span style="color: #cc7832;">;<br /><span style="color: #cc7832;"><br /><span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;"> * <span style="color: #629755; font-weight: bold; font-style: italic;">@author <span style="color: #629755; font-style: italic;">肖政宇<br /><span style="color: #629755; font-style: italic;"> * <span style="color: #629755; font-weight: bold; font-style: italic;">@date <span style="color: #629755; font-style: italic;">2019-09-28 21:21<br /><span style="color: #629755; font-style: italic;"> * 说明：drop-out栈具有这样的特性：栈满以后，如果试图向栈中压入数据，<br /><span style="color: #629755; font-style: italic;"> * 栈底的数据会自动被弹出。<br /><span style="color: #629755; font-style: italic;"> */<br /><span style="color: #cc7832;">public class DropOutStack <span style="color: #9876aa; font-style: italic;">{<br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * size - 栈大小<br /><span style="color: #629755; font-style: italic;">     * stack - 栈<br /><span style="color: #629755; font-style: italic;">     * top - 栈顶（当前能够插入数据的位置）<br /><span style="color: #629755; font-style: italic;">     * bottom - 栈底<br /><span style="color: #629755; font-style: italic;">     * total - 栈内数据总数<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #cc7832;">private final int <span style="color: #9876aa;">size<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    private Object<span style="color: #9876aa; font-style: italic;">[] <span style="color: #9876aa;">stack<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    private int <span style="color: #9876aa;">top<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    private int <span style="color: #9876aa;">bottom<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    private int <span style="color: #9876aa;">total<span style="color: #cc7832;">;<br /><span style="color: #cc7832;"><br /><span style="color: #cc7832;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * constructor<br /><span style="color: #629755; font-style: italic;">     *<br /><span style="color: #629755; font-style: italic;">     * <span style="color: #629755; font-weight: bold; font-style: italic;">@param <span style="color: #8a653b; font-style: italic;">stackSize <span style="color: #629755; font-style: italic;">- the size of the stack<br /><span style="color: #629755; font-style: italic;">     * <span style="color: #629755; font-weight: bold; font-style: italic;">@throws <span style="color: #629755; font-style: italic;">Exception - wrong size<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #cc7832;">public <span style="color: #ffc66d;">DropOutStack<span style="color: #9876aa; font-style: italic;">(<span style="color: #cc7832;">int stackSize<span style="color: #9876aa; font-style: italic;">) <span style="color: #cc7832;">throws Exception <span style="color: #9876aa; font-style: italic;">{<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #cc7832;">if <span style="color: #9876aa; font-style: italic;">(stackSize &lt;= <span style="color: #6897bb;">1<span style="color: #9876aa; font-style: italic;">) {<br /><span style="color: #9876aa; font-style: italic;">            <span style="color: #cc7832;">throw new Exception<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">"wrong value！" + stackSize<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #cc7832;">this.<span style="color: #9876aa;">size = stackSize<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        this.<span style="color: #9876aa;">stack = <span style="color: #cc7832;">new Object<span style="color: #9876aa; font-style: italic;">[stackSize<span style="color: #9876aa; font-style: italic;">]<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        this.<span style="color: #9876aa;">top = <span style="color: #6897bb;">0<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        this.<span style="color: #9876aa;">bottom = <span style="color: #6897bb;">0<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        this.<span style="color: #9876aa;">total = <span style="color: #6897bb;">0<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * get the size of the stack<br /><span style="color: #629755; font-style: italic;">     *<br /><span style="color: #629755; font-style: italic;">     * <span style="color: #629755; font-weight: bold; font-style: italic;">@return <span style="color: #629755; font-style: italic;">- the size of the stack<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #cc7832;">public int <span style="color: #ffc66d;">size<span style="color: #9876aa; font-style: italic;">() {<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #cc7832;">return <span style="color: #9876aa;">size<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * push a data into the stack<br /><span style="color: #629755; font-style: italic;">     *<br /><span style="color: #629755; font-style: italic;">     * <span style="color: #629755; font-weight: bold; font-style: italic;">@param <span style="color: #8a653b; font-style: italic;">object <span style="color: #629755; font-style: italic;">= data that you want to push onto the stack<br /><span style="color: #629755; font-style: italic;">     * <span style="color: #629755; font-weight: bold; font-style: italic;">@return <span style="color: #629755; font-style: italic;">- true or false<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #cc7832;">public Boolean <span style="color: #ffc66d;">push<span style="color: #9876aa; font-style: italic;">(Object object<span style="color: #9876aa; font-style: italic;">) {<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #cc7832;">try <span style="color: #9876aa; font-style: italic;">{<br /><span style="color: #9876aa; font-style: italic;">            <span style="color: #9876aa;">stack<span style="color: #9876aa; font-style: italic;">[<span style="color: #9876aa;">top<span style="color: #9876aa; font-style: italic;">] = object<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">            <span style="color: #9876aa;">top = <span style="color: #9876aa; font-style: italic;">(<span style="color: #9876aa;">top + <span style="color: #6897bb;">1<span style="color: #9876aa; font-style: italic;">) % <span style="color: #9876aa;">size<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">            <span style="color: #808080;">//stack is full<br /><span style="color: #808080;">            <span style="color: #cc7832;">if <span style="color: #9876aa; font-style: italic;">(<span style="color: #9876aa;">total == <span style="color: #9876aa;">size<span style="color: #9876aa; font-style: italic;">) {<br /><span style="color: #9876aa; font-style: italic;">                <span style="color: #808080;">//the bottom element have been drop<br /><span style="color: #808080;">                <span style="color: #9876aa;">bottom = <span style="color: #9876aa; font-style: italic;">(<span style="color: #9876aa;">bottom + <span style="color: #6897bb;">1<span style="color: #9876aa; font-style: italic;">) % <span style="color: #9876aa;">size<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">            <span style="color: #9876aa; font-style: italic;">} <span style="color: #cc7832;">else <span style="color: #9876aa; font-style: italic;">{<span style="color: #808080;">//stack is not full yet<br /><span style="color: #808080;">                <span style="color: #9876aa;">total++<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">            <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;">            <span style="color: #cc7832;">return true;<br /><span style="color: #cc7832;">        <span style="color: #9876aa; font-style: italic;">} <span style="color: #cc7832;">catch <span style="color: #9876aa; font-style: italic;">(Exception e<span style="color: #9876aa; font-style: italic;">) {<br /><span style="color: #9876aa; font-style: italic;">            e.printStackTrace<span style="color: #9876aa; font-style: italic;">()<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">            return false;<br /><span style="color: #cc7832;">        <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;">    }<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * get the data from the top of the stack<br /><span style="color: #629755; font-style: italic;">     *<br /><span style="color: #629755; font-style: italic;">     * <span style="color: #629755; font-weight: bold; font-style: italic;">@return <span style="color: #629755; font-style: italic;">- a data from the top of the stack<br /><span style="color: #629755; font-style: italic;">     * <span style="color: #629755; font-weight: bold; font-style: italic;">@throws <span style="color: #629755; font-style: italic;">Exception - the stack is empty<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #cc7832;">public Object <span style="color: #ffc66d;">peek<span style="color: #9876aa; font-style: italic;">() <span style="color: #cc7832;">throws Exception <span style="color: #9876aa; font-style: italic;">{<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #cc7832;">if <span style="color: #9876aa; font-style: italic;">(<span style="color: #9876aa;">total == <span style="color: #6897bb;">0<span style="color: #9876aa; font-style: italic;">) {<br /><span style="color: #9876aa; font-style: italic;">            <span style="color: #cc7832;">throw new Exception<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">"the stack is empty!"<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #808080;">//get the data from the top of the stack<br /><span style="color: #808080;">        <span style="color: #9876aa;">top = <span style="color: #9876aa;">top == <span style="color: #6897bb;">0 ? <span style="color: #9876aa;">size - <span style="color: #6897bb;">1 : <span style="color: #9876aa;">top - <span style="color: #6897bb;">1<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        return <span style="color: #9876aa;">stack<span style="color: #9876aa; font-style: italic;">[<span style="color: #9876aa;">top<span style="color: #9876aa; font-style: italic;">]<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * drop a data from the top of the stack<br /><span style="color: #629755; font-style: italic;">     *<br /><span style="color: #629755; font-style: italic;">     * <span style="color: #629755; font-weight: bold; font-style: italic;">@return <span style="color: #629755; font-style: italic;">- a data from the top of the stack<br /><span style="color: #629755; font-style: italic;">     * <span style="color: #629755; font-weight: bold; font-style: italic;">@throws <span style="color: #629755; font-style: italic;">Exception - the stack is empty<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #cc7832;">public Object <span style="color: #ffc66d;">pop<span style="color: #9876aa; font-style: italic;">() <span style="color: #cc7832;">throws Exception <span style="color: #9876aa; font-style: italic;">{<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #cc7832;">if <span style="color: #9876aa; font-style: italic;">(<span style="color: #9876aa;">total == <span style="color: #6897bb;">0<span style="color: #9876aa; font-style: italic;">) {<br /><span style="color: #9876aa; font-style: italic;">            <span style="color: #cc7832;">throw new Exception<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">"the stack is empty!"<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #808080;">//get the data from the top of the stack<br /><span style="color: #808080;">        <span style="color: #9876aa;">top = <span style="color: #9876aa;">top == <span style="color: #6897bb;">0 ? <span style="color: #9876aa;">size - <span style="color: #6897bb;">1 : <span style="color: #9876aa;">top - <span style="color: #6897bb;">1<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        Object object = <span style="color: #9876aa;">stack<span style="color: #9876aa; font-style: italic;">[<span style="color: #9876aa;">top<span style="color: #9876aa; font-style: italic;">]<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        <span style="color: #808080;">//delete the data from the top of the stack<br /><span style="color: #808080;">        <span style="color: #9876aa;">stack<span style="color: #9876aa; font-style: italic;">[<span style="color: #9876aa;">top<span style="color: #9876aa; font-style: italic;">] = <span style="color: #cc7832;">null;<br /><span style="color: #cc7832;">        <span style="color: #808080;">//change the number of elements in the stack<br /><span style="color: #808080;">        <span style="color: #9876aa;">total--<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        return object<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #629755; font-style: italic;">/**<br /><span style="color: #629755; font-style: italic;">     * Is the stack empty？<br /><span style="color: #629755; font-style: italic;">     *<br /><span style="color: #629755; font-style: italic;">     * <span style="color: #629755; font-weight: bold; font-style: italic;">@return <span style="color: #629755; font-style: italic;">- true or false<br /><span style="color: #629755; font-style: italic;">     */<br /><span style="color: #629755; font-style: italic;">    <span style="color: #cc7832;">public Boolean <span style="color: #ffc66d;">isEmpty<span style="color: #9876aa; font-style: italic;">() {<br /><span style="color: #9876aa; font-style: italic;">        <span style="color: #cc7832;">return <span style="color: #9876aa;">total == <span style="color: #6897bb;">0<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;"><br /><span style="color: #9876aa; font-style: italic;">    <span style="color: #bbb529;">@Override<br /><span style="color: #bbb529;">    <span style="color: #cc7832;">public String <span style="color: #ffc66d;">toString<span style="color: #9876aa; font-style: italic;">() {<br /><span style="color: #9876aa; font-style: italic;">        StringBuilder stringStack = <span style="color: #cc7832;">new StringBuilder<span style="color: #9876aa; font-style: italic;">()<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        stringStack.append<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">'['<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        for <span style="color: #9876aa; font-style: italic;">(<span style="color: #cc7832;">int i = <span style="color: #6897bb;">0<span style="color: #cc7832;">; i &lt; <span style="color: #9876aa;">size<span style="color: #cc7832;">; i++<span style="color: #9876aa; font-style: italic;">) {<br /><span style="color: #9876aa; font-style: italic;">            <span style="color: #cc7832;">if <span style="color: #9876aa; font-style: italic;">(<span style="color: #9876aa;">stack<span style="color: #9876aa; font-style: italic;">[i<span style="color: #9876aa; font-style: italic;">] != <span style="color: #cc7832;">null<span style="color: #9876aa; font-style: italic;">) {<br /><span style="color: #9876aa; font-style: italic;">                stringStack.append<span style="color: #9876aa; font-style: italic;">(<span style="color: #9876aa;">stack<span style="color: #9876aa; font-style: italic;">[i<span style="color: #9876aa; font-style: italic;">])<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">            <span style="color: #9876aa; font-style: italic;">} <span style="color: #cc7832;">else <span style="color: #9876aa; font-style: italic;">{<br /><span style="color: #9876aa; font-style: italic;">                stringStack.append<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">"null"<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">            <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;">            <span style="color: #cc7832;">if <span style="color: #9876aa; font-style: italic;">(i + <span style="color: #6897bb;">1 &lt; <span style="color: #9876aa;">size<span style="color: #9876aa; font-style: italic;">) {<br /><span style="color: #9876aa; font-style: italic;">                stringStack.append<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">','<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">            <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;">        }<br /><span style="color: #9876aa; font-style: italic;">        stringStack.append<span style="color: #9876aa; font-style: italic;">(<span style="color: #6a8759;">']'<span style="color: #9876aa; font-style: italic;">)<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">        return stringStack.toString<span style="color: #9876aa; font-style: italic;">()<span style="color: #cc7832;">;<br /><span style="color: #cc7832;">    <span style="color: #9876aa; font-style: italic;">}<br /><span style="color: #9876aa; font-style: italic;">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p align="justify"><span style="font-family: 宋体;"> <br /></span></p>]]></description></item><item><title>向下转型与向下转型</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/28/11604689.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Sat, 28 Sep 2019 12:20:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/28/11604689.html</guid><description><![CDATA[<h1 align="center"><strong><span style="font-family: 宋体;">对象类型的转换</span></strong></h1>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">　　对象类型的转换包括向上类型转换与向下类型转换。</span></p>
<p align="justify">&nbsp;</p>
<h2>1、<strong><span style="font-family: 黑体;">向上类型转换</span></strong></h2>
<p align="justify">&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">　　将子类对象赋值给父类类型的变量，这种技术称为</span>&ldquo;向上转型&rdquo;。</p>
<p align="justify">　　在面向对象中越上层的类越抽象，越下层的类越具体，越具体的类具有越多的特性，由于向上转型是将较具体的类转到较抽象的类，所以它<span style="color: #ff0000;">总是安全</span>的。</p>
<p align="justify">&nbsp;</p>
<h2>2、<strong><span style="font-family: 黑体;">向下类型转换</span></strong></h2>
<p align="justify">&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">　　将父类对象赋值给子类类型的变量，这种技术称为</span>&ldquo;向下转型&rdquo;。</p>
<p align="justify">　　由于是将较抽象的类转为较具体的类，这样的转型比较<span style="color: #ff0000;">危险</span>。子类对象总是父类的一个实例，父类对象不一定是子类的实例。子类总是具有父类的特性，子类具有的特性父类不一定具有。</p>
<p align="justify">&nbsp;</p>
<hr />
<p align="justify">&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">　　回想一下平行四边形、矩形、正方形具有的特性：</span></p>
<table border="0">
<tbody>
<tr>
<td><span style="font-size: 15px;"><strong><span style="font-family: 宋体;">平行四边形</span></strong></span></td>
<td><span style="font-size: 15px;"><strong><span style="font-family: 宋体;">矩形</span></strong></span></td>
<td><span style="font-size: 15px;"><strong><span style="font-family: 宋体;">正方形</span></strong></span></td>
</tr>
<tr>
<td><span style="font-size: 14px;">①两组对边平行且相等</span></td>
<td><span style="font-size: 14px;">①两组对边平行且相等</span></td>
<td><span style="font-size: 14px;">①两组对边平行且相等</span></td>
</tr>
<tr>
<td>&nbsp;</td>
<td><span style="font-size: 14px;">②有一个角是直角</span></td>
<td><span style="font-size: 14px;">②有一个角是直角</span></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><span style="font-size: 14px;">③四条边相等</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p align="justify"><span style="font-family: 宋体;">　　越下层的类越具体，越具体的类具有的特性越多。向上转型之所以是安全的，因为子类具有父类所有的特性。在程序中进行向下转型时，必须使用显示类型转换，向编译器说明要将父类对象转换为哪一类型的子类对象。</span></p>
<p align="justify"><span style="font-family: 宋体;">　　在程序中，引用存储着对象的内存地址，父类的引用能够存储父类及其子类对象的地址，<span style="text-decoration: underline;">对于到底存储的是父类对象的地址子类对象的地址引用并不知晓</span>。比如，平行四边形类的引用只知道自己保存的地址是一个平行四边形的地址，具体是矩形还是正方形它并不知道。</span></p>
<p align="justify"><span style="font-family: 宋体;">　　在程序中，如果需要将父类引用的值（也就是父类或者其子类对象的地址）赋值给某个子类的引用，需要告诉编译器：</span>&ldquo;我给的地址就是这个子类的对象的地址&rdquo;，否则编译无法通过。</p>
<p align="justify"><span style="font-family: 宋体;">　　需要注意，父类引用存储的地址到底是父类对象的地址还是某个子类对象的地址，完全是我们告诉编译器的（显示类型转换），即使编译能够通过，但还是不能保证程序运行的时候不会出错。即使我们将平行四边形类引用存储的矩形对象的地址赋值给正方形类引用，我们也能告诉编译器，这就是一个正方形的地址，编译是能够通过的，但如果我们真把矩形当作正方形进行操作还是会出错。</span></p>
<p align="justify"><span style="font-family: 宋体;">　　所以说，向下类型转换是危险的。</span></p>]]></description></item><item><title>Spring条件注解@Conditional</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11591929.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 26 Sep 2019 07:06:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11591929.html</guid><description><![CDATA[<p>　　Spring4中提供了一种更通用的条件创建Bean的方式，即使用@Conditional注解。</p>
<p>　　示例：</p>
<p>　　通过在配置文件中修改ifCreate的值，来控制某个Bean的创建。</p>
<p>　　（1）创建一个实现了Condition接口的类，实现matches方法，在matches方法返回的结果决定了Bean是否被创建。</p>
<p>　　</p>
<div class="cnblogs_code">
<pre></pre>
<pre data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">package learnspring.learnspring.conditional<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">import org.springframework.context.annotation.Condition<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">import org.springframework.context.annotation.ConditionContext<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">import org.springframework.core.type.AnnotatedTypeMetadata<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">/**<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">@author <span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">肖政宇<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">@date <span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">2019-09-26 14:33<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> * 说明：判断条件<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> */<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">public class MyCondition <span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">implements Condition <span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">{<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">    <span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color="">@Override<br /><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color="">    <span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">public boolean <span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color="">matches<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">(ConditionContext conditionContext<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">, AnnotatedTypeMetadata annotatedTypeMetadata<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">) {<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">        String ifCreate = conditionContext.getEnvironment<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">().getProperty<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">(<span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color="">"ifCreate"<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">)<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">        if <span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">(<span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color="">"true".equals<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">(ifCreate<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">)){<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">            System.<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">(<span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color="">"配置文件中，ifCreate的值为true"<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">)<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">            return true;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">        <span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">}<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">else <span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">{<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">            System.<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">(<span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color="">"配置文件中，ifCreate的值为false"<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">)<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">            return false;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">        <span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">    }<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<pre><span style="color: #000000;" data-darkreader-inline-color="">&nbsp;</span></pre>
</div>
<p>（2）Bean</p>
<div class="cnblogs_code">
<pre></pre>
<pre data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">package learnspring.learnspring.conditional<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">/**<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">@author <span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">肖政宇<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">@date <span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">2019-09-26 14:45<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> * 说明：<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> */<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">public class DemoBean <span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">{<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">    <span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">public <span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color="">DemoBean<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">(<span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color="">"Hello,DemoBean已经被创建！"<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">)<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<pre><span style="color: #000000;" data-darkreader-inline-color="">&nbsp;</span></pre>
</div>
<p>（3）java配置类</p>
<div class="cnblogs_code">
<pre></pre>
<pre data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">package learnspring.learnspring.conditional<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">import org.springframework.context.annotation.<span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color="">Bean<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">import org.springframework.context.annotation.<span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color="">Conditional<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">import org.springframework.context.annotation.<span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color="">Configuration<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">/**<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">@author <span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">肖政宇<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">@date <span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color="">2019-09-26 14:46<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> * 说明：<br /><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""> */<br /><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color="">@Configuration<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">public class MyConditionalConfiguration <span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">{<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">    <span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color="">@Bean<br /><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color="">    @Conditional<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">(MyCondition.<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">class<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">)<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">    <span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">public DemoBean <span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color="">createBeanConditional<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">        <span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">return new DemoBean<span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">()<span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<pre><span style="color: #000000;" data-darkreader-inline-color="">&nbsp;</span></pre>
</div>
<p>（4）配置文件</p>
<p><img src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190926150529305-1575744741.png" alt="" /></p>
<p>&nbsp;</p>
<p>（5）运行结果</p>
<p><img src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190926150619164-1750620374.png" alt="" /></p>
<p>&nbsp;</p>]]></description></item><item><title>Spring应用事件（Application Event）</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11590592.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 26 Sep 2019 06:18:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11590592.html</guid><description><![CDATA[<p>　　Spring的事件为Bean与Bean的消息通信提供的支持。当一个Bean处理完了一个任务以后，希望另一个Bean知道并能做出相应的处理，这是我们就需要让另一个Bean监听当前Bean所发送的事件。　</p>
<p>　　<span style="color: #ff0000; --darkreader-inline-color: #c61d1d;" data-darkreader-inline-color="">Spring中使用事件的大概流程如下：</span></p>
<p>　　（1）定义事件</p>
<p>　　（2）定义事件监听器</p>
<p>　　（3）使用容器发布事件</p>
<hr />
<p>&nbsp;</p>
<p>示例：</p>
<p>　　（1）定义事件</p>
<p>　　自定义事件需要实现ApplicationEvent接口。</p>
<div class="cnblogs_code">
<pre></pre>
<pre><span style="color: #cc7832;" data-darkreader-inline-color="">package learnspring.learnspring.event<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.context.ApplicationEvent<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">/**<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@author <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">肖政宇<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@date <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">2019-09-23 14:36<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * 说明：自定义事件<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> */<br /><span style="color: #cc7832;" data-darkreader-inline-color="">public class DemoEvent <span style="color: #cc7832;" data-darkreader-inline-color="">extends ApplicationEvent <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">{<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">private static final long <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">serialVersionUID = <span style="color: #6897bb;" data-darkreader-inline-color="">1L<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    private String <span style="color: #9876aa;" data-darkreader-inline-color="">msg<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #ffc66d;" data-darkreader-inline-color="">DemoEvent<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(Object source<span style="color: #cc7832;" data-darkreader-inline-color="">, String msg<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">) {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        <span style="color: #cc7832;" data-darkreader-inline-color="">super<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(source<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">        this.<span style="color: #9876aa;" data-darkreader-inline-color="">msg = msg<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    String <span style="color: #ffc66d;" data-darkreader-inline-color="">getMsg<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        <span style="color: #cc7832;" data-darkreader-inline-color="">return <span style="color: #9876aa;" data-darkreader-inline-color="">msg<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">setMsg<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(String msg<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">) {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        <span style="color: #cc7832;" data-darkreader-inline-color="">this.<span style="color: #9876aa;" data-darkreader-inline-color="">msg = msg<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
</div>
<p>&nbsp;</p>
<p>　　（2）定义事件监听器</p>
<p>　　</p>
<div class="cnblogs_code">
<pre></pre>
<pre><span style="color: #cc7832;" data-darkreader-inline-color="">package learnspring.learnspring.event<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.context.ApplicationListener<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.stereotype.<span style="color: #bbb529;" data-darkreader-inline-color="">Component<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">/**<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@author <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">肖政宇<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@date <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">2019-09-23 14:39<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * 说明：事件监听器<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * 实现ApplicationListener接口，同时声明监听的事件类型<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> */<br /><span style="color: #bbb529;" data-darkreader-inline-color="">@Component<br /><span style="color: #cc7832;" data-darkreader-inline-color="">public class DemoListener <span style="color: #cc7832;" data-darkreader-inline-color="">implements ApplicationListener<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">&lt;DemoEvent<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">&gt; {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #bbb529;" data-darkreader-inline-color="">@Override<br /><span style="color: #bbb529;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">onApplicationEvent<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(DemoEvent event<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">) {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        String msg = event.getMsg<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">()<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"我（bean-demoListener）接收到了bean-demoPublisher发布的消息：" + msg<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<pre><span style="color: #000000;" data-darkreader-inline-color="">&nbsp;</span></pre>
</div>
<p>&nbsp;</p>
<p>　　（3）使用容器发布事件</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;" data-darkreader-inline-color="">package</span><span style="color: #000000;" data-darkreader-inline-color=""> learnspring.learnspring.event;
</span></pre>
<pre><span style="color: #cc7832;" data-darkreader-inline-color="">package learnspring.learnspring.event<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.beans.factory.annotation.<span style="color: #bbb529;" data-darkreader-inline-color="">Autowired<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.context.ApplicationContext<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.stereotype.<span style="color: #bbb529;" data-darkreader-inline-color="">Component<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">/**<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@author <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">肖政宇<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@date <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">2019-09-23 14:43<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * 说明：事件发布者<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> */<br /><span style="color: #bbb529;" data-darkreader-inline-color="">@Component<br /><span style="color: #cc7832;" data-darkreader-inline-color="">public class DemoPublisher <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">{<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">private ApplicationContext <span style="color: #9876aa;" data-darkreader-inline-color="">applicationContext<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #bbb529;" data-darkreader-inline-color="">@Autowired<br /><span style="color: #bbb529;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">setApplicationContext<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(ApplicationContext applicationContext<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">) {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        <span style="color: #cc7832;" data-darkreader-inline-color="">this.<span style="color: #9876aa;" data-darkreader-inline-color="">applicationContext = applicationContext<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">publish<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(String msg<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">) {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        <span style="color: #9876aa;" data-darkreader-inline-color="">applicationContext.publishEvent<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #cc7832;" data-darkreader-inline-color="">new DemoEvent<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #cc7832;" data-darkreader-inline-color="">this, msg<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">))<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<pre></pre>
</div>
<p>测试：</p>
<div class="cnblogs_code">
<pre></pre>
<pre><span style="color: #cc7832;" data-darkreader-inline-color="">package learnspring.learnspring<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">import learnspring.learnspring.event.DemoPublisher<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.junit.<span style="color: #bbb529;" data-darkreader-inline-color="">Test<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.junit.runner.<span style="color: #bbb529;" data-darkreader-inline-color="">RunWith<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.beans.factory.annotation.<span style="color: #bbb529;" data-darkreader-inline-color="">Autowired<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.boot.test.context.<span style="color: #bbb529;" data-darkreader-inline-color="">SpringBootTest<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.test.context.junit4.SpringRunner<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #bbb529;" data-darkreader-inline-color="">@RunWith<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(SpringRunner.<span style="color: #cc7832;" data-darkreader-inline-color="">class<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<br /><span style="color: #bbb529;" data-darkreader-inline-color="">@SpringBootTest<br /><span style="color: #cc7832;" data-darkreader-inline-color="">public class LearnspringApplicationTests <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">{<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    DemoPublisher <span style="color: #9876aa;" data-darkreader-inline-color="">publisher<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #bbb529;" data-darkreader-inline-color="">@Autowired<br /><span style="color: #bbb529;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">setPublisher<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(DemoPublisher publisher<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">) {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        <span style="color: #cc7832;" data-darkreader-inline-color="">this.<span style="color: #9876aa;" data-darkreader-inline-color="">publisher = publisher<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #bbb529;" data-darkreader-inline-color="">@Test<br /><span style="color: #bbb529;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">contextLoads<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"事件发生！"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">        <span style="color: #9876aa;" data-darkreader-inline-color="">publisher.publish<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"Hello World!"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<pre><span style="color: #000000;" data-darkreader-inline-color="">&nbsp;</span></pre>
</div>
<p>运行结果：</p>
<p><img src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190926141739098-1811900562.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>　　</p>]]></description></item><item><title>Bean的初始化和销毁</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11589777.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 26 Sep 2019 03:27:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11589777.html</guid><description><![CDATA[<p>　　在实际开发中我们可能会需要在Bean使用前和销毁前进行某些操作，Spring对Bean的生命周期的操作提供了支持，提供如下两种方式：</p>
<p>（1）Java配置方式：</p>
<p>　　在Java配置类中，使用@Bean注解显示声明Bean的时候，通过@Bean注解的initMethod和destroyMethod为Bean指定这两个阶段执行的函数。</p>
<p>（2）注解方式：</p>
<p>　　利用JSR-250提供的@PostConstrust和@PreDestroy注解。@PostConstruct注解标识函数在构造函数执行完之后执行。</p>
<hr />
<p>&nbsp;</p>
<p>示例：</p>
<p>（1）java配置方式</p>
<p>①Bean代码</p>
<div class="cnblogs_code">
<pre data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""></pre>
<pre><span style="color: #cc7832;" data-darkreader-inline-color="">package learnspring.learnspring.initanddestroy<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">/**<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@author <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">肖政宇<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@date <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">2019-09-26 10:47<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * 说明：示例<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> */<br /><span style="color: #cc7832;" data-darkreader-inline-color="">public class DemoBean <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">{<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public <span style="color: #ffc66d;" data-darkreader-inline-color="">DemoBean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"创建Bean"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">useBean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"Bean被使用"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">initBean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"使用Bean之前"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">destroyDean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"销毁Bean之前"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<pre data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-weight: bold; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-weight: bold; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
</div>
<p>②java配置类代码</p>
<div class="cnblogs_code">
<pre><span style="color: #cc7832;" data-darkreader-inline-color="">package learnspring.learnspring.initanddestroy<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.context.annotation.AnnotationConfigApplicationContext<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.context.annotation.<span style="color: #bbb529;" data-darkreader-inline-color="">Bean<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.context.annotation.<span style="color: #bbb529;" data-darkreader-inline-color="">Configuration<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">/**<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@author <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">肖政宇<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@date <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">2019-09-26 10:49<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * 说明：java配置类<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> */<br /><span style="color: #bbb529;" data-darkreader-inline-color="">@Configuration<br /><span style="color: #cc7832;" data-darkreader-inline-color="">public class DemoConfiguration <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">{<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #bbb529;" data-darkreader-inline-color="">@Bean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #d0d0ff;" data-darkreader-inline-color="">initMethod = <span style="color: #6a8759;" data-darkreader-inline-color="">"initBean"<span style="color: #cc7832;" data-darkreader-inline-color="">, <span style="color: #d0d0ff;" data-darkreader-inline-color="">destroyMethod = <span style="color: #6a8759;" data-darkreader-inline-color="">"destroyDean"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    DemoBean <span style="color: #ffc66d;" data-darkreader-inline-color="">createBean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        <span style="color: #cc7832;" data-darkreader-inline-color="">return new DemoBean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">()<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public static void <span style="color: #ffc66d;" data-darkreader-inline-color="">main<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(String<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">[] args<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">) {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        AnnotationConfigApplicationContext context =<br />                <span style="color: #cc7832;" data-darkreader-inline-color="">new AnnotationConfigApplicationContext<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(DemoConfiguration.<span style="color: #cc7832;" data-darkreader-inline-color="">class<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">        DemoBean demoBean = context.getBean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(DemoBean.<span style="color: #cc7832;" data-darkreader-inline-color="">class<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">        demoBean.useBean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">()<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">        context.close<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">()<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
</div>
<p>③运行结果</p>
<p><img src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190926110938484-1579419225.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<p>（2）注解方式：</p>
<p>①Bean</p>
<p>&nbsp;</p>
<pre data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""></pre>
<div class="cnblogs_code">
<pre></pre>
<pre><span style="color: #cc7832;" data-darkreader-inline-color="">package learnspring.learnspring.initanddestroy<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">import org.springframework.stereotype.<span style="color: #bbb529;" data-darkreader-inline-color="">Component<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">import javax.annotation.<span style="color: #bbb529;" data-darkreader-inline-color="">PostConstruct<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">import javax.annotation.<span style="color: #bbb529;" data-darkreader-inline-color="">PreDestroy<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color=""><br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">/**<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@author <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">肖政宇<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * <span style="color: #629755; font-weight: bold; font-style: italic;" data-darkreader-inline-color="">@date <span style="color: #629755; font-style: italic;" data-darkreader-inline-color="">2019-09-26 10:47<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> * 说明：示例<br /><span style="color: #629755; font-style: italic;" data-darkreader-inline-color=""> */<span style="color: #bbb529;" data-darkreader-inline-color=""><br /><span style="color: #cc7832;" data-darkreader-inline-color="">public class DemoBean <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">{<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public <span style="color: #ffc66d;" data-darkreader-inline-color="">DemoBean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"创建Bean"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">useBean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"Bean被使用"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #bbb529;" data-darkreader-inline-color="">@PostConstruct<br /><span style="color: #bbb529;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">initBean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"使用Bean之前"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color=""><br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">    <span style="color: #bbb529;" data-darkreader-inline-color="">@PreDestroy<br /><span style="color: #bbb529;" data-darkreader-inline-color="">    <span style="color: #cc7832;" data-darkreader-inline-color="">public void <span style="color: #ffc66d;" data-darkreader-inline-color="">destroyDean<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">() {<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">        System.<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">out.println<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">(<span style="color: #6a8759;" data-darkreader-inline-color="">"销毁Bean之前"<span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">)<span style="color: #cc7832;" data-darkreader-inline-color="">;<br /><span style="color: #cc7832;" data-darkreader-inline-color="">    <span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /><span style="color: #9876aa; font-style: italic;" data-darkreader-inline-color="">}<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<pre></pre>
</div>
<pre data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-weight: bold; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-weight: bold; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #629755; font-style: italic; --darkreader-inline-color: #799772;" data-darkreader-inline-color=""><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color=""><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color=""><span style="color: #bbb529; --darkreader-inline-color: #aca951;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #ffc66d; --darkreader-inline-color: #c6974d;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #6a8759; --darkreader-inline-color: #8e8a82;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #cc7832; --darkreader-inline-color: #a8764c;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color=""><span style="color: #9876aa; font-style: italic; --darkreader-inline-color: #89847b;" data-darkreader-inline-color="">Java配置类以及运行结果和方法一一样。<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p>&nbsp;</p>]]></description></item><item><title>Spring 资源注入</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11589402.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 26 Sep 2019 02:39:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11589402.html</guid><description><![CDATA[<p>　　Spring开发中经常需要调用各种资源，包含普通文件、网址、配置文件、系统环境变量等，我们可以使用Spring表达式语言（Spring-EL）实现资源的注入。</p>
<p>　　Spring主要使用@Value注解实现资源注入，在@Value注解的参数中使用Spring-EL。</p>
<p><img src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190926103755721-255936091.png" alt="" /></p>
<p>&nbsp;</p>]]></description></item><item><title>Bean的Scope</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11589343.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 26 Sep 2019 02:31:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11589343.html</guid><description><![CDATA[<p>　　Scope意为&ldquo;范围&rdquo;，Spring中通过@Scope注解描述Bean的作用范围，决定Spring容器以什么方式新建Bean。</p>
<p>　　<img src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190926102610987-1580301495.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;　　@Scope注解中value的取值有：</p>
<p>　　1、Singleton - 一个Spring容器中只有一个该Bean的实例，所有使用到该Bean的地方共用一个Bean，value的默认值为Singleton。</p>
<p>　　2、Prototype - 每次调用新建一个Bean的实例。</p>
<p>　　3、Session - Web项目中，给每一个http session新建一个Bean实例。</p>
<p>　　4、Request - Web项目中，给每一个http request新建一个Bean实例。</p>]]></description></item><item><title>面向切面编程（AOP）</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11589267.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 26 Sep 2019 02:21:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11589267.html</guid><description><![CDATA[<p>　　AOP：面向切面编程，相对于OOP面向对象编程。</p>
<p>　　存在即合理，任何东西的总有它存在的道理和意义。Spring 中AOP存在的意义在于<span style="color: #ff0000; --darkreader-inline-color: #c61d1d;" data-darkreader-inline-color="">解耦</span>，功能模块间的解耦。在OOP中，如果我们想要在不同的类之间共享某个功能，我们会通过继承父类或者实现接口，但这样增加了代码的耦合程度，且Java中类只能单继承，这就阻碍了我们将更多了行为添加到一组类上，AOP弥补了OOP的不足。</p>
<p>　　我们的程序是由许许多多的&ldquo;关注点&rdquo;组成的，有的关注点比较集中，有个关注点分散在程序各处。我们称分散在各处的关注点为<span style="color: #ff0000; --darkreader-inline-color: #c61d1d;" data-darkreader-inline-color="">横向关注点</span>。常见的横向关注点有安全、事务、日志。</p>
<p>　　散落在各处的关注点会使我们的代码变得混乱。这让我想起了曾经参与开发的某个项目，在开发进行了一段时间后，客户提出需要增加一个系统日志功能，然后负责实现系统日志功能的同事使用一函数实现了该功能，所有需要记录日志的操作都需要调用该函数......</p>
<p>　　将关注点分散到多个组件中去，将会给你的代码带来双重的复杂度：</p>
<p>　　1.实现系统关注点功能的代码将会重复出现在多个组件中。这意味着如果你要改变这些关注点的逻辑，必须修改各个模块中的相关实现。即使你把关注点抽象成一个独立的模块，其他模块只是调用它的方法，但方法的调用还是会重复再各个模块中。</p>
<p>　　2.组件因为那些与核心业务无关的代码变得混乱。</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190926101121151-1390338281.png" alt="" /></p>
<p>　　AOP能够帮助我们将分散在各处的横向关注点抽离出来形成可重用的组件，并且以声明的方式将它们应用到需要影响的组件中去。最终这些组件将会具有更高的内聚性且能够关注于自身业务。我们称实现横向关注点的组件为<span style="color: #ff0000; --darkreader-inline-color: #c61d1d;" data-darkreader-inline-color="">切面</span>。</p>
<p>&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190926102016000-372006861.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190926101356242-150965894.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　如上图所示，我们可以把切面想象成覆盖在很多组件外的一个壳，借助AOP我们能使用各种功能层去包裹核心业务层，核心业务层不需要知道功能层的存在。</p>
<p>&nbsp;</p>]]></description></item><item><title>依赖注入</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11588976.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Thu, 26 Sep 2019 01:40:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/26/11588976.html</guid><description><![CDATA[<p>　　经常听到&ldquo;控制翻转&rdquo;和&ldquo;依赖注入&rdquo;这两个词，所以特意去了解了一下。</p>
<p>　　&ldquo;在Spring中，控制翻转（Inversion of Control，IoC）是通过依赖注入（Dependency injection，DI）实现的。所谓依赖注入指的是，由Spring容器来负责对象的创建以及维护对象之间的依赖关系，对象不需要负责创建和解决自己的依赖。&rdquo;这是我了解到的内容。</p>
<p>　　下面谈谈我的理解：</p>
<p>　　&ldquo;厨子&rdquo;、&ldquo;采购员&rdquo;、&ldquo;原材料&rdquo;、&ldquo;菜&rdquo;，看到这几个词的时候我们会想到什么呢？</p>
<p>　　1、&ldquo;厨子炒菜需要原材料&rdquo;</p>
<p>　　2、&ldquo;采购员负责采购原材料&rdquo;</p>
<p>　　大家都知道分工细化能够带来效率的提升，厨子专注于做菜往往能做出好吃的菜，采购员专注于采购往往能买到物美价廉的材料。</p>
<p>&nbsp;</p>
<p>　　假设有类A、类B：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;" data-darkreader-inline-color="">1</span> <span style="color: #0000ff;" data-darkreader-inline-color="">public</span> <span style="color: #0000ff;" data-darkreader-inline-color="">class</span><span style="color: #000000;" data-darkreader-inline-color=""> A{
</span><span style="color: #008080;" data-darkreader-inline-color="">2</span> <span style="color: #000000;" data-darkreader-inline-color="">    ...
</span><span style="color: #008080;" data-darkreader-inline-color="">3</span> <span style="color: #000000;" data-darkreader-inline-color="">    ...    
</span><span style="color: #008080;" data-darkreader-inline-color="">4</span> <span style="color: #000000;" data-darkreader-inline-color="">    pubilc A(){
</span><span style="color: #008080;" data-darkreader-inline-color="">5</span> <span style="color: #000000;" data-darkreader-inline-color="">    }
</span><span style="color: #008080;" data-darkreader-inline-color="">6</span>     <span style="color: #0000ff;" data-darkreader-inline-color="">public</span><span style="color: #000000;" data-darkreader-inline-color=""> A(...){
</span><span style="color: #008080;" data-darkreader-inline-color="">7</span> <span style="color: #000000;" data-darkreader-inline-color="">         ...
</span><span style="color: #008080;" data-darkreader-inline-color="">8</span> <span style="color: #000000;" data-darkreader-inline-color="">    }
</span><span style="color: #008080;" data-darkreader-inline-color="">9</span> }</pre>
</div>
<div class="cnblogs_code">
<pre><span style="color: #008080;" data-darkreader-inline-color=""> 1</span>  <span style="color: #0000ff;" data-darkreader-inline-color="">public</span> <span style="color: #0000ff;" data-darkreader-inline-color="">class</span><span style="color: #000000;" data-darkreader-inline-color=""> B{
</span><span style="color: #008080;" data-darkreader-inline-color=""> 2</span> <span style="color: #000000;" data-darkreader-inline-color="">     A a;
</span><span style="color: #008080;" data-darkreader-inline-color=""> 3</span> <span style="color: #000000;" data-darkreader-inline-color="">     ...
</span><span style="color: #008080;" data-darkreader-inline-color=""> 4</span> <span style="color: #000000;" data-darkreader-inline-color="">     ...    
</span><span style="color: #008080;" data-darkreader-inline-color=""> 5</span> <span style="color: #000000;" data-darkreader-inline-color="">     pubilc B(){
</span><span style="color: #008080;" data-darkreader-inline-color=""> 6</span> <span style="color: #000000;" data-darkreader-inline-color="">     }
</span><span style="color: #008080;" data-darkreader-inline-color=""> 7</span>      <span style="color: #0000ff;" data-darkreader-inline-color="">public</span><span style="color: #000000;" data-darkreader-inline-color=""> B(...){
</span><span style="color: #008080;" data-darkreader-inline-color=""> 8</span> <span style="color: #000000;" data-darkreader-inline-color="">          ...
</span><span style="color: #008080;" data-darkreader-inline-color=""> 9</span>           <span style="color: #0000ff;" data-darkreader-inline-color="">this</span>.a = <span style="color: #0000ff;" data-darkreader-inline-color="">new</span><span style="color: #000000;" data-darkreader-inline-color=""> A(...);
</span><span style="color: #008080;" data-darkreader-inline-color="">10</span> <span style="color: #000000;" data-darkreader-inline-color="">     }
</span><span style="color: #008080;" data-darkreader-inline-color="">11</span>  }</pre>
</div>
<p>　　在不使用依赖注入的情况下，B类需要自己动手去创建一个类A的对象来满足自己的需求，在这种情况下，类B和类A是紧耦合的，如果需要对类A进行修改，那么所有依赖类A的类都需要做相应的调整，如果依赖类A的类比较多的话，这就比较麻烦了。为了解决这种紧耦合带来的不便，就有了依赖注入。</p>
<p>　　依赖注入的主要目的就是为了解耦，在程序开始运行后，Spring IoC容器会先创建一些类，就像采购员会先去采购一批原材料，当然了具体需要创建哪些类，需要我们告诉容器，就像具体要买哪些菜需要厨子告诉采购员，然后所有依赖于这些类的类自需要告诉容器：&ldquo;我需要一个XXX类的对象&rdquo;，然后然就会得到一个XXX类的对象，就像厨子想炒白菜，只需要说：&ldquo;我需要白菜、盐...&rdquo;，然后他就能得到想要的材料并开始炒菜。</p>]]></description></item><item><title>Spring 拦截器</title><link>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/25/11582347.html</link><dc:creator>啃白菜的喵</dc:creator><author>啃白菜的喵</author><pubDate>Wed, 25 Sep 2019 00:57:00 GMT</pubDate><guid>http://www.cnblogs.com/KenBaiCaiDeMiao/archive/2019/09/25/11582347.html</guid><description><![CDATA[<h1>示例</h1>
<h2><a name="t1"></a>（1）编写拦截器</h2>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> learnspring.learnspring.interceptor;
 
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.stereotype.Component;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.servlet.ModelAndView;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.servlet.handler.HandlerInterceptorAdapter;
 
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.http.HttpServletRequest;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.http.HttpServletResponse;
 
</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> 肖政宇
 * @date 2019-09-24 15:13
 * 说明：拦截器
 * 一个简单的拦截器，计算每一次请求的处理时间
 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
@Component
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> DemoInterceptor <span style="color: #0000ff;">extends</span><span style="color: #000000;"> HandlerInterceptorAdapter {
 
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 在请求发生前执行
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> preHandle(HttpServletRequest request,
                             HttpServletResponse response,
                             Object object) </span><span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
        </span><span style="color: #0000ff;">long</span> startTime =<span style="color: #000000;"> System.currentTimeMillis();
        System.out.println(</span>"拦截器接收到请求的时间：" + <span style="color: #0000ff;">new</span><span style="color: #000000;"> Long(startTime));
        request.setAttribute(</span>"startTime"<span style="color: #000000;">, startTime);
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
    }
 
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 在请求发生之后执行
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> postHandle(HttpServletRequest request,
                           HttpServletResponse response,
                           Object object,
                           ModelAndView modelAndView) </span><span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
        </span><span style="color: #0000ff;">long</span> startTime = (Long) request.getAttribute("startTime"<span style="color: #000000;">);
        request.removeAttribute(</span>"startTime"<span style="color: #000000;">);
        </span><span style="color: #0000ff;">long</span> endTime =<span style="color: #000000;"> System.currentTimeMillis();
        System.out.println(</span>"本此请求的处理时间为：" + endTime + " - " + startTime + " = " +
                <span style="color: #0000ff;">new</span> Long(endTime - startTime) + "ms"<span style="color: #000000;">);
        request.setAttribute(</span>"handlingTime", endTime -<span style="color: #000000;"> startTime);
    }
}</span></pre>
</div>
<h2>（2）在配置类中注册拦截器</h2>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> learnspring.learnspring.interceptor;
 
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.beans.factory.annotation.Autowired;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.context.annotation.Bean;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.context.annotation.Configuration;
</span><span style="color: #0000ff;">import</span> org.springframework.web.servlet.config.annotation.*<span style="color: #000000;">;
 
</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> 肖政宇
 * @date 2019-09-24 15:27
 * 说明：配置
 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
@Configuration
@EnableWebMvc
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MyMvcConfig <span style="color: #0000ff;">implements</span><span style="color: #000000;"> WebMvcConfigurer {
 
    DemoInterceptor demoInterceptor;
 
    @Autowired
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setDemoInterceptor(DemoInterceptor demoInterceptor) {
        </span><span style="color: #0000ff;">this</span>.demoInterceptor =<span style="color: #000000;"> demoInterceptor;
    }
 
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 注册拦截器
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(demoInterceptor);
    }
}</span></pre>
</div>
<h2>（3）简单的控制器</h2>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> learnspring.learnspring.interceptor;
 
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.GetMapping;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.RequestMapping;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.RestController;
 
</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> 肖政宇
 * @date 2019-09-24 15:38
 * 说明：
 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
@RestController
@RequestMapping(</span>"/test"<span style="color: #000000;">)
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> TestController {
    @GetMapping(</span>"hello"<span style="color: #000000;">)
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String sayHello() {
        </span><span style="color: #0000ff;">return</span> "Hello"<span style="color: #000000;">;
    }
}</span></pre>
</div>
<h2>（4）测试结果</h2>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190925085418773-790188019.png" alt="" /><img style="display: block; margin-left: auto; margin-right: auto;" src="https://img2018.cnblogs.com/blog/1689384/201909/1689384-20190925085430089-1112826951.png" alt="" /></p>
<p>&nbsp;</p>]]></description></item></channel></rss>